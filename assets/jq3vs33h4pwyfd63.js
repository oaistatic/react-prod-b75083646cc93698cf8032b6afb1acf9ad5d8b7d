const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/l6cv5nzindj4r51t.js","assets/lu2xqwqmjc95q6j6.js","assets/hml6mmd5fyx85si7.js","assets/root-c0w5lvnh.css","assets/rseqzngxzbdt1oxg.js","assets/conversation-small-gcvo4yhm.css","assets/f2icac4qflq2ca2c.js","assets/nsxv1nyryaz0gxvd.js","assets/BusinessesMap-oeh39yix.css"])))=>i.map(i=>d[i]);
import{j as n,M as $,e as M,r as m,v as bn,n as yn,m as ut,y as vn,u as wn,c as pt,R as _n,d as xt,o as ot,A as Mt}from"./lu2xqwqmjc95q6j6.js";import{S as kn}from"./cll46xg89nxc0ghy.js";import{M as Cn,u as _s,R as ks,a as Cs,S as At,m as jn,b as Nn,I as Sn,c as $n,C as Tn,d as Pn,e as Mn,f as An,r as In}from"./k9cs1paiwp280pwy.js";import{tC as F,tD as P,us as En,ut as Fn,uu as rt,uv as Q,eh as js,iT as Rn,t as Ns,mB as Ln,ou as Dn,on as Xe,es as On,ax as Bn,qZ as U,uw as zn,bq as Wn,ux as Hn,o1 as Un,qq as Ss,uy as Jn,tE as It,at as Xn,js as Gn,uz as Vn,gC as gt,o2 as bt,gA as yt,gB as vt,uA as qn,e6 as $s,e7 as Yn,d_ as Zn,gx as Kn,om as Qn,jz as Oe,ex as Ts,pc as eo,jA as Ge,bk as je,jr as to,bs as so,uB as no,rY as oo,bR as ro,ei as Ps,uC as Ms,iO as ao,m_ as io,uD as lo,jH as wt,uE as As,uF as Is,uG as co,uH as uo,uI as fo,bp as ho,br as mo,n0 as po,bC as xo,aQ as ft,bD as Es,bE as Fs,Y as go,cf as bo,jK as yo,uJ as vo,pX as wo,uK as _o,r_ as ko,uL as Co,uM as jo,uN as No,uO as So,bd as $o,b7 as To,aS as Po,rE as Mo,uP as Ao,gd as Io,uQ as at,uR as Eo,ry as Fo,r7 as Ro}from"./rseqzngxzbdt1oxg.js";import{d as k,cR as Te,aN as Ve,fH as Lo,G as Pe,bg as qe,a as X,c as L,jE as _t,eg as Rs,hL as Do,dq as Oo,B as q,p as Bo,V as Ye,c9 as zo,fG as Ls,ca as Wo,H as Ds,L as Os,dh as Ho,bz as ee,dv as Uo,az as Jo,aA as Xo,c6 as Ze,j8 as Go,lo as Vo,p0 as qo,p1 as Yo,jm as Zo,df as Ko,p2 as Qo,ea as Me,hV as Y,uM as er,ce as kt,h9 as tr,R as sr,aD as nr,T as Be,h$ as or,fM as rr,gG as Ct,h4 as ar,P as Le,h3 as ir,jQ as lr,i9 as cr,b as dr,l as ur,cB as fr,uN as hr,da as Bs,cF as mr,n as Ke,lY as Ce,d7 as zs,gZ as pr,ay as Ws,x as xr,uO as gr,eW as br,aB as yr,lM as vr,ap as wr,aq as _r,eR as Hs,t as kr,g as Cr,rh as jr}from"./hml6mmd5fyx85si7.js";import{u as jt}from"./kqu7xjhdd7w6mde0.js";import{u as Nr,b as Us,a as Sr}from"./isxemcalu9537a8n.js";import{S as $r}from"./glpkb1wyk6id03qg.js";import{C as _e,s as Tr,b as Pr,a as Mr,P as Ar,F as Ir}from"./021e7oyplaib0smf.js";import{L as Er}from"./oqyy1xfq5y51tstr.js";import{W as Fr,d as Rr,b as Lr,a as Dr}from"./fsu81ov1h2xmh0dx.js";import Or from"./n778sr6a5b9f9ss3.js";import{W as Qe}from"./eywlrsjhpmu02zoa.js";import{W as Br}from"./mc1n5d2hvi71ywqx.js";import{W as Et}from"./n0u5fqw2jde51umw.js";import{h as Js,j as zr,W as Wr}from"./ktoofw7mjru0a6r5.js";import{A as Hr}from"./itjugg22bqh0ueps.js";import{C as Ur,g as Jr}from"./gi6j3i926p314he0.js";import{e as Xr,a as Gr}from"./f2icac4qflq2ca2c.js";import{g as Vr,m as qr,A as Yr,D as Zr,b as ht,o as Kr,I as Xs,c as Qr}from"./jrr3dx16va5h9kau.js";import{u as ea}from"./nsxv1nyryaz0gxvd.js";import{S as ta}from"./grgafnin9dqj3keo.js";import{u as sa,a as na}from"./j8xxu9jjbt2cwo9f.js";import{s as oa}from"./f3481c1q9qdfwnf6.js";import{v as Ft,C as ra,A as aa,a as ia,L as la,B as ca,p as da,b as ua,c as fa,P as ha,d as ma,i as pa,e as xa}from"./ed5vp89c75l42w9w.js";import{u as Ne,t as Rt,r as mt,g as J}from"./gabg33a8gec9426u.js";import{T as R}from"./l2fd3uykkvam5v10.js";import{c as Gs}from"./ih1cbutqzs6ei1n6.js";import{t as Lt}from"./fna9z31n721lpf9f.js";import"./pc2givv05uuq8g6l.js";import"./hp08qw6yu0x90xkd.js";import"./blhqqdzhd9z6fst7.js";import"./nhs24pb9s8hnfshq.js";import"./dth89wjzf9gy8rh3.js";import"./kwjkd9zyf9vouy1r.js";import"./dc45v808kg6x38y7.js";function Dt(){return{sheets:[],styles:void 0}}const Vs={encode(e,t=new F){for(const s of e.sheets)le.encode(s,t.uint32(10).fork()).join();return e.styles!==void 0&&be.encode(e.styles,t.uint32(18).fork()).join(),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Dt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==10)break;o.sheets.push(le.decode(s,s.uint32()));continue}case 2:{if(a!==18)break;o.styles=be.decode(s,s.uint32());continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{sheets:globalThis.Array.isArray(e?.sheets)?e.sheets.map(t=>le.fromJSON(t)):[],styles:C(e.styles)?be.fromJSON(e.styles):void 0}},toJSON(e){const t={};return e.sheets?.length&&(t.sheets=e.sheets.map(s=>le.toJSON(s))),e.styles!==void 0&&(t.styles=be.toJSON(e.styles)),t},create(e){return Vs.fromPartial(e??{})},fromPartial(e){const t=Dt();return t.sheets=e.sheets?.map(s=>le.fromPartial(s))||[],t.styles=e.styles!==void 0&&e.styles!==null?be.fromPartial(e.styles):void 0,t}};function Ot(){return{rowId:"",colId:"",colOffset:"",rowOffset:""}}const D={encode(e,t=new F){return e.rowId!==""&&t.uint32(10).string(e.rowId),e.colId!==""&&t.uint32(18).string(e.colId),e.colOffset!==""&&t.uint32(26).string(e.colOffset),e.rowOffset!==""&&t.uint32(34).string(e.rowOffset),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Ot();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==10)break;o.rowId=s.string();continue}case 2:{if(a!==18)break;o.colId=s.string();continue}case 3:{if(a!==26)break;o.colOffset=s.string();continue}case 4:{if(a!==34)break;o.rowOffset=s.string();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{rowId:C(e.rowId)?globalThis.String(e.rowId):"",colId:C(e.colId)?globalThis.String(e.colId):"",colOffset:C(e.colOffset)?globalThis.String(e.colOffset):"",rowOffset:C(e.rowOffset)?globalThis.String(e.rowOffset):""}},toJSON(e){const t={};return e.rowId!==""&&(t.rowId=e.rowId),e.colId!==""&&(t.colId=e.colId),e.colOffset!==""&&(t.colOffset=e.colOffset),e.rowOffset!==""&&(t.rowOffset=e.rowOffset),t},create(e){return D.fromPartial(e??{})},fromPartial(e){const t=Ot();return t.rowId=e.rowId??"",t.colId=e.colId??"",t.colOffset=e.colOffset??"",t.rowOffset=e.rowOffset??"",t}};function Bt(){return{fromAnchor:void 0,toAnchor:void 0,chart:void 0}}const ie={encode(e,t=new F){return e.fromAnchor!==void 0&&D.encode(e.fromAnchor,t.uint32(10).fork()).join(),e.toAnchor!==void 0&&D.encode(e.toAnchor,t.uint32(18).fork()).join(),e.chart!==void 0&&_e.encode(e.chart,t.uint32(26).fork()).join(),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Bt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==10)break;o.fromAnchor=D.decode(s,s.uint32());continue}case 2:{if(a!==18)break;o.toAnchor=D.decode(s,s.uint32());continue}case 3:{if(a!==26)break;o.chart=_e.decode(s,s.uint32());continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{fromAnchor:C(e.fromAnchor)?D.fromJSON(e.fromAnchor):void 0,toAnchor:C(e.toAnchor)?D.fromJSON(e.toAnchor):void 0,chart:C(e.chart)?_e.fromJSON(e.chart):void 0}},toJSON(e){const t={};return e.fromAnchor!==void 0&&(t.fromAnchor=D.toJSON(e.fromAnchor)),e.toAnchor!==void 0&&(t.toAnchor=D.toJSON(e.toAnchor)),e.chart!==void 0&&(t.chart=_e.toJSON(e.chart)),t},create(e){return ie.fromPartial(e??{})},fromPartial(e){const t=Bt();return t.fromAnchor=e.fromAnchor!==void 0&&e.fromAnchor!==null?D.fromPartial(e.fromAnchor):void 0,t.toAnchor=e.toAnchor!==void 0&&e.toAnchor!==null?D.fromPartial(e.toAnchor):void 0,t.chart=e.chart!==void 0&&e.chart!==null?_e.fromPartial(e.chart):void 0,t}};function zt(){return{index:0,name:"",rows:[],innerXml:"",outerXml:"",columns:[],defaultRowHeight:0,charts:[],defaultColWidth:0,showGridLines:void 0}}const le={encode(e,t=new F){e.index!==0&&t.uint32(8).int32(e.index),e.name!==""&&t.uint32(18).string(e.name);for(const s of e.rows)ce.encode(s,t.uint32(26).fork()).join();e.innerXml!==""&&t.uint32(34).string(e.innerXml),e.outerXml!==""&&t.uint32(42).string(e.outerXml);for(const s of e.columns)ue.encode(s,t.uint32(50).fork()).join();e.defaultRowHeight!==0&&t.uint32(61).float(e.defaultRowHeight);for(const s of e.charts)ie.encode(s,t.uint32(66).fork()).join();return e.defaultColWidth!==0&&t.uint32(77).float(e.defaultColWidth),e.showGridLines!==void 0&&t.uint32(80).bool(e.showGridLines),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=zt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==8)break;o.index=s.int32();continue}case 2:{if(a!==18)break;o.name=s.string();continue}case 3:{if(a!==26)break;o.rows.push(ce.decode(s,s.uint32()));continue}case 4:{if(a!==34)break;o.innerXml=s.string();continue}case 5:{if(a!==42)break;o.outerXml=s.string();continue}case 6:{if(a!==50)break;o.columns.push(ue.decode(s,s.uint32()));continue}case 7:{if(a!==61)break;o.defaultRowHeight=s.float();continue}case 8:{if(a!==66)break;o.charts.push(ie.decode(s,s.uint32()));continue}case 9:{if(a!==77)break;o.defaultColWidth=s.float();continue}case 10:{if(a!==80)break;o.showGridLines=s.bool();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{index:C(e.index)?globalThis.Number(e.index):0,name:C(e.name)?globalThis.String(e.name):"",rows:globalThis.Array.isArray(e?.rows)?e.rows.map(t=>ce.fromJSON(t)):[],innerXml:C(e.innerXml)?globalThis.String(e.innerXml):"",outerXml:C(e.outerXml)?globalThis.String(e.outerXml):"",columns:globalThis.Array.isArray(e?.columns)?e.columns.map(t=>ue.fromJSON(t)):[],defaultRowHeight:C(e.defaultRowHeight)?globalThis.Number(e.defaultRowHeight):0,charts:globalThis.Array.isArray(e?.charts)?e.charts.map(t=>ie.fromJSON(t)):[],defaultColWidth:C(e.defaultColWidth)?globalThis.Number(e.defaultColWidth):0,showGridLines:C(e.showGridLines)?globalThis.Boolean(e.showGridLines):void 0}},toJSON(e){const t={};return e.index!==0&&(t.index=Math.round(e.index)),e.name!==""&&(t.name=e.name),e.rows?.length&&(t.rows=e.rows.map(s=>ce.toJSON(s))),e.innerXml!==""&&(t.innerXml=e.innerXml),e.outerXml!==""&&(t.outerXml=e.outerXml),e.columns?.length&&(t.columns=e.columns.map(s=>ue.toJSON(s))),e.defaultRowHeight!==0&&(t.defaultRowHeight=e.defaultRowHeight),e.charts?.length&&(t.charts=e.charts.map(s=>ie.toJSON(s))),e.defaultColWidth!==0&&(t.defaultColWidth=e.defaultColWidth),e.showGridLines!==void 0&&(t.showGridLines=e.showGridLines),t},create(e){return le.fromPartial(e??{})},fromPartial(e){const t=zt();return t.index=e.index??0,t.name=e.name??"",t.rows=e.rows?.map(s=>ce.fromPartial(s))||[],t.innerXml=e.innerXml??"",t.outerXml=e.outerXml??"",t.columns=e.columns?.map(s=>ue.fromPartial(s))||[],t.defaultRowHeight=e.defaultRowHeight??0,t.charts=e.charts?.map(s=>ie.fromPartial(s))||[],t.defaultColWidth=e.defaultColWidth??0,t.showGridLines=e.showGridLines??void 0,t}};function Wt(){return{index:0,cells:[],height:0,customHeight:!1}}const ce={encode(e,t=new F){e.index!==0&&t.uint32(8).int32(e.index);for(const s of e.cells)de.encode(s,t.uint32(18).fork()).join();return e.height!==0&&t.uint32(29).float(e.height),e.customHeight!==!1&&t.uint32(32).bool(e.customHeight),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Wt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==8)break;o.index=s.int32();continue}case 2:{if(a!==18)break;o.cells.push(de.decode(s,s.uint32()));continue}case 3:{if(a!==29)break;o.height=s.float();continue}case 4:{if(a!==32)break;o.customHeight=s.bool();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{index:C(e.index)?globalThis.Number(e.index):0,cells:globalThis.Array.isArray(e?.cells)?e.cells.map(t=>de.fromJSON(t)):[],height:C(e.height)?globalThis.Number(e.height):0,customHeight:C(e.customHeight)?globalThis.Boolean(e.customHeight):!1}},toJSON(e){const t={};return e.index!==0&&(t.index=Math.round(e.index)),e.cells?.length&&(t.cells=e.cells.map(s=>de.toJSON(s))),e.height!==0&&(t.height=e.height),e.customHeight!==!1&&(t.customHeight=e.customHeight),t},create(e){return ce.fromPartial(e??{})},fromPartial(e){const t=Wt();return t.index=e.index??0,t.cells=e.cells?.map(s=>de.fromPartial(s))||[],t.height=e.height??0,t.customHeight=e.customHeight??!1,t}};function Ht(){return{address:"",value:"",formula:"",dataType:"",styleIndex:0}}const de={encode(e,t=new F){return e.address!==""&&t.uint32(10).string(e.address),e.value!==""&&t.uint32(18).string(e.value),e.formula!==""&&t.uint32(26).string(e.formula),e.dataType!==""&&t.uint32(34).string(e.dataType),e.styleIndex!==0&&t.uint32(40).int32(e.styleIndex),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Ht();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==10)break;o.address=s.string();continue}case 2:{if(a!==18)break;o.value=s.string();continue}case 3:{if(a!==26)break;o.formula=s.string();continue}case 4:{if(a!==34)break;o.dataType=s.string();continue}case 5:{if(a!==40)break;o.styleIndex=s.int32();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{address:C(e.address)?globalThis.String(e.address):"",value:C(e.value)?globalThis.String(e.value):"",formula:C(e.formula)?globalThis.String(e.formula):"",dataType:C(e.dataType)?globalThis.String(e.dataType):"",styleIndex:C(e.styleIndex)?globalThis.Number(e.styleIndex):0}},toJSON(e){const t={};return e.address!==""&&(t.address=e.address),e.value!==""&&(t.value=e.value),e.formula!==""&&(t.formula=e.formula),e.dataType!==""&&(t.dataType=e.dataType),e.styleIndex!==0&&(t.styleIndex=Math.round(e.styleIndex)),t},create(e){return de.fromPartial(e??{})},fromPartial(e){const t=Ht();return t.address=e.address??"",t.value=e.value??"",t.formula=e.formula??"",t.dataType=e.dataType??"",t.styleIndex=e.styleIndex??0,t}};function Ut(){return{min:0,max:0,width:0,customWidth:!1}}const ue={encode(e,t=new F){return e.min!==0&&t.uint32(8).int32(e.min),e.max!==0&&t.uint32(16).int32(e.max),e.width!==0&&t.uint32(29).float(e.width),e.customWidth!==!1&&t.uint32(32).bool(e.customWidth),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Ut();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==8)break;o.min=s.int32();continue}case 2:{if(a!==16)break;o.max=s.int32();continue}case 3:{if(a!==29)break;o.width=s.float();continue}case 4:{if(a!==32)break;o.customWidth=s.bool();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{min:C(e.min)?globalThis.Number(e.min):0,max:C(e.max)?globalThis.Number(e.max):0,width:C(e.width)?globalThis.Number(e.width):0,customWidth:C(e.customWidth)?globalThis.Boolean(e.customWidth):!1}},toJSON(e){const t={};return e.min!==0&&(t.min=Math.round(e.min)),e.max!==0&&(t.max=Math.round(e.max)),e.width!==0&&(t.width=e.width),e.customWidth!==!1&&(t.customWidth=e.customWidth),t},create(e){return ue.fromPartial(e??{})},fromPartial(e){const t=Ut();return t.min=e.min??0,t.max=e.max??0,t.width=e.width??0,t.customWidth=e.customWidth??!1,t}};function Jt(){return{size:0,color:"",name:"",family:0,scheme:"",bold:!1,italic:!1}}const fe={encode(e,t=new F){return e.size!==0&&t.uint32(8).int32(e.size),e.color!==""&&t.uint32(18).string(e.color),e.name!==""&&t.uint32(26).string(e.name),e.family!==0&&t.uint32(32).int32(e.family),e.scheme!==""&&t.uint32(42).string(e.scheme),e.bold!==!1&&t.uint32(48).bool(e.bold),e.italic!==!1&&t.uint32(56).bool(e.italic),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Jt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==8)break;o.size=s.int32();continue}case 2:{if(a!==18)break;o.color=s.string();continue}case 3:{if(a!==26)break;o.name=s.string();continue}case 4:{if(a!==32)break;o.family=s.int32();continue}case 5:{if(a!==42)break;o.scheme=s.string();continue}case 6:{if(a!==48)break;o.bold=s.bool();continue}case 7:{if(a!==56)break;o.italic=s.bool();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{size:C(e.size)?globalThis.Number(e.size):0,color:C(e.color)?globalThis.String(e.color):"",name:C(e.name)?globalThis.String(e.name):"",family:C(e.family)?globalThis.Number(e.family):0,scheme:C(e.scheme)?globalThis.String(e.scheme):"",bold:C(e.bold)?globalThis.Boolean(e.bold):!1,italic:C(e.italic)?globalThis.Boolean(e.italic):!1}},toJSON(e){const t={};return e.size!==0&&(t.size=Math.round(e.size)),e.color!==""&&(t.color=e.color),e.name!==""&&(t.name=e.name),e.family!==0&&(t.family=Math.round(e.family)),e.scheme!==""&&(t.scheme=e.scheme),e.bold!==!1&&(t.bold=e.bold),e.italic!==!1&&(t.italic=e.italic),t},create(e){return fe.fromPartial(e??{})},fromPartial(e){const t=Jt();return t.size=e.size??0,t.color=e.color??"",t.name=e.name??"",t.family=e.family??0,t.scheme=e.scheme??"",t.bold=e.bold??!1,t.italic=e.italic??!1,t}};function Xt(){return{patternType:"",fgColor:"",bgColor:""}}const he={encode(e,t=new F){return e.patternType!==""&&t.uint32(10).string(e.patternType),e.fgColor!==""&&t.uint32(18).string(e.fgColor),e.bgColor!==""&&t.uint32(26).string(e.bgColor),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Xt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==10)break;o.patternType=s.string();continue}case 2:{if(a!==18)break;o.fgColor=s.string();continue}case 3:{if(a!==26)break;o.bgColor=s.string();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{patternType:C(e.patternType)?globalThis.String(e.patternType):"",fgColor:C(e.fgColor)?globalThis.String(e.fgColor):"",bgColor:C(e.bgColor)?globalThis.String(e.bgColor):""}},toJSON(e){const t={};return e.patternType!==""&&(t.patternType=e.patternType),e.fgColor!==""&&(t.fgColor=e.fgColor),e.bgColor!==""&&(t.bgColor=e.bgColor),t},create(e){return he.fromPartial(e??{})},fromPartial(e){const t=Xt();return t.patternType=e.patternType??"",t.fgColor=e.fgColor??"",t.bgColor=e.bgColor??"",t}};function Gt(){return{style:"",color:""}}const A={encode(e,t=new F){return e.style!==""&&t.uint32(10).string(e.style),e.color!==""&&t.uint32(18).string(e.color),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Gt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==10)break;o.style=s.string();continue}case 2:{if(a!==18)break;o.color=s.string();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{style:C(e.style)?globalThis.String(e.style):"",color:C(e.color)?globalThis.String(e.color):""}},toJSON(e){const t={};return e.style!==""&&(t.style=e.style),e.color!==""&&(t.color=e.color),t},create(e){return A.fromPartial(e??{})},fromPartial(e){const t=Gt();return t.style=e.style??"",t.color=e.color??"",t}};function Vt(){return{left:void 0,right:void 0,top:void 0,bottom:void 0}}const me={encode(e,t=new F){return e.left!==void 0&&A.encode(e.left,t.uint32(10).fork()).join(),e.right!==void 0&&A.encode(e.right,t.uint32(18).fork()).join(),e.top!==void 0&&A.encode(e.top,t.uint32(26).fork()).join(),e.bottom!==void 0&&A.encode(e.bottom,t.uint32(34).fork()).join(),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Vt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==10)break;o.left=A.decode(s,s.uint32());continue}case 2:{if(a!==18)break;o.right=A.decode(s,s.uint32());continue}case 3:{if(a!==26)break;o.top=A.decode(s,s.uint32());continue}case 4:{if(a!==34)break;o.bottom=A.decode(s,s.uint32());continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{left:C(e.left)?A.fromJSON(e.left):void 0,right:C(e.right)?A.fromJSON(e.right):void 0,top:C(e.top)?A.fromJSON(e.top):void 0,bottom:C(e.bottom)?A.fromJSON(e.bottom):void 0}},toJSON(e){const t={};return e.left!==void 0&&(t.left=A.toJSON(e.left)),e.right!==void 0&&(t.right=A.toJSON(e.right)),e.top!==void 0&&(t.top=A.toJSON(e.top)),e.bottom!==void 0&&(t.bottom=A.toJSON(e.bottom)),t},create(e){return me.fromPartial(e??{})},fromPartial(e){const t=Vt();return t.left=e.left!==void 0&&e.left!==null?A.fromPartial(e.left):void 0,t.right=e.right!==void 0&&e.right!==null?A.fromPartial(e.right):void 0,t.top=e.top!==void 0&&e.top!==null?A.fromPartial(e.top):void 0,t.bottom=e.bottom!==void 0&&e.bottom!==null?A.fromPartial(e.bottom):void 0,t}};function qt(){return{id:0,formatCode:""}}const pe={encode(e,t=new F){return e.id!==0&&t.uint32(8).int32(e.id),e.formatCode!==""&&t.uint32(18).string(e.formatCode),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=qt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==8)break;o.id=s.int32();continue}case 2:{if(a!==18)break;o.formatCode=s.string();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{id:C(e.id)?globalThis.Number(e.id):0,formatCode:C(e.formatCode)?globalThis.String(e.formatCode):""}},toJSON(e){const t={};return e.id!==0&&(t.id=Math.round(e.id)),e.formatCode!==""&&(t.formatCode=e.formatCode),t},create(e){return pe.fromPartial(e??{})},fromPartial(e){const t=qt();return t.id=e.id??0,t.formatCode=e.formatCode??"",t}};function Yt(){return{numFmtId:void 0,fontId:void 0,fillId:void 0,borderId:void 0,xfId:void 0,applyFill:void 0,applyFont:void 0,applyBorder:void 0,applyAlignment:void 0,horizontalAlignment:void 0,verticalAlignment:void 0}}const O={encode(e,t=new F){return e.numFmtId!==void 0&&t.uint32(8).int32(e.numFmtId),e.fontId!==void 0&&t.uint32(16).int32(e.fontId),e.fillId!==void 0&&t.uint32(24).int32(e.fillId),e.borderId!==void 0&&t.uint32(32).int32(e.borderId),e.xfId!==void 0&&t.uint32(40).int32(e.xfId),e.applyFill!==void 0&&t.uint32(48).bool(e.applyFill),e.applyFont!==void 0&&t.uint32(56).bool(e.applyFont),e.applyBorder!==void 0&&t.uint32(64).bool(e.applyBorder),e.applyAlignment!==void 0&&t.uint32(72).bool(e.applyAlignment),e.horizontalAlignment!==void 0&&t.uint32(82).string(e.horizontalAlignment),e.verticalAlignment!==void 0&&t.uint32(90).string(e.verticalAlignment),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Yt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==8)break;o.numFmtId=s.int32();continue}case 2:{if(a!==16)break;o.fontId=s.int32();continue}case 3:{if(a!==24)break;o.fillId=s.int32();continue}case 4:{if(a!==32)break;o.borderId=s.int32();continue}case 5:{if(a!==40)break;o.xfId=s.int32();continue}case 6:{if(a!==48)break;o.applyFill=s.bool();continue}case 7:{if(a!==56)break;o.applyFont=s.bool();continue}case 8:{if(a!==64)break;o.applyBorder=s.bool();continue}case 9:{if(a!==72)break;o.applyAlignment=s.bool();continue}case 10:{if(a!==82)break;o.horizontalAlignment=s.string();continue}case 11:{if(a!==90)break;o.verticalAlignment=s.string();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{numFmtId:C(e.numFmtId)?globalThis.Number(e.numFmtId):void 0,fontId:C(e.fontId)?globalThis.Number(e.fontId):void 0,fillId:C(e.fillId)?globalThis.Number(e.fillId):void 0,borderId:C(e.borderId)?globalThis.Number(e.borderId):void 0,xfId:C(e.xfId)?globalThis.Number(e.xfId):void 0,applyFill:C(e.applyFill)?globalThis.Boolean(e.applyFill):void 0,applyFont:C(e.applyFont)?globalThis.Boolean(e.applyFont):void 0,applyBorder:C(e.applyBorder)?globalThis.Boolean(e.applyBorder):void 0,applyAlignment:C(e.applyAlignment)?globalThis.Boolean(e.applyAlignment):void 0,horizontalAlignment:C(e.horizontalAlignment)?globalThis.String(e.horizontalAlignment):void 0,verticalAlignment:C(e.verticalAlignment)?globalThis.String(e.verticalAlignment):void 0}},toJSON(e){const t={};return e.numFmtId!==void 0&&(t.numFmtId=Math.round(e.numFmtId)),e.fontId!==void 0&&(t.fontId=Math.round(e.fontId)),e.fillId!==void 0&&(t.fillId=Math.round(e.fillId)),e.borderId!==void 0&&(t.borderId=Math.round(e.borderId)),e.xfId!==void 0&&(t.xfId=Math.round(e.xfId)),e.applyFill!==void 0&&(t.applyFill=e.applyFill),e.applyFont!==void 0&&(t.applyFont=e.applyFont),e.applyBorder!==void 0&&(t.applyBorder=e.applyBorder),e.applyAlignment!==void 0&&(t.applyAlignment=e.applyAlignment),e.horizontalAlignment!==void 0&&(t.horizontalAlignment=e.horizontalAlignment),e.verticalAlignment!==void 0&&(t.verticalAlignment=e.verticalAlignment),t},create(e){return O.fromPartial(e??{})},fromPartial(e){const t=Yt();return t.numFmtId=e.numFmtId??void 0,t.fontId=e.fontId??void 0,t.fillId=e.fillId??void 0,t.borderId=e.borderId??void 0,t.xfId=e.xfId??void 0,t.applyFill=e.applyFill??void 0,t.applyFont=e.applyFont??void 0,t.applyBorder=e.applyBorder??void 0,t.applyAlignment=e.applyAlignment??void 0,t.horizontalAlignment=e.horizontalAlignment??void 0,t.verticalAlignment=e.verticalAlignment??void 0,t}};function Zt(){return{index:0,format:void 0}}const xe={encode(e,t=new F){return e.index!==0&&t.uint32(8).int32(e.index),e.format!==void 0&&O.encode(e.format,t.uint32(18).fork()).join(),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Zt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==8)break;o.index=s.int32();continue}case 2:{if(a!==18)break;o.format=O.decode(s,s.uint32());continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{index:C(e.index)?globalThis.Number(e.index):0,format:C(e.format)?O.fromJSON(e.format):void 0}},toJSON(e){const t={};return e.index!==0&&(t.index=Math.round(e.index)),e.format!==void 0&&(t.format=O.toJSON(e.format)),t},create(e){return xe.fromPartial(e??{})},fromPartial(e){const t=Zt();return t.index=e.index??0,t.format=e.format!==void 0&&e.format!==null?O.fromPartial(e.format):void 0,t}};function Kt(){return{index:0,name:"",builtinId:"",xfId:void 0}}const ge={encode(e,t=new F){return e.index!==0&&t.uint32(8).int32(e.index),e.name!==""&&t.uint32(18).string(e.name),e.builtinId!==""&&t.uint32(26).string(e.builtinId),e.xfId!==void 0&&t.uint32(32).int32(e.xfId),t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Kt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==8)break;o.index=s.int32();continue}case 2:{if(a!==18)break;o.name=s.string();continue}case 3:{if(a!==26)break;o.builtinId=s.string();continue}case 4:{if(a!==32)break;o.xfId=s.int32();continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{index:C(e.index)?globalThis.Number(e.index):0,name:C(e.name)?globalThis.String(e.name):"",builtinId:C(e.builtinId)?globalThis.String(e.builtinId):"",xfId:C(e.xfId)?globalThis.Number(e.xfId):void 0}},toJSON(e){const t={};return e.index!==0&&(t.index=Math.round(e.index)),e.name!==""&&(t.name=e.name),e.builtinId!==""&&(t.builtinId=e.builtinId),e.xfId!==void 0&&(t.xfId=Math.round(e.xfId)),t},create(e){return ge.fromPartial(e??{})},fromPartial(e){const t=Kt();return t.index=e.index??0,t.name=e.name??"",t.builtinId=e.builtinId??"",t.xfId=e.xfId??void 0,t}};function Qt(){return{fonts:[],fills:[],cellXfs:[],borders:[],cellStyles:[],cellStyleXfs:[],numberFormats:[]}}const be={encode(e,t=new F){for(const s of e.fonts)fe.encode(s,t.uint32(10).fork()).join();for(const s of e.fills)he.encode(s,t.uint32(18).fork()).join();for(const s of e.cellXfs)O.encode(s,t.uint32(26).fork()).join();for(const s of e.borders)me.encode(s,t.uint32(34).fork()).join();for(const s of e.cellStyles)ge.encode(s,t.uint32(42).fork()).join();for(const s of e.cellStyleXfs)xe.encode(s,t.uint32(50).fork()).join();for(const s of e.numberFormats)pe.encode(s,t.uint32(58).fork()).join();return t},decode(e,t){const s=e instanceof P?e:new P(e);let r=t===void 0?s.len:s.pos+t;const o=Qt();for(;s.pos<r;){const a=s.uint32();switch(a>>>3){case 1:{if(a!==10)break;o.fonts.push(fe.decode(s,s.uint32()));continue}case 2:{if(a!==18)break;o.fills.push(he.decode(s,s.uint32()));continue}case 3:{if(a!==26)break;o.cellXfs.push(O.decode(s,s.uint32()));continue}case 4:{if(a!==34)break;o.borders.push(me.decode(s,s.uint32()));continue}case 5:{if(a!==42)break;o.cellStyles.push(ge.decode(s,s.uint32()));continue}case 6:{if(a!==50)break;o.cellStyleXfs.push(xe.decode(s,s.uint32()));continue}case 7:{if(a!==58)break;o.numberFormats.push(pe.decode(s,s.uint32()));continue}}if((a&7)===4||a===0)break;s.skip(a&7)}return o},fromJSON(e){return{fonts:globalThis.Array.isArray(e?.fonts)?e.fonts.map(t=>fe.fromJSON(t)):[],fills:globalThis.Array.isArray(e?.fills)?e.fills.map(t=>he.fromJSON(t)):[],cellXfs:globalThis.Array.isArray(e?.cellXfs)?e.cellXfs.map(t=>O.fromJSON(t)):[],borders:globalThis.Array.isArray(e?.borders)?e.borders.map(t=>me.fromJSON(t)):[],cellStyles:globalThis.Array.isArray(e?.cellStyles)?e.cellStyles.map(t=>ge.fromJSON(t)):[],cellStyleXfs:globalThis.Array.isArray(e?.cellStyleXfs)?e.cellStyleXfs.map(t=>xe.fromJSON(t)):[],numberFormats:globalThis.Array.isArray(e?.numberFormats)?e.numberFormats.map(t=>pe.fromJSON(t)):[]}},toJSON(e){const t={};return e.fonts?.length&&(t.fonts=e.fonts.map(s=>fe.toJSON(s))),e.fills?.length&&(t.fills=e.fills.map(s=>he.toJSON(s))),e.cellXfs?.length&&(t.cellXfs=e.cellXfs.map(s=>O.toJSON(s))),e.borders?.length&&(t.borders=e.borders.map(s=>me.toJSON(s))),e.cellStyles?.length&&(t.cellStyles=e.cellStyles.map(s=>ge.toJSON(s))),e.cellStyleXfs?.length&&(t.cellStyleXfs=e.cellStyleXfs.map(s=>xe.toJSON(s))),e.numberFormats?.length&&(t.numberFormats=e.numberFormats.map(s=>pe.toJSON(s))),t},create(e){return be.fromPartial(e??{})},fromPartial(e){const t=Qt();return t.fonts=e.fonts?.map(s=>fe.fromPartial(s))||[],t.fills=e.fills?.map(s=>he.fromPartial(s))||[],t.cellXfs=e.cellXfs?.map(s=>O.fromPartial(s))||[],t.borders=e.borders?.map(s=>me.fromPartial(s))||[],t.cellStyles=e.cellStyles?.map(s=>ge.fromPartial(s))||[],t.cellStyleXfs=e.cellStyleXfs?.map(s=>xe.fromPartial(s))||[],t.numberFormats=e.numberFormats?.map(s=>pe.fromPartial(s))||[],t}};function C(e){return e!=null}const ga=Gs("ChevronDownFilled","1em",["M15.8 7.73c.28.3.27.78-.03 1.06l-5.25 5a.75.75 0 0 1-1.04 0l-5.25-5a.75.75 0 0 1 1.04-1.08L10 12.2l4.73-4.5a.75.75 0 0 1 1.06.02Z"]),ba=Gs("ChevronLeftFilled","1em",["M12.27 15.8a.75.75 0 0 1-1.06-.03l-5-5.25a.75.75 0 0 1 0-1.04l5-5.25a.75.75 0 1 1 1.08 1.04L7.8 10l4.5 4.73c.29.3.28.78-.02 1.06Z"]);function ya({children:e,...t}){return n.jsxs(Cn,{...t,className:"decorated-link",children:[e,n.jsx("span",{"aria-hidden":!0,className:"ms-0.5 inline-block align-middle leading-none",children:n.jsx(kn,{className:"block h-[0.75em] w-[0.75em] stroke-current stroke-[0.75]"})})]})}const es=({children:e,"data-start":t=null,"data-end":s=null,"data-is-last-node":r,"data-is-only-node":o,tag:a})=>{const{animationTiming:l,shouldAnimate:c,shouldHide:i,isDisabled:u,onComplete:p,onReady:f}=En({isMarker:!0,tag:a,children:e,start:t,end:s,isLastNode:r,isOnlyNode:o});return u||i?n.jsx(a,{"data-start":t,"data-end":s,className:k(i&&"hidden"),children:e}):n.jsx(a,{"data-start":t,"data-end":s,className:k(rt.marker,c?rt.animate:rt.hidden),onAnimationStart:()=>f(0),onAnimationEnd:()=>p(0),style:Fn(l),children:e})},va={p:e=>n.jsx(Q,{tag:"p",...e}),h1:e=>n.jsx(Q,{tag:"h1",...e}),h2:e=>n.jsx(Q,{tag:"h2",...e}),h3:e=>n.jsx(Q,{tag:"h3",...e}),h4:e=>n.jsx(Q,{tag:"h4",...e}),h5:e=>n.jsx(Q,{tag:"h5",...e}),h6:e=>n.jsx(Q,{tag:"h6",...e}),li:e=>n.jsx(es,{tag:"li",isListItem:!0,...e}),hr:e=>n.jsx(es,{tag:"hr",...e})};function wa(e){const t=e.split(`
`),s=_a(t.pop()).trimEnd();return s&&t.push(s),t.join(`
`)}function _a(e){if(!e||/^\s*-\s*([*_]+)?\s*$/.test(e))return"";const t=[];let s="",r=0;for(;r<e.length;){if(e[r]==="*"&&e[r+1]==="*"){s+="**",t.length&&t[t.length-1]==="**"?t.pop():t.push("**"),r+=2;continue}if(e[r]==="*"||e[r]==="_"){s+=e[r];const a=e[r];t.length&&t[t.length-1]===a?t.pop():t.push(a),r++;continue}if(e[r]==="["){const a=e[r];s+=a,t.push(a),r++;continue}if(e[r]==="]"){const a=e[r];s+=a,t.length&&t[t.length-1]==="["&&t.pop(),r++;continue}if(e[r]==="("&&e[r-1]==="]"){const a=e[r];s+=a,t.push(a),r++;continue}if(e[r]===")"){const a=e[r];s+=a,t.length&&t[t.length-1]==="("&&t.pop(),r++;continue}s+=e[r],r++}if(t.length===0)return e;let o=s.trimEnd();for(;t.length;){const a=t.pop();if(a==null)break;a==="("?o+=")":o.endsWith(a)?o=o.slice(0,-a.length).trimEnd():a==="["?o+="]()":o+=a}return o}function ka({citation:e}){return n.jsx(js,{side:"top",triggerButton:n.jsx("span",{className:"inline-flex items-center font-bold",children:n.jsx($,{id:"ZNWtPG",defaultMessage:"{startChar}clipboard {icon}{endChar}",values:{startChar:"「",icon:n.jsx(Ln,{className:"mb-1 inline-block size-5"}),endChar:"」"}})}),className:"max-w-xl",children:n.jsxs("div",{className:"flex flex-col items-stretch gap-1",children:[n.jsx("div",{className:"flex justify-end border-b",children:n.jsx(Rn,{onCopy:t=>Ns(e.text,void 0,t),buttonText:!0,textPosition:"left"})}),n.jsx("div",{children:e.text})]})})}function Ca({citation:e,clientThreadId:t,nodeType:s}){const r=M(),o=Te(t),a=Dn(e.screenshot_asset_pointer,o);return s==="containerDirective"&&r.formatMessage({id:"4/Vs6a",defaultMessage:"Cited Screenshot"}),n.jsx(js,{side:"top",triggerButton:n.jsx("span",{className:"inline-flex items-center font-bold",children:n.jsx($,{id:"qUxKU1",defaultMessage:"{startChar}screenshot {icon}{endChar}",values:{startChar:"「",icon:n.jsx(Xe,{className:"mb-1 inline-block size-5"}),endChar:"」"}})}),className:"max-w-xl",children:a?n.jsx("img",{className:"w-xl max-w-screen",src:a,alt:r.formatMessage({id:"4/Vs6a",defaultMessage:"Cited Screenshot"})}):n.jsx("div",{className:"text-sm",children:n.jsx($,{id:"BUdJTR",defaultMessage:"Screenshot not available"})})})}function qs({clientThreadId:e,messageId:t,fileId:s,fileName:r,processedMarkdownInfo:o,isStandaloneAttachment:a}){const l=Te(e),c=Ve(e,h=>t?h?.tree.getNodeIfExists(t)?.message:void 0),i=m.useMemo(()=>{if(!c)return null;const h={content_type:Lo.Text,parts:[`{{file:${s}}}`]},_={...c?.metadata,is_synthetic_share_message:!0,is_standalone_share_attachment:a};return _.content_references=o?.displayedContentReferences.filter(j=>j.type!=="debug")??[],_.citations=[],o&&(h.parts=[o.rawText],_.n7jupd_crefs=o.n7jupdCrefs),{...c,id:bn(),content:h,metadata:_}},[c,s,o,a]),u=m.useMemo(()=>{if(!(!c||!i||!l))return{previewMessage:i,clientThreadId:e,fileId:s,messageId:c.id,serverThreadId:l,isStandaloneAttachment:a,fileName:r}},[i,e,s,c,l,a,r]),p=Nr({odysseyShareIntent:u,clientThreadId:e}),[f,x]=m.useState(!1);return{onClick:m.useCallback(async()=>{x(!0),await p(),x(!1)},[x,p]),isLoading:f,isEnabled:!!u}}function ja({clientThreadId:e,messageId:t,fileId:s,fileName:r,processedMarkdownInfo:o}){const a=M(),{onClick:l,isLoading:c,isEnabled:i}=qs({clientThreadId:e,messageId:t,fileId:s,fileName:r,processedMarkdownInfo:o,isStandaloneAttachment:!1});return i?n.jsx(On,{onClick:l,label:a.formatMessage({id:"ConversationTurn.sharePostButtonTooltip",defaultMessage:"Share"}),icon:c?Pe:Bn}):null}function Na(e){return e.endsWith(".md")}const Sa=({citation:e,clientThreadId:t,messageId:s})=>{const[r,o]=m.useState(!1),a=Te(t),l=qe(),[c,i]=m.useState(null),u=m.useRef(null),p=m.useCallback(w=>{l.danger(w,{toastId:"ttom_file_citation_failed_to_download_file"})},[l]),f=e.file_id,x=X(),b=L(x,"3154019201"),y=b,h=_t(),_=jt(!0,a,f,void 0,p),j=_?.data,N=_?.isPending||!1;m.useEffect(()=>{if(j?.status==="success"&&j.download_url){u.current?.abort();const w=new AbortController;u.current=w,o(!0),(async()=>{try{const d=await fetch(j.download_url,{headers:h?{}:Rs(),signal:w.signal});if(!d.ok)throw new Error(`HTTP ${d.status}`);i(await d.text())}catch(d){d.name!=="AbortError"&&l.danger("Failed to download file",{toastId:"ttom_file_citation_failed_to_download_file"})}finally{o(!1)}})()}return()=>{u.current?.abort()}},[j,l,h]);const v=m.useContext(U),g=m.useMemo(()=>{if(c==null)return null;const d=(v?.message?.metadata?.content_references_by_file??{})[e.cite_key]??[],S=Do(c,d);let T=S.processedText;const I=S.displayedContentReferences??[],G=(v?.message?.metadata?.n7jupd_crefs_by_file??{})[e.cite_key]??[];return G.length>0&&(T=zn(T,G)),{processedText:T,displayedContentReferences:I,n7jupdCrefs:G,rawText:c}},[c,v,e.cite_key]);return N||r?n.jsx(Pe,{className:"inline"}):!g||!v?.message?"[Could not display report]":n.jsx(U.Provider,{value:{...v,contentReferences:g.displayedContentReferences,n7jupdCrefs:g.n7jupdCrefs},children:n.jsxs("div",{className:"border-token-border-light dark:border-token-bg-tertiary @container relative mx-[-16px] mt-4 mb-4 flex cursor-text flex-col items-start overflow-hidden rounded-[14px] border px-4 pt-6 pb-6 contain-inline-size sm:mx-[-32px] sm:rounded-[28px] sm:px-8 sm:shadow-sm",children:[n.jsx("div",{className:"w-full pt-1 pb-1 sm:pt-4 sm:pb-3",children:n.jsx(Wn,{clientThreadId:t,componentOverrides:Hn,children:g.processedText})}),y&&n.jsx("div",{className:"flex",children:b&&n.jsx(ja,{clientThreadId:t,messageId:s,fileId:f,fileName:e.file_name,processedMarkdownInfo:g,isStandaloneAttachment:!1})})]})})},ts=(e,t)=>{const s=new Er(new URL("/assets/walnut-worker-C_tcemKC.js",import.meta.url),{type:"module"});return new Promise((r,o)=>{s.onmessage=a=>{s.terminate(),a.data.error?o(new Error(a.data.error)):r(a.data.protoBytes??new Uint8Array)},s.onerror=a=>{s.terminate(),o(a)},s.postMessage({bytes:e.buffer,ext:t},[e.buffer])})},$a=({goPrev:e,goNext:t,setIsPlaying:s,thumbnails:r,selectedSlideIdx:o})=>{const a=r.length<=1||o===0,l=r.length<=1||o===r.length-1,c=r.length<=1;return n.jsxs("div",{className:k("absolute start-1/2 bottom-2 flex -translate-x-1/2 items-center overflow-hidden rounded-2xl border","border-token-border-light bg-token-bg-primary text-token-text-primary","transition-opacity duration-150","can-hover:opacity-0 can-hover:pointer-events-none","can-hover:group-hover:opacity-100 can-hover:group-hover:pointer-events-auto"),children:[n.jsx("button",{onClick:e,disabled:a,className:"hover:text-token-text-primary disabled:text-token-text-tertiary rounded px-4 py-2",children:n.jsx(Un,{className:"icon-sm"})}),n.jsx("div",{className:"border-token-border-light h-6 border-s"}),n.jsx("button",{onClick:()=>s(!0),disabled:c,className:"hover:text-token-text-primary disabled:text-token-text-tertiary rounded px-4 py-2",children:n.jsx(Ss,{className:"size-5"})}),n.jsx("div",{className:"border-token-border-light h-6 border-s"}),n.jsx("button",{onClick:t,disabled:l,className:"hover:text-token-text-primary disabled:text-token-text-tertiary rounded px-4 py-2",children:n.jsx(Oo,{className:"icon-sm"})})]})},Ta=({walnutId:e,isLoading:t,isError:s,isInShareModal:r,errorMessage:o,handleDownloadClick:a})=>{const{presentationMap:l,setSelectedSlideIdx:c}=Us(),i=l[e]?.presentation,u=l[e]?.workbook,p=l[e]?.selectedSlideIdx,[f,x]=m.useState([]),[b,y]=m.useState(!1);if(m.useEffect(()=>{i&&(async()=>{const j=await Promise.all(i.slides.map(N=>Tr(N,i)));x(j)})()},[i]),m.useEffect(()=>{u&&(async()=>{const j=await Promise.all(u.sheets.map(N=>Pr(N,20,10,0,u)));x(j)})()},[u]),s||o==="fileTooLarge")return n.jsxs("div",{className:"flex h-[250px] flex-col items-center justify-center gap-2 text-center",children:[n.jsx("div",{className:"text-token-text-primary max-w-[80%] text-xs",children:n.jsx($,{id:"YMbrlR",defaultMessage:"Preview not available."})}),n.jsx(q,{color:"ghost",size:"small",as:"button",onClick:j=>a(j),children:n.jsx($,{id:"GjJtUJ",defaultMessage:"Download"})})]});if(t||!i&&!u||!f.length)return n.jsx("div",{className:"flex h-[250px] items-center justify-center gap-2",children:n.jsx("div",{className:"border-token-border-heavy h-4 w-4 animate-spin rounded-full border-2 border-t-transparent"})});const h=()=>{c(e,j=>j>0?j-1:f.length-1)},_=()=>{c(e,j=>j<f.length-1?j+1:0)};return n.jsxs("div",{className:"relative flex flex-col items-center",children:[i&&n.jsx($a,{goPrev:h,goNext:_,setIsPlaying:y,thumbnails:f,selectedSlideIdx:p}),n.jsx("img",{src:f[p],alt:"",className:"m-0 rounded border",style:{background:"#fff"}}),i&&b&&n.jsx(Mr,{startIndex:0,onExit:()=>y(!1),walnutId:e}),r&&n.jsx("div",{className:"from-token-main-surface-primary pointer-events-none absolute start-0 end-0 bottom-0 z-10 h-40 bg-gradient-to-t to-transparent","data-testid":"walnut-mini-player-share-gradient"})]})},Pa=({citation:e,clientThreadId:t,messageId:s})=>{const r=Jn(),[o,a]=m.useState(!1),[l,c]=m.useState(null),[i,u]=m.useState(!1),p=!!m.useContext(U)?.message.metadata?.is_standalone_share_attachment,f=Sr(),{presentationMap:x,updatePresentationMap:b,open:y}=Us(),h=X(),_=Te(t),j=L(h,"3154019201")&&!!_,N=L(h,"638971034"),v=Bo(h,"2888003541").value,g=Number(v?.max_bytes??3e7),w=qe(),d=m.useRef(null),S=m.useCallback(V=>{w.danger(V,{toastId:"w_failed_to_download_file"})},[w]),T=!!e.file_id,I=jt(!1,t,e.file_id,()=>{},S),E=x[e.file_id]?.presentation,G=x[e.file_id]?.workbook,re=m.useCallback(async V=>{if(t!==void 0){V.preventDefault();const{data:ae}=await I.refetch();if(ae===void 0||ae?.status!=="success"){w.danger("Failed to download file");return}const z=document.createElement("a");z.href=ae.download_url,z.click()}},[t,I,w]),{refetch:Ae}=I,Ie=_t();m.useEffect(()=>{d.current?.abort();const V=new AbortController;return d.current=V,a(!0),(async()=>{let ae=!1;try{const{data:z}=await Ae();if(z===void 0||z?.status!=="success"){w.danger("Failed to download file");return}const tt=await fetch(z.download_url,{headers:Ie?{}:Rs(),signal:V.signal});if(!tt.ok)throw new Error(`HTTP ${tt.status}`);const Ee=await tt.blob();if(g!==0&&Ee.size>g){u(!0),c("fileTooLarge"),ae=!0;return}const Fe=new Uint8Array(await Ee.arrayBuffer()),st=It(e.file_name)??"pptx";if(st==="pptx"){let K;if(N)K=await ts(Fe,st);else{const we=await r;if(!we)return;K=we.PptxReader.ExtractSlidesProto(Fe,!1)}const nt=Ar.decode(K);b(e.file_id,{fileBlob:Ee,fileName:e.file_name,presentation:nt,workbook:null,document:null,selectedSlideIdx:0,selectedSheetIdx:0})}else{let K;if(N)K=await ts(Fe,st);else{const we=await r;if(!we)return;K=we.XlsxReader.ExtractXlsxProto(Fe,!1)}const nt=Vs.decode(K);b(e.file_id,{fileBlob:Ee,fileName:e.file_name,presentation:null,workbook:nt,document:null,selectedSlideIdx:0,selectedSheetIdx:0})}}catch(z){z.name!=="AbortError"&&(u(!0),Ye.addError(z,{file_id:e.file_id}))}finally{a(!1),f&&!ae&&y(e.file_id)}})(),()=>{d.current?.abort()}},[Ae,w,b,e.file_name,e.file_id,f,y,g,Ie,r,N]);function Z(V){V.preventDefault(),y(e.file_id)}const{onClick:pn,isLoading:xn,isEnabled:Pt}=qs({clientThreadId:t,messageId:s,fileId:e.file_id,fileName:e.file_name,processedMarkdownInfo:null,isStandaloneAttachment:!0}),et=p&&!f,gn=It(e.file_name);return n.jsxs("div",{className:k("border-token-border-light flex max-w-[calc(0.8*var(--thread-content-max-width,40rem))] flex-col overflow-hidden rounded-lg border",p&&"mx-auto my-0"),children:[n.jsxs("div",{className:"text-token-text-secondary border-token-border-light flex flex-row justify-between gap-4 border-b p-2",children:[n.jsxs("div",{className:"flex flex-row items-center gap-2 overflow-hidden",children:[n.jsx(Ir,{fileName:e.file_name}),n.jsx("div",{className:"truncate text-sm font-medium",children:gn==="pptx"?n.jsx($,{id:"HTIcmf",defaultMessage:"Presentation"}):n.jsx($,{id:"pftlup",defaultMessage:"Spreadsheet"})})]}),n.jsxs("div",{className:"text-token-text-tertiary flex flex-row items-center",children:[!et&&n.jsxs(n.Fragment,{children:[T&&n.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary rounded-full p-1",onClick:re,children:n.jsx(Xn,{})}),n.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary disabled:text-token-text-tertiary rounded-full p-1 disabled:cursor-not-allowed disabled:bg-transparent",disabled:!E&&!G,onClick:Z,children:n.jsx($r,{})})]}),j&&!!s&&Pt&&n.jsx("button",{className:"hover:text-token-text-secondary hover:bg-token-bg-tertiary rounded-full p-1",disabled:!Pt,onClick:pn,children:xn?n.jsx(Pe,{}):n.jsx(Ma,{})})]})]}),n.jsxs("div",{className:"bg-token-bg-secondary group relative p-2",children:[n.jsx(Ta,{walnutId:e.file_id,isLoading:o,isError:i,isInShareModal:et,errorMessage:l,handleDownloadClick:re}),et&&n.jsx("div",{className:"absolute end-5 top-46 z-10 inline-flex flex-shrink-0 items-end justify-end",children:n.jsx(Gn,{className:k("inline h-4 w-24 text-end")})})]})]})},Ma=({className:e})=>n.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",className:e,children:[n.jsx("path",{d:"M3 12.4428V12.2806C3 11.9219 3.2843 11.631 3.63497 11.631C3.98563 11.631 4.26993 11.9219 4.26993 12.2806V12.4428C4.26993 13.1372 4.2708 13.6193 4.3007 13.994C4.33 14.3609 4.38426 14.5675 4.46108 14.7218L4.52821 14.8459C4.69655 15.1266 4.93812 15.3556 5.22657 15.5061L5.35059 15.5604C5.48786 15.6107 5.6688 15.6476 5.938 15.6701C6.30417 15.7008 6.77519 15.7007 7.45408 15.7007H12.546C13.2246 15.7007 13.6959 15.7008 14.0621 15.6701C14.4204 15.6402 14.6226 15.5846 14.7735 15.5061L14.8946 15.4364C15.169 15.2642 15.3929 15.0169 15.5399 14.7218L15.593 14.595C15.6421 14.4546 15.6782 14.2692 15.7003 13.994C15.7301 13.6193 15.73 13.1372 15.73 12.4428V12.2806C15.73 11.922 16.0145 11.6312 16.3651 11.631C16.7157 11.631 17 11.9219 17 12.2806V12.4428C17 13.1158 17.0006 13.6601 16.9655 14.0999C16.9342 14.4916 16.8722 14.8443 16.7343 15.1731L16.6709 15.3123C16.4174 15.8213 16.0318 16.2469 15.5585 16.544L15.3506 16.6632C14.9909 16.8507 14.6028 16.9281 14.1655 16.9646C13.7356 17.0006 13.2038 17 12.546 17H7.45408C6.79615 17 6.26438 17.0006 5.8345 16.9646C5.45207 16.9327 5.10749 16.8699 4.78649 16.729L4.65035 16.6632C4.1528 16.4038 3.73604 16.0094 3.44569 15.5251L3.32914 15.3123C3.14585 14.9444 3.07023 14.5473 3.03451 14.0999C2.9994 13.6601 3 13.1158 3 12.4428Z"}),n.jsx("path",{d:"M9.99993 13.2544C10.3505 13.2544 10.6348 12.9635 10.6348 12.6047V5.218L12.7337 7.36545L12.8335 7.44845C13.0799 7.61506 13.4146 7.58749 13.6316 7.36545C13.8486 7.14342 13.8756 6.80101 13.7127 6.54884L13.6316 6.44677L10.4493 3.19088C10.3302 3.06897 10.1683 3 9.99993 3C9.8316 3.0001 9.67044 3.06906 9.55138 3.19088L6.36815 6.44677C6.12048 6.70037 6.12057 7.11179 6.36815 7.36545C6.58526 7.58755 6.92077 7.61523 7.1673 7.44845L7.26707 7.36545L9.36491 5.21897V12.6047C9.36491 12.9634 9.64934 13.2542 9.99993 13.2544Z"})]}),Aa=new Set(["jpg","jpeg","png","gif","webp","svg"]),Ia=e=>{const t=e.split(".").pop();return t?Aa.has(t):!1};function Ea({citation:e,clientThreadId:t,messageId:s}){const r=X();return Vn(e.file_name)&&L(r,"3392860057")?n.jsx(Pa,{citation:e,clientThreadId:t,messageId:s,children:e.label??e.file_name}):Na(e.file_name)?n.jsx(Sa,{citation:e,clientThreadId:t,messageId:s}):n.jsx(Fa,{citation:e,clientThreadId:t,messageId:s})}function Fa({citation:e,clientThreadId:t}){const s=Te(t),r=qe(),o=m.useCallback(l=>{r.danger(l,{toastId:"fcoa_renderer_failed_to_download_file"})},[r]),{data:a}=jt(!0,s,e.file_id,void 0,o);return Ia(e.file_name)&&a?.download_url?n.jsx("img",{src:a?.download_url,alt:e.label??e.file_name,className:"max-h-[350px] max-w-screen"}):n.jsx("a",{href:a?.download_url,children:e.label??e.file_name})}function Ra({citationIndex:e,clientThreadId:t,nodeType:s,messageId:r}){const o=parseInt(e,10),a=m.useContext(U);if(!a)return null;const l=a.n7jupdCrefs?.[o];if(!l)return null;switch(l.type){case"clipboard":return n.jsx(ka,{citation:l});case"computer_output":return n.jsx(Ca,{citation:l,clientThreadId:t,nodeType:s});case"file":return n.jsx(Ea,{citation:l,clientThreadId:t,messageId:r});case"invalid":return null}}function La({path:e,lineRangeStart:t,lineRangeEnd:s,gitUrl:r}){const[o,a]=m.useState(!1),l=m.useContext(Qe),c=m.useRef(null),i=m.useRef(null),u=m.useRef(null),p=()=>{u.current&&(clearTimeout(u.current),u.current=null),a(!0)},f=()=>{u.current=window.setTimeout(()=>{a(!1)},200)};if(!e)return null;const x=l?.fileSnapshots.find(y=>y.path===e);if(!x)return null;const b=Oa(t,s,x);return b.length?n.jsxs(gt,{open:o,onOpenChange:a,children:[n.jsx(bt,{asChild:!0,onMouseEnter:p,onMouseLeave:f,children:n.jsx("span",{ref:c,className:"bg-token-bg-secondary text-token-text-secondary mx-0.5 inline-flex aspect-square size-min cursor-default items-center justify-center rounded-full p-1",children:n.jsx(Or,{className:"size-[10px]"})})}),n.jsx(yt,{children:n.jsx(vt,{ref:i,className:"z-50 focus:outline-none",side:"right",onMouseEnter:p,onMouseLeave:f,onOpenAutoFocus:y=>y.preventDefault(),children:n.jsx(Da,{snapshot:x,snippetLines:b,lineRangeStart:t,lineRangeEnd:s,gitUrl:r})})})]}):null}function Da({snapshot:e,snippetLines:t,lineRangeStart:s,lineRangeEnd:r,gitUrl:o}){const a=e.path.split(".").pop()??"sh",l=t.reduce((i,u)=>{if(u.trim()==="")return i;const p=u.match(/^\s*/),f=p?p[0].length:0;return i===-1?f:Math.min(i,f)},-1),c=t.map(i=>l>0?i.slice(l):i).join(`
`);return n.jsxs("div",{className:"bg-token-bg-primary border-token-border-default mx-4 flex max-h-[600px] flex-col rounded-2xl border px-2 pt-2 pb-4 shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] focus:outline-none dark:shadow-none",children:[c&&n.jsx(qn,{wrapperClassName:"rounded-lg !bg-token-bg-tertiary !border-none mb-3 max-h-[400px] overflow-auto text-xs w-[600px] max-w-full",codeContainerClassName:"!p-2",language:a,content:c,showActionBar:!1}),n.jsxs("div",{className:"grid w-full grid-cols-[minmax(0,1fr)_auto] items-center justify-between gap-1 px-2 text-sm",children:[e.path,n.jsxs("div",{className:"text-token-text-tertiary flex items-center gap-1 whitespace-nowrap",children:[n.jsx($,{id:"wham.citation.file.lineRange",defaultMessage:"Lines {lineRangeStart}-{lineRangeEnd}",values:{lineRangeStart:s,lineRangeEnd:r}}),o&&n.jsx("a",{className:"group flex w-full items-center gap-1 p-1",href:o,target:"_blank",rel:"noopener noreferrer",children:n.jsx(zo,{className:"icon-xs hover:text-token-text-primary"})})]})]})]})}function Oa(e,t,s){if(s.contents){const l=s.contents.split(`
`),c=Math.max(0,e-1),i=t?Math.min(l.length,t):c+1;return l.slice(c,i)}const r=s.line_range_contents?.find(l=>Ba(l,e,t));if(!r)return[];const o=Math.max(e-r.line_range_start,0),a=o+(t-e+1);return r.content.slice(o,a)}function Ba(e,t,s){return t<e.line_range_start?!1:!(s>e.line_range_end)}function za({assetPointer:e}){const t=m.useContext(Qe),s=M(),r=t?.imagePointers.find(l=>l.asset_pointer===e),o=$s({asset:{content_type:Ls.ImageAssetPointer,asset_pointer:r?.asset_pointer??"",size_bytes:r?.size_bytes??0,width:r?.width??0,height:r?.height??0}});if(!r||!o.data?.url)return null;const a=s.formatMessage({id:"wham.contentReference.imageAlt",defaultMessage:"Captured screenshot"});return n.jsx(Yn,{src:o.data.url,alt:a,className:"max-h-[250px] max-w-[250px]",children:n.jsx(Zn,{src:o.data.url,alt:a,width:r.width,height:r.height,className:"max-h-[250px] max-w-[250px] object-contain"})})}function Wa(){const e=Ds.getItem(Os.ProposedTasks);return e&&typeof e=="object"?e:{}}const ss=Wo(e=>({tasks:Wa(),store(t){e(s=>{const r={...s.tasks,[t.contentId]:t};return Ds.setItem(Os.ProposedTasks,r),{tasks:r}})}}));function Ha({title:e,prompt:t,environmentId:s,branch:r,contentId:o,hasHitRateLimit:a}){const[l,c]=m.useState(!1),i=Ho(),{setEnvironmentId:u,setBranch:p}=Js(),{refetch:f}=zr(),x=M(),b=qe(),y=ss(g=>g.tasks[o]),h=ss(g=>g.store),{mutate:_,isPending:j}=yn({mutationFn:()=>Wr.createNewTask(s,r,t,!1).catch(g=>{throw b.danger({id:"wham.whamComposer.failedToCreateTask",defaultMessage:"Failed to create task",description:"Toast text shown when a task failed to create."},{id:`suggestion-${o}`,duration:5,hasCloseButton:!0,toastId:"wham_proposed_task_failed_to_create_task"}),g}),onSuccess:async g=>{await f(),N(g)}}),N=g=>{try{const w=g.task.id,d=g.turn.id,S=`/codex/tasks/${w}`;h({contentId:o,prompt:t,scheduledTaskId:w,turnId:d,url:S}),c(!1)}catch{}},v=!s||!r||j||a;return n.jsxs("div",{className:k("mt-1 mb-3 flex w-full items-center rounded-xl px-3 py-3",y?"bg-token-bg-secondary border border-transparent":"bg-token-bg-primary border-token-border-default border shadow-[0px_1px_1px_0px_rgba(0,0,0,0.05)]"),children:[n.jsxs("div",{className:k("group flex flex-1 items-center gap-1",!y&&"-my-3 py-3",!y&&!v&&"cursor-pointer"),onClick:()=>{v||y||(u(s),p(r),c(!0),Et.recordProposedTaskClicked("edit"))},children:[n.jsxs("div",{className:"flex flex-col gap-0.5",children:[n.jsx("span",{className:"text-token-text-tertiary text-xs",children:n.jsx($,{id:"wham.whamProposedTask.title",defaultMessage:"Suggested task"})}),n.jsx("span",{className:k("text-sm font-medium",y&&"text-token-text-tertiary"),children:e})]}),!v&&!y&&n.jsx(Kn,{className:"icon-sm text-token-text-secondary mb-0.5 cursor-pointer self-end opacity-0 transition-opacity group-hover:opacity-100"})]}),n.jsx("div",{className:"flex items-center justify-end gap-2 text-xs",children:y?n.jsx(q,{size:"small",color:"secondary",as:"a",to:y?.url,openNewTab:!0,children:n.jsx("span",{className:"text-token-text-primary font-medium",children:n.jsx($,{id:"lwqFNG",defaultMessage:"View task"})})}):n.jsx(Ua,{prompt:a?x.formatMessage({id:"wham.proposedTask.hitRateLimit",defaultMessage:"You have reached your rate limit"}):t,tooltipEnabled:!y&&!l,children:n.jsx(q,{size:"small",color:"secondary",disabled:v,onClick:()=>{Et.recordProposedTaskClicked("create"),_()},children:n.jsxs("div",{className:"flex items-center gap-0.5",children:[n.jsx($,{id:"b2N2Y8",defaultMessage:"Start task"}),j?n.jsx(Pe,{className:"icon-xs me-[2px]"}):n.jsx(Ss,{className:"icon-sm"})]})})})}),n.jsx(ee.Root,{testId:"modal-task-stub-composer",isOpen:l,onClose:()=>c(!1),children:n.jsx(ee.Overlay,{children:n.jsxs(ee.Content,{className:"flex max-w-3xl! items-center justify-center px-12 py-4 focus:outline-hidden",size:"normal",removeBackground:!0,onEscapeKeyDown:g=>{g.stopPropagation(),c(!1)},children:[n.jsxs(Uo,{children:[n.jsx(Jo,{children:n.jsx($,{id:"wham.proposedTaskModel.title",defaultMessage:"Kick off a new Codex task"})}),n.jsx(Xo,{children:n.jsx($,{id:"wham.proposedTaskModel.description",defaultMessage:"Codex can propose new follow up tasks"})})]}),n.jsx(ut.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0},transition:{duration:i?0:.25},className:"w-full",children:n.jsxs("div",{className:"flex flex-col items-center gap-8",children:[n.jsx("h1",{className:"text-token-text-primary dark text-[28px] font-semibold",children:n.jsx($,{id:"wham.proposedTaskModal.title",defaultMessage:"Edit suggested task"})}),n.jsx(Ja,{prompt:t,onSuccess:N})]})})]})})})]})}function Ua({prompt:e,tooltipEnabled:t,children:s}){return t?n.jsx(Ze,{side:"right",label:n.jsx("span",{className:"block p-2 text-start whitespace-pre-wrap",children:e}),wide:!0,children:s}):s}function Ja({prompt:e,onSuccess:t}){const s=Go(),r=m.useMemo(()=>s?new Vo(Yo()):new qo,[s]);return m.useEffect(()=>{Zo(Ko(r),e.trimEnd())},[r,e]),n.jsx(Qo.Provider,{value:r,children:n.jsx(Br,{isBigBoxMode:!0,expanded:!0,disableDuringSubmit:!0,onSuccess:t})})}function Xa({title:e,prompt:t}){const s=m.useContext(Qe),r=Js(a=>a.getRateLimit()?.remaining===0),o=m.useMemo(()=>Ga(`${s?.taskId}:${e}:${t}`),[s?.taskId,e,t]);return!s||!s.environmentId||!s.branch?null:n.jsx(Ha,{title:e,prompt:t,environmentId:s.environmentId,branch:s.branch,contentId:o,hasHitRateLimit:r})}function Ga(e){let t=5381;for(let s=0;s<e.length;s++)t=(t<<5)+t^e.charCodeAt(s);return(t>>>0).toString(16).padStart(8,"0")}function Va({chunkId:e,lineRangeStart:t,lineRangeEnd:s}){const[r,o]=m.useState(!1),l=m.useContext(Qe)?.terminalMessageContents.find(y=>y.includes(e)),c=m.useRef(null),i=m.useRef(null),u=m.useRef(null);if(!l)return null;const p=Ya(l);if(!p)return null;const f=p.output.slice(t-1,s);if(!f.some(y=>!!y.length))return null;const x=()=>{u.current&&(clearTimeout(u.current),u.current=null),o(!0)},b=()=>{u.current=window.setTimeout(()=>{o(!1)},200)};return n.jsxs(gt,{open:r,onOpenChange:o,children:[n.jsx(bt,{asChild:!0,onMouseEnter:x,onMouseLeave:b,children:n.jsx("span",{ref:c,className:"bg-token-bg-secondary text-token-text-secondary mx-0.5 inline-flex aspect-square size-min cursor-default items-center justify-center rounded-full p-1",children:n.jsx(Qn,{className:"size-[10px]"})})}),n.jsx(yt,{children:n.jsx(vt,{ref:i,className:"z-50 focus:outline-none",side:"right",onMouseEnter:x,onMouseLeave:b,onOpenAutoFocus:y=>y.preventDefault(),children:n.jsx("div",{className:"max-h-[500px] max-w-screen px-4",children:n.jsx(qa,{lines:f,lineRangeStart:t,lineRangeEnd:s})})})})]})}function qa({lines:e,lineRangeStart:t,lineRangeEnd:s}){return n.jsxs("div",{className:"bg-token-bg-primary border-token-border-default mx-4 flex flex-col overflow-auto rounded-2xl border px-2 pt-2 pb-3 shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] focus:outline-none dark:shadow-none",children:[n.jsx(Hr,{className:"bg-token-sidebar-surface-primary dark mb-2.5 max-h-[200px] w-full overflow-auto rounded-lg p-3 font-mono text-xs whitespace-pre text-white dark:border dark:border-white/10",children:e.join(`
`)}),n.jsx("div",{className:"flex w-full justify-end gap-1 px-2 text-sm",children:n.jsx("span",{className:"text-token-text-tertiary",children:n.jsx($,{id:"wham.citation.terminal.lineRange",defaultMessage:"Lines {lineRangeStart}-{lineRangeEnd}",values:{lineRangeStart:t,lineRangeEnd:s}})})})]})}function Ya(e){try{const t=JSON.parse(e);return!("chunk_id"in t)||typeof t.chunk_id!="string"||!("session_name"in t)||typeof t.session_name!="string"||!("start_line_no"in t)||typeof t.start_line_no!="number"?null:"output"in t?t:null}catch{return null}}function Za(e){return e&&/^turn[0-9]+ifs[0-9]+$/.test(e)}const Ka=4;function Qa({metadata:e,analyticsMetadata:t,trackContentReferenceEvent:s,imageSource:r}){const o=r??Oe.Turn,a=Me(),l=e.images,c=l.some(x=>x.is_proxied_image)?[]:l.map(x=>x.thumbnail_url),i=vn({queries:c.map(x=>Vr(x)),combine:x=>{const b=new Set;return x.forEach((y,h)=>{y.isSuccess&&b.add(c[h])}),b}}),u=l.filter(x=>i.has(x.thumbnail_url)),p=e.images.length;if(l.some(x=>x.is_proxied_image)){const x=l.find(y=>y.is_proxied_image),b=k("mb-7 mt-1 min-w-32 max-w-[22%] rounded-xl border-[0.5px] border-token-border-default",x?.float_top?"relative block":"float-image z-10 float-end clear-end ms-7 overflow-hidden");return n.jsx(ye,{image:x,imageSource:o,analyticsMetadata:t,trackContentReferenceEvent:s,className:b},x?.content_url)}if(p===0)return null;if(p===1){const x=e.images[0];return n.jsx(ye,{image:x,imageSource:o,analyticsMetadata:t,trackContentReferenceEvent:s,className:"float-image border-token-border-default float-end clear-end ms-7 mt-1 mb-7 max-w-[22%] min-w-32 overflow-hidden rounded-xl border-[0.5px]"},x.content_url)}const f=a?u.length:Math.min(u.length,Ka);return n.jsx("div",{className:"no-scrollbar mt-1 mb-6 flex min-h-36 flex-nowrap gap-0.5 overflow-auto sm:gap-1 sm:overflow-hidden xl:min-h-44",children:u.slice(0,f).map((x,b)=>n.jsx("div",{className:k("border-token-border-default relative aspect-square w-32 shrink-0 overflow-hidden rounded-xl border-[0.5px] md:shrink","max-h-48 sm:w-[calc((100%-0.5rem)/4)]",b===0&&"rounded-s-xl",b===f-1&&"rounded-e-xl"),children:n.jsx(ye,{image:x,imageSource:o,analyticsMetadata:t,trackContentReferenceEvent:s,className:"h-full w-full"},x.thumbnail_url)},x.thumbnail_url))})}const Nt=m.memo(Qa,(e,t)=>e.numImageResults===t.numImageResults&&e.analyticsMetadata===t.analyticsMetadata&&e.trackContentReferenceEvent===t.trackContentReferenceEvent&&e.metadata.images.length===t.metadata.images.length&&e.metadata.images.every((s,r)=>s.content_url===t.metadata.images[r].content_url));function ye({image:e,imageSource:t,className:s,imgClassName:r,style:o,analyticsMetadata:a,trackContentReferenceEvent:l,badge:c,lightboxImages:i,aspectRatio:u}){const p=qr(e,{width:Zr,aspectRatio:u??Yr}),f=e?.content_url.replace(/^http:\/\//,"https://"),x=ei(e),{isSuccess:b}=ht(p),{isSuccess:y,isError:h}=ht(x?f:void 0),_=m.useMemo(()=>({image_url:p,title:e?.title}),[p,e?.title]);m.useEffect(()=>{e&&b&&l("Search Content Reference Shown","search_content_reference_shown","image_v2",_)},[l,e,b,_]),m.useEffect(()=>{f&&h&&Ye.addAction("Failed to download full image",{url:f,thumbnailUrl:p})},[f,h,p]);const j=Ts.useStore(),N=Kr(e?.thumbnail_crop_info??null,e?.thumbnail_size??null),v=!e||!(b||y||e.is_proxied_image),g=(()=>{if(!v)return e.is_proxied_image?e.url:x&&y?f:p})();return n.jsxs("button",{className:k("relative aspect-square overflow-hidden",s),style:o,onClick:()=>{l("Search Content Reference Clicked","search_content_reference_clicked","image_v2",_),j.setCurrentImage(e?{image:e,source:t,analyticsMetadata:a,imageResults:i}:void 0)},children:[v?n.jsx("div",{className:"bg-token-main-surface-tertiary aspect-square h-full w-full animate-pulse"}):n.jsx(Xs,{children:n.jsx("img",{src:g,alt:e?.content_url,style:N?{objectPosition:N}:{},className:k("bg-token-main-surface-tertiary m-0 h-full w-full object-cover",r)})}),c&&n.jsx("div",{className:"pointer-events-none absolute end-2 bottom-2",children:c})]})}function ei(e){return!e||e.is_proxied_image?!1:e.thumbnail_url.includes("images.openai.com/thumbnails")}function Ys({numImages:e}){return n.jsxs("div",{className:"flex items-center gap-1 rounded-full px-2 py-1.5 text-white backdrop-blur-md backdrop-brightness-75",children:[n.jsx(eo,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs font-semibold",children:e})]})}const Zs="mt-1 mb-3 [&:not(:first-child)]:mt-3",ti=/^image_group[\s\S]*$/;function si({contentReference:e,trackContentReferenceEvent:t,analyticsMetadata:s}){const{images:r,layout:o="carousel",aspect_ratio:a}=e,l=ti.test(e.matched_text??""),c=li(a??"1:1"),i={images:r,trackContentReferenceEvent:t,analyticsMetadata:s,aspectRatio:c,isReferenceComplete:l};return o==="carousel"?n.jsx(fi,{...i}):o==="bento"?n.jsx(ci,{...i}):null}const ve={width:9,height:5},ni={width:ve.width/3,height:ve.height},oi={width:ve.width/3,height:ve.height/2};function ri(e,t){if(t)switch(e){case 0:return"rounded-tr-md rounded-br-md rounded-tl-xl rounded-bl-xl";case 1:return"rounded-md";case 2:return"rounded-tr-xl rounded-br-md rounded-tl-md rounded-bl-md";case 3:return"rounded-tr-md rounded-br-xl rounded-tl-md rounded-bl-md";default:return""}switch(e){case 0:return"rounded-tr-md rounded-br-md rounded-tl-xl rounded-bl-xl";case 1:return"rounded-tr-xl rounded-br-md rounded-tl-md rounded-bl-md";case 2:return"rounded-tr-md rounded-br-xl rounded-tl-md rounded-bl-md";default:return""}}const ai=(e,t)=>e.image_result?e.image_result.content_url:`${e.image_search_query??e.image_ref_id}-${t}`;function ii({images:e,aspectRatio:t,trackContentReferenceEvent:s,analyticsMetadata:r}){const o=t.height>t.width,a=o?4:3;return n.jsx("div",{className:k("grid grid-flow-dense grid-cols-3 grid-rows-2 gap-1",Zs),style:{aspectRatio:`${ve.width}/${ve.height}`},children:e.map((l,c)=>{if(c>=a)return null;const u=o&&[0,1].includes(c),p=c===Math.min(a,e.length)-1&&e.length>a;return n.jsx(ye,{image:l.image_result??void 0,imageSource:Oe.ImageGroup,className:k("border-token-border-default h-full w-full border-[0.5px]",u&&"col-span-1 row-span-2",!o&&c===0&&"col-span-2 row-span-2",ri(c,o)),badge:p?n.jsx(Ys,{numImages:e.length}):void 0,lightboxImages:e.map(f=>f.image_result).filter(f=>!!f),aspectRatio:u?ni:oi,trackContentReferenceEvent:s,analyticsMetadata:r},ai(l,c))})})}function li(e){const[t,s]=e.split(":"),r=parseFloat(t),o=parseFloat(s);return r<=0||o<=0?{width:1,height:1}:{width:r,height:o}}const Ks=(e,t)=>e.images.length===t.images.length&&e.analyticsMetadata===t.analyticsMetadata&&e.trackContentReferenceEvent===t.trackContentReferenceEvent&&e.images.every((s,r)=>s.image_result?.content_url===t.images[r].image_result?.content_url),ci=m.memo(ii,Ks),di=3;function ui({images:e,analyticsMetadata:t,trackContentReferenceEvent:s,isReferenceComplete:r}){const o=Me(),a=e.length,l=e.map(i=>i.image_result).filter(i=>!!i);if(a===0)return null;if(a===1){const i=e[0];return!i.image_result&&!r?null:n.jsx(ye,{image:i?.image_result??void 0,imageSource:Oe.ImageGroup,analyticsMetadata:t,trackContentReferenceEvent:s,className:"float-image border-token-border-default float-end clear-end ms-7 mt-1 mb-7 w-[22%] min-w-32 overflow-hidden rounded-xl border-[0.5px]"})}const c=o?e.length:Math.min(e.length,di);return n.jsx("div",{className:k("no-scrollbar flex min-h-36 flex-nowrap gap-0.5 overflow-auto sm:gap-1 sm:overflow-hidden xl:min-h-44",Zs),children:e.slice(0,c).map((i,u)=>{const p=u===c-1;return n.jsx("div",{className:k("border-token-border-default relative aspect-square w-32 shrink-0 overflow-hidden rounded-xl border-[0.5px] md:shrink","max-h-64 sm:w-[calc((100%-0.5rem)/3)]",u===0&&"rounded-s-xl",p&&"rounded-e-xl"),children:n.jsx(ye,{image:i.image_result??void 0,imageSource:Oe.ImageGroup,lightboxImages:l,analyticsMetadata:t,trackContentReferenceEvent:s,className:"h-full w-full",badge:p&&e.length>c&&n.jsx(Ys,{numImages:e.length})})},i.image_result?.thumbnail_url??`${i.image_search_query}-${i.image_ref_id}-${u}`)})})}const fi=m.memo(ui,Ks),hi=200,mi=100,Re={id:"imagePill.screenshot",defaultMessage:"screenshot",description:"Brief text to be placed in a pill as generic fallback when screenshot url is missing"},Qs="m-0 p-[2px] pr-1",pi=k(Qs,"h-full rounded-lg object-contain"),xi=k(Qs,"p-[4px]");function ns({image:e}){const[t,s]=m.useState(!1),r=Ts.useStore(),o=m.useRef(null),a=m.useRef(null),l=M(),c=e?.content_url,i=m.useMemo(()=>c?Ge(c,"hostname"):null,[c]),u=m.useCallback(()=>{o.current&&clearTimeout(o.current)},[]),p=m.useCallback(()=>{e&&(u(),s(!1),r.setCurrentImage({image:e}))},[r,e,u]),f=m.useCallback(()=>{a.current&&clearTimeout(a.current)},[]),x=m.useCallback(()=>{s(!1)},[s]),b=m.useCallback(_=>{_.stopPropagation(),f(),o.current=setTimeout(()=>{s(!0)},hi)},[f]),y=m.useCallback(_=>{_.stopPropagation(),u(),a.current=setTimeout(()=>{x()},mi)},[u,x]);m.useEffect(()=>{t&&f()},[t,f]);const h=m.useMemo(()=>({onBlur:y,onMouseLeave:y,onMouseEnter:b,onFocus:b}),[y,b]);return e?n.jsxs("span",{onClick:p,className:"relative",...h,children:[n.jsxs(os,{isOpen:t,children:[n.jsx("img",{className:pi,src:e.thumbnail_url}),n.jsx("span",{children:i??l.formatMessage(Re)})]}),t&&n.jsx("div",{className:"absolute start-0 z-50",children:n.jsxs("div",{className:k("text-token-text-secondary border-token-border-light w-[256px] cursor-pointer px-3 pt-2 pb-3 text-sm shadow-md outline-[0.5px] outline-black/5",er),...h,children:[n.jsxs(Y,{href:e.content_url,target:"_blank",rel:"noopener",className:"z-50 mb-2 flex items-center gap-2 hover:opacity-70",onClick:_=>_.stopPropagation(),children:[n.jsx(je,{url:e.content_url,className:"m-0 size-4 p-0",size:32}),i??l.formatMessage(Re)]}),n.jsx("img",{className:"border-token-border-light m-0 cursor-pointer rounded-lg object-contain p-0 outline-[0.5px] outline-black/5",src:e.thumbnail_url,alt:i??l.formatMessage(Re),onClick:_=>{_.preventDefault(),p()}})]})})]}):n.jsxs(os,{isOpen:!1,children:[n.jsx("span",{className:xi,children:n.jsx(Pe,{})}),n.jsx("span",{children:i??l.formatMessage(Re)})]})}function os({children:e,isOpen:t,...s}){return n.jsx("span",{className:k("ms-1 cursor-pointer","inline-flex max-w-full items-center","relative top-[0.2rem]","animate-[show_150ms_ease-in]"),...s,children:n.jsx("span",{className:k("text-token-text-secondary flex h-4.5 overflow-hidden rounded-xl bg-[#F4F4F4] pe-2 text-[0.5625em] font-medium dark:bg-[#303030]","hover:bg-token-text-primary! hover:text-token-text-inverted",t&&"bg-token-main-surface-tertiary text-token-text-secondary","transition-colors duration-150 ease-in-out","items-center justify-center"),children:e})})}async function gi({conversationId:e,messageId:t,assetPointerLinks:s,sharedConversationLikeId:r}){return await sr.safePost("/conversation/get_images_for_message",{requestBody:{conversation_id:e??null,share_id:r??null,message_id:t,asset_pointer_links:s},authOption:nr.SendIfAvailable})}function bi({reference:e,conversationId:t,messageId:s,sharedConversationLikeId:r,isN7jupdMessage:o}){return wn({queryKey:["inline-images",e,t,s],queryFn:async()=>{if(!e.asset_pointer_links||e.asset_pointer_links.length===0||!t&&!r)return{images:[],formats:[]};const l=await gi({conversationId:t,messageId:s,assetPointerLinks:e.asset_pointer_links,sharedConversationLikeId:r});for(let c=0;c<l.images.length;c++){const i=l.images[c],p=`image/${l.formats[c]}`,f=yi(i,p);l.images[c]=f}return l},...o?{retry:3,retryDelay:5e3}:{}})}function yi(e,t="",s=512){const r=atob(e),o=[];for(let l=0;l<r.length;l+=s){const c=r.slice(l,l+s),i=new Array(c.length);for(let p=0;p<c.length;p++)i[p]=c.charCodeAt(p);const u=new Uint8Array(i);o.push(u)}const a=new Blob(o,{type:t});return URL.createObjectURL(a)}const vi=200;function wi({reference:e,clientThreadId:t,message:s,trackContentReferenceEvent:r}){const o=kt(t),{postId:a}=m.useContext(to),{data:l,isLoading:c,isError:i,error:u}=bi({reference:e,conversationId:o,messageId:s.id,sharedConversationLikeId:a,isN7jupdMessage:s.metadata?.n7jupd_message}),p=m.useRef([]);m.useEffect(()=>()=>{p.current.forEach(x=>{URL.revokeObjectURL(x)}),p.current=[]},[]);const f=en(s,e);return u||i||l&&!("images"in l)||c||!l?.images.length?null:(p.current=[],n.jsx(n.Fragment,{children:l?.images.map((x,b)=>{const y=tn(e,x,f);return n.jsx(Nt,{metadata:y,analyticsMetadata:{clientThreadId:t,messageId:s.id},numImageResults:1,trackContentReferenceEvent:r},`image-carousel-inline-${b}`)})}))}const _i=(e,t)=>{const s=new RegExp(t+"\\s*([^\\n]+)","m"),r=e.match(s);return r&&r[1]?r[1].trim().length:0};function en(e,t){return m.useMemo(()=>{let s=-1;return e.content.content_type==="text"&&(s=_i(e.content.parts.join(""),t.matched_text)),s<vi||s===-1},[e,t.matched_text])}function tn(e,t,s){return{matched_text:e.matched_text,start_idx:e.start_idx,end_idx:e.end_idx,safe_urls:e.safe_urls,alt:e.alt,prompt_text:e.prompt_text,type:"image_v2",refs:[],images:[{url:t,content_url:e.clicked_from_url??"",thumbnail_url:t,title:e.clicked_from_title??"",attribution:Ge(e.clicked_from_url??t,"hostname"),content_size:{width:rs,height:as},thumbnail_size:{width:rs,height:as},is_proxied_image:!0,float_top:s}]}}const rs=141,as=143;function ki({reference:e,clientThreadId:t,message:s,trackContentReferenceEvent:r}){const o=s.metadata?.n7jupd_message&&e.matched_text.includes("screenshot"),a=kt(t),l=m.useContext(tr)?.serverSharedThreadId??void 0,c=so(e.asset_pointer_links[0]),i=m.useMemo(()=>({content_type:Ls.ImageAssetPointer,size_bytes:0,width:0,height:0,asset_pointer:c}),[c]),u=$s({asset:i,sharedThreadId:l,conversationId:a}),p=u.data?.url,f=en(s,e),x=m.useMemo(()=>p?tn(e,p,f):null,[p,e,f]);return u.error||u.isError?null:o&&!u.data?.url&&u.isLoading?n.jsx(ns,{image:null},"image-pill-loading"):!o&&(u.isLoading||!u.data)||!x?null:o?n.jsx(ns,{image:x.images[0]}):n.jsx(Nt,{metadata:x,analyticsMetadata:{clientThreadId:t,messageId:s.id},numImageResults:1,trackContentReferenceEvent:r})}const H={TTFP:"products.ttfp",TTLT:"products.ttlt",TTF_VISIBLE_CONTENT_TOKEN:"products.ttf_visible_content_token"},St={[H.TTFP]:new Set,[H.TTLT]:new Set,[H.TTF_VISIBLE_CONTENT_TOKEN]:new Set};function it({profiler:e,messageId:t,metric:s,overrideDurationMs:r}){St[s].add(t);const o=rr();e.logTimingOnce(s,{context:{eval_preset:o.eval_preset},overrideDurationMs:r})}function lt({messageId:e,metric:t}){return St[t].has(e)}function sn(e){"use forget";const t=pt.c(25),{clientThreadId:s,messageId:r,products:o}=e;let a;t[0]!==r?(a=v=>[Be.getRequestId(v),Be.isMessageTurnEnded(v,r)],t[0]=r,t[1]=a):a=t[1];const[l,c]=Ve(s,a);let i;t[2]!==s?(i={namespace:oo.ProductsCompletionRequest,clientThreadId:s},t[2]=s,t[3]=i):i=t[3];const{profiler:u,isRequestActive:p}=no(i),f=p&&!c,x=ea(f);let b,y;t[4]!==f||t[5]!==r||t[6]!==o.length||t[7]!==u?(b=()=>{lt({messageId:r,metric:H.TTFP})||u&&f&&o.length>0&&it({profiler:u,messageId:r,metric:H.TTFP})},y=[f,r,o.length,u],t[4]=f,t[5]=r,t[6]=o.length,t[7]=u,t[8]=b,t[9]=y):(b=t[8],y=t[9]),m.useEffect(b,y);let h,_;t[10]!==f||t[11]!==r||t[12]!==x||t[13]!==u?(h=()=>{lt({messageId:r,metric:H.TTLT})||u&&x.current&&!f&&it({profiler:u,messageId:r,metric:H.TTLT})},_=[r,x,f,u],t[10]=f,t[11]=r,t[12]=x,t[13]=u,t[14]=h,t[15]=_):(h=t[14],_=t[15]),m.useEffect(h,_);let j;t[16]!==r||t[17]!==u||t[18]!==l?(j=()=>{if(lt({messageId:r,metric:H.TTF_VISIBLE_CONTENT_TOKEN}))return;const v=l?or(l):null;if(u&&v){const g=H.TTF_VISIBLE_CONTENT_TOKEN;St[g].add(r),it({profiler:u,messageId:r,metric:g,overrideDurationMs:v.turnTracker.first_visible_content_token_lat})}},t[16]=r,t[17]=u,t[18]=l,t[19]=j):j=t[19];let N;t[20]!==r||t[21]!==o.length||t[22]!==u||t[23]!==l?(N=[r,u,l,o.length],t[20]=r,t[21]=o.length,t[22]=u,t[23]=l,t[24]=N):N=t[24],m.useEffect(j,N)}function Ci({contentReference:e,clientThreadId:t,messageId:s,turnIndex:r,trackContentReferenceEvent:o}){const a=m.useCallback(()=>o("Search Content Reference Shown","search_content_reference_shown","product_entity",{content_reference_start_index:e.start_idx,product_id:e.product.id}),[o,e.start_idx,e.product.id]),l=m.useCallback(()=>o("Search Content Reference Clicked","search_content_reference_clicked","product_entity",{content_reference_start_index:e.start_idx,product_id:e.product.id}),[o,e.start_idx,e.product.id]),c=e.product;m.useEffect(()=>a(),[a]),sn({clientThreadId:t,messageId:s,products:[c]});const{openThreadSidebar:i}=Ct();return n.jsx("span",{className:"entity-underline hover:entity-accent inline cursor-pointer align-baseline",onClick:()=>{if(l(),c.offers||!c.url){if(!t)return;i({type:"product",clientThreadId:t,messageId:s,turnIndex:r,contentReferenceStartIndex:e.start_idx,productIndex:0})}else window.open(c.url,"_blank")},children:n.jsx("span",{className:"whitespace-normal",children:c.title})})}function nn({items:e,targetItemCount:t,onCardRender:s,onCardShown:r,onCardClicked:o,onReplyClicked:a,allowFullWidth:l=!1,cardClassName:c,showGradient:i=!0,arrowClassName:u}){const p=m.useRef(null),[f,x]=m.useState(null),b=m.useRef(null),y=()=>{b.current=setTimeout(()=>{x(null),b.current=null},200)},h=()=>{b.current&&(clearTimeout(b.current),b.current=null)},_=m.useRef(null),[j,N]=m.useState({left:0,top:0}),v=8;m.useEffect(()=>{const T=p.current,I=_.current;if(!a||!f||!T||!I)return;const E=()=>{const G=f.card.getBoundingClientRect(),re=T.getBoundingClientRect(),Ae=I.getBoundingClientRect(),Ie=G.bottom-re.top+v;var Z=G.left-re.left;Z=Math.max(0,Z),Z=Math.min(Z,re.width-Ae.width),N({left:Z,top:Ie})};return E(),T.addEventListener("scroll",E),()=>T.removeEventListener("scroll",E)},[f,e,a]);const g=Me(),w=g?2:4;if(t===void 0)t=e.length;else if(!t&&e.length<w)return null;const d=(t??e.length)>=w,S=d&&g;return n.jsxs("div",{className:"relative",children:[n.jsx("div",{ref:p,className:k("flex flex-row gap-4 py-2",S&&"mx-[-1rem] px-[1rem]",d&&"no-scrollbar snap-x snap-proximity scroll-ps-4 overflow-x-scroll scroll-smooth"),children:e.map((T,I)=>n.jsx("div",{className:k(d||!l?"w-50 shrink-0 snap-start @5xl/thread:w-61":"min-w-0 flex-1"),children:n.jsx(ji,{cardClassName:c,onShown:()=>r(T,I),onClick:()=>o(T,I),onHover:E=>{h(),E?x({card:E,item:T,index:I}):y()},children:s(T,!g&&t===1)})},I))}),d&&!S&&n.jsx(Ni,{scrollableRef:p,units:e.length,showGradient:i,arrowClassName:u}),a&&n.jsx("div",{ref:_,className:k("absolute z-10",f?"pointer-events-auto opacity-100":"pointer-events-none opacity-0","transition-[transform,opacity] duration-200"),style:{willChange:"opacity, transform",left:j.left,top:j.top,transform:f?"translateY(0)":"translateY(-8px)"},onMouseEnter:h,onMouseLeave:y,children:n.jsx(q,{className:k(f?"pointer-events-auto":"pointer-events-none","border-light bg-clip-padding px-4 py-2 shadow-md"),size:"small",color:"secondary",onClick:()=>f&&a(f.item,f.index),children:n.jsxs("div",{className:"flex flex-row items-center gap-1",children:[n.jsx(ta,{className:"icon-sm text-token-text-secondary"}),n.jsx($,{id:"9TG7OR",defaultMessage:"Ask about this"})]})})})]})}function ji({onShown:e,onClick:t,onHover:s,children:r,cardClassName:o}){const a=m.useRef(null),l=m.useRef(e);return m.useEffect(()=>{l.current=e},[e]),m.useEffect(()=>{if(!a.current)return;const c=new IntersectionObserver(([i])=>i.isIntersecting&&l.current(),{threshold:.5});return c.observe(a.current),()=>c.disconnect()},[]),n.jsx("div",{ref:a,className:k("h-full w-full","bg-token-bg-primary cursor-pointer",o),onClick:t,onMouseEnter:()=>a.current&&s(a.current),onMouseLeave:()=>s(null),children:r})}function Ni({scrollableRef:e,units:t,showGradient:s,arrowClassName:r}){const[o,a]=m.useState({left:!1,right:!1}),[l,c]=m.useState(!1);m.useEffect(()=>{const u=e.current;if(!u)return;const p=()=>{const{scrollLeft:f,scrollWidth:x,clientWidth:b}=u,y=f/(x-b);a({left:y>0,right:y<1}),!l&&f>0&&c(!0)};return p(),u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)},[e,t,l]);const i=u=>{if(!e.current)return;c(!0);const{clientWidth:p,scrollWidth:f}=e.current,x=f/t,b=Math.floor(p/x)*x;e.current.scrollBy({left:b*u,behavior:"smooth"})};return n.jsxs("div",{className:"pointer-events-none absolute start-0 top-0 flex h-full w-full flex-row",children:[n.jsx("div",{className:k("flex h-full w-9 items-center justify-start",l&&s&&"bg-linear-to-r from-(--bg-primary) to-transparent",o.left?"opacity-100":"opacity-0","transition-opacity duration-100"),children:n.jsx(q,{color:"secondary",size:"small",className:k("border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary h-10 w-10 translate-x-[-40%] rounded-full bg-clip-padding hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",r),onClick:()=>i(-1),children:n.jsx(ro,{className:"icon"})})}),n.jsx("div",{className:k("ms-auto flex h-full w-9 items-center justify-end",l&&s&&"bg-linear-to-l from-(--bg-primary) to-transparent",o.right?"opacity-100":"opacity-0","transition-opacity duration-200"),children:n.jsx(q,{color:"secondary",size:"small",className:k("border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary h-10 w-10 translate-x-[40%] rounded-full bg-clip-padding hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",r),onClick:()=>i(1),children:n.jsx(Ps,{className:"icon"})})})]})}function Si({contentReference:e,clientThreadId:t,messageId:s,turnIndex:r,analyticsMetadata:o}){const a=e.products,l=e.target_product_count;sn({clientThreadId:t,messageId:s,products:a});const{showDebugConversationTurns:c}=ar(),i=Ve(t,v=>{const w=Be.getNode(v,s).message.metadata?.content_references?.find(d=>d.type==="products");return e.start_idx===w?.start_idx}),u=X(),p=L(u,"3144771298"),f=L(u,"2212894775"),x=Ms(o),b=m.useCallback((v,g)=>x("Search Content Reference Shown","search_content_reference_shown","products",{content_reference_start_index:e.start_idx,product_index:g,product_id:v.id}),[x,e.start_idx]),y=m.useCallback((v,g)=>x("Search Content Reference Clicked","search_content_reference_clicked","products",{content_reference_start_index:e.start_idx,product_index:g,product_id:v.id}),[x,e.start_idx]),{openThreadSidebar:h}=Ct(),_=(v,g)=>{t&&(y(v,g),v.offers?h({type:"product",clientThreadId:t,messageId:s,turnIndex:r,contentReferenceStartIndex:e.start_idx,productIndex:g}):window.open(v.url,"_blank"))},{setTargetedContent:j}=ao(),N=(v,g)=>{Le.logEventWithStatsig("Product Targeted Reply Clicked","product_targeted_reply_clicked",{...ir(o),content_reference_start_index:e.start_idx,product_index:(g+1).toString(),product_id:v.id}),j({type:"object",label:v.title,createNewCompletionParams:w=>{const d=lr(v.title);return{...w,promptMessage:io(w.promptMessage,{metadata:{targeted_reply:v.title,targeted_reply_label:v.title,targeted_reply_icon:"product_tag"}}),appendMessages:[...w.appendMessages??[],d]}},onCreateCompletion:({serverThreadId:w,currentLeafId:d})=>{Le.logEventWithStatsig("Targeted Reply Submitted","chatgpt_targeted_reply_submitted",{conversation_id:w,current_leaf_id:d,source_message_id:s,content_reference_start_index:e.start_idx,product_index:(g+1).toString(),product_id:v.id})},onCleared:({serverThreadId:w,currentLeafId:d})=>{Le.logEventWithStatsig("Targeted Reply Cleared","chatgpt_targeted_reply_cleared",{conversation_id:w,current_leaf_id:d,source_message_id:s,content_reference_start_index:e.start_idx,product_index:(g+1).toString(),product_id:v.id})}})};if(e.inline_carousel&&a.length===1){const v=a[0];return n.jsx("div",{className:"flex flex-col","data-testid":"shopping-widget",children:n.jsx(Mi,{product:v,showDebug:c,onShown:()=>b(v,0),onClicked:()=>_(v,0)})})}return n.jsxs("div",{className:"flex flex-col","data-testid":"products-widget",children:[n.jsx(nn,{items:a,targetItemCount:l,onCardRender:(v,g)=>f?n.jsx(Ti,{product:v,wide:g,showDebug:c}):n.jsx($i,{product:v,wide:g,showDebug:c}),onCardShown:b,onCardClicked:_,onReplyClicked:f?void 0:N,arrowClassName:f?"translate-y-[-80%]":"",allowFullWidth:!0,showGradient:!f,cardClassName:k(f?"group":"transition-all duration-200 border-token-border-default hover:border-light border rounded-xl bg-clip-padding hover:shadow-md overflow-hidden")}),i&&p&&!f&&n.jsxs("div",{className:"text-token-text-tertiary flex text-xs hover:cursor-pointer hover:underline",onClick:()=>window.open("https://help.openai.com/en/articles/11128490","_blank"),children:[n.jsx($,{id:"4Y5Zn5",defaultMessage:"ChatGPT chooses products independently. Learn more"}),n.jsx(Ps,{className:"icon -ms-0.5"})]})]})}function $i({product:e,wide:t,showDebug:s=!1}){const r=e.image_urls?e.image_urls[0]:void 0,[o,a]=m.useState("contain"),l=m.useRef(null);return n.jsxs("div",{className:k("flex",t?"flex-row":"flex-col"),children:[n.jsxs("div",{className:k("relative aspect-square",t?"w-1/3":"w-full","bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse"),children:[r?n.jsx("img",{ref:l,className:`absolute inset-0 m-0 h-full w-full mix-blend-darken object-${o}`,src:r,alt:e.title,onLoad:()=>{if(!l.current)return;const{naturalWidth:c,naturalHeight:i}=l.current,u=c/i;a(Math.abs(u-1)<.25?"cover":"contain")}}):n.jsx("div",{className:"flex aspect-square items-center justify-center",children:n.jsx(Xe,{className:"text-token-text-tertiary h-12 w-12"})}),e.featured_tag&&n.jsx("div",{className:"absolute start-3 end-3 bottom-3",children:n.jsxs("div",{className:"relative max-w-fit px-2 py-1",children:[n.jsx("div",{className:"absolute inset-0 rounded-full bg-white/60 backdrop-blur-xl"}),n.jsx("div",{className:"relative truncate text-xs font-semibold text-gray-950",children:e.featured_tag})]})})]}),n.jsxs("div",{className:"flex flex-1 flex-col p-4",children:[n.jsx("div",{className:"line-clamp-2 leading-snug font-semibold text-ellipsis",children:e.title}),e.description&&n.jsx("div",{className:"line-clamp-3 pt-3 text-sm text-ellipsis",children:e.description}),n.jsx("div",{className:"flex-1"}),n.jsxs("div",{className:"flex flex-row items-end pt-3",children:[n.jsxs("div",{className:"flex flex-col overflow-hidden",children:[n.jsx("div",{className:"text-md leading-snug font-semibold",children:e.price}),n.jsx("div",{className:"text-token-text-secondary overflow-hidden pt-0.5 text-xs text-ellipsis whitespace-nowrap",children:e.merchants})]}),n.jsx("div",{className:"flex-1"}),e.num_reviews&&e.num_reviews>0&&n.jsxs("div",{className:"text-token-text-secondary flex w-fit flex-row gap-1 text-sm",children:[n.jsx(lo,{rating:e.rating??0/5}),(e.rating??0).toFixed(1)]})]}),!1]})]})}function Ti({product:e,wide:t,showDebug:s=!1}){const r=e.image_urls?e.image_urls[0]:void 0,[o,a]=m.useState("contain"),l=m.useRef(null);return n.jsxs("div",{className:k("flex pb-2",t?"flex-row gap-3":"flex-col gap-2"),children:[n.jsx("div",{className:k("relative",t?"aspect-square w-1/4":"aspect-[13/16] w-full","bg-token-bg-tertiary dark:bg-token-text-inverted overflow-clip rounded-xl"),children:n.jsx(Xs,{className:"mix-blend-darken dark:mix-blend-lighten",children:r?n.jsx("img",{ref:l,className:`absolute inset-0 m-0 h-full w-full object-${o}`,src:r,alt:e.title,onLoad:()=>{if(!l.current)return;const{naturalWidth:c,naturalHeight:i}=l.current,u=c/i;a(Math.abs(u-1)<.6?"cover":"contain")}}):n.jsx("div",{className:"flex aspect-square items-center justify-center",children:n.jsx(Xe,{className:"text-token-text-tertiary h-12 w-12"})})})}),n.jsxs("div",{className:"flex flex-col gap-1 px-1",children:[n.jsx("div",{className:k("line-clamp-2 font-medium text-ellipsis",t?"text-base":"text-sm"),children:e.title}),n.jsxs("div",{className:"text-token-text-secondary flex flex-row gap-0.25 text-sm",children:[n.jsx("div",{children:e.price}),n.jsx("div",{className:"mx-0.5",children:"•"}),n.jsx("div",{className:"truncate",children:e.merchants})]}),!1]})]})}function Pi({className:e,imageUrl:t,productTitle:s,onClicked:r}){const[o,a]=m.useState("contain"),l=m.useRef(null);return n.jsx("div",{className:k(e,"hover:scale-[1.005]","dark:bg-token-text-inverted bg-token-bg-primary","cursor-pointer overflow-hidden rounded-xl shadow-inner transition-all duration-200","relative aspect-square max-h-60"),onClick:r,children:t?n.jsx("img",{ref:l,className:`m-0 h-full w-full overflow-hidden object-${o} mix-blend-darken`,src:t,alt:s,onLoad:()=>{if(!l.current)return;const{naturalWidth:c,naturalHeight:i}=l.current,u=c/i;a(Math.abs(u-1)<.5?"cover":"contain")}}):n.jsx("div",{className:"flex aspect-square items-center justify-center",children:n.jsx(Xe,{className:"text-token-text-tertiary h-12 w-12"})})})}function Mi({product:e,showDebug:t=!1,onShown:s,onClicked:r}){return m.useEffect(()=>{s()},[s]),n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"flex flex-row gap-2 py-2",children:e.image_urls&&e.image_urls.length>0&&e.image_urls.slice(0,3).map(o=>n.jsx(Pi,{imageUrl:o,productTitle:e.title,onClicked:r},o))}),!1]})}function Ai({attribution:e,wordFadeType:t}){const s=m.useContext(U),r=co(s?.message.id,e.attributable_index),o=uo();return n.jsx(Fi,{isHighlighted:r,isDebugMode:o&&!1,content:e.alt??"",attributableIndex:e.attributable_index,attributions:void 0,attributionsDebug:void 0,wordFadeType:t})}const Ii=m.memo(wt);function Ei({content:e,isHighlighted:t,isDebugMode:s,attributableIndex:r,attributions:o,attributionsDebug:a,wordFadeType:l}){const c=l==="indexed",i=As(),u=m.useMemo(()=>c?{handlers:{text:(x,b,y)=>{const h=[];for(const _ of i(b.value))h.push({type:"element",tagName:"span",properties:{className:Is.fadeIn},children:[{type:"text",value:_}]});return h}}}:void 0,[c,i]),p=m.useMemo(()=>({p:({children:x})=>n.jsx(n.Fragment,{children:x})}),[]),f=n.jsx(Ii,{rehypePlugins:Cs,remarkPlugins:ks,urlTransform:_s,remarkRehypeOptions:u,components:p,children:e});return n.jsx(Ri,{isHighlighted:t,children:f})}const Fi=_n.memo(Ei);function Ri({isHighlighted:e,className:t,children:s}){return n.jsx("span",{className:k("relative","-mx-px my-[-0.2rem] rounded px-px py-[0.2rem]",e&&"attribution-highlight-bg","transition-colors duration-100 ease-in-out",t),children:s})}function is(e,t){try{return BigInt(e).toLocaleString(t)}catch{const s=Number(e);return e.includes("e")||e.includes("E")?s.toExponential():s.toLocaleString(t,{maximumFractionDigits:6})}}function Li({data:e,trackContentReferenceEvent:t}){m.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",e.type)},[t,e.type]);const s=cr().locale;return e.expression&&e.result!=null?n.jsxs("div",{className:"no-scrollbar overflow-auto sm:overflow-hidden",children:[n.jsxs("div",{className:"pb-1 text-lg font-semibold",children:[e.prefix&&n.jsx("span",{children:e.prefix}),n.jsx("span",{children:is(e.result,s)}),e.suffix&&n.jsx("span",{children:e.suffix})]}),n.jsx("div",{className:"text-token-text-primary tracking-wide",children:`${e.expression}=${is(e.result,s)}`})]}):null}function on({ref:e,onClick:t,onMouseEnter:s,onMouseLeave:r}){const o=M();return n.jsx("button",{ref:e,"aria-label":o.formatMessage({id:"citation.icon.label",defaultMessage:"Coding Citation"}),onClick:t,onMouseEnter:s,onMouseLeave:r,className:k("rounded-xl px-1","bg-token-interactive-bg-tertiary-press text-token-text-secondary hover:text-token-text-inverted hover:bg-token-interactive-bg-primary-selected"),children:n.jsx(fo,{className:"icon-sm"})})}function Di({codeMessage:e,codeExecutionOutputMessage:t,onDismiss:s,FormattedText:r}){const o=M();return n.jsx(ee.Root,{isOpen:!0,onClose:s,testId:"modal-code-execution",children:n.jsx(ee.Overlay,{children:n.jsxs(ee.Content,{className:"flex max-h-[75vh] max-w-lg flex-col overflow-hidden",children:[n.jsx(ee.Header,{title:o.formatMessage(Oi.title),type:"success",closeButton:n.jsx(dr,{onClick:s})}),n.jsxs("div",{className:"flex flex-1 flex-col overflow-auto",children:[n.jsx("div",{children:n.jsx(ho,{FormattedText:r,message:e,codeRendererClassName:"border-none rounded-none",removeTopBorderRadius:!0})}),n.jsx("div",{children:n.jsx(mo,{message:t})})]})]})})})}const Oi=xt({title:{id:"CodeExecutionOutputModal.title",defaultMessage:"Analysis"}});function Bi({displayInfo:e,FormattedText:t,trackContentReferenceEvent:s}){const[r,o]=m.useState(!1),a=M();return m.useEffect(()=>{s("Search Content Reference Shown","search_content_reference_shown",e.type)},[s,e.type]),n.jsxs(n.Fragment,{children:[n.jsx(Ze,{label:a.formatMessage(zi.viewAnalysis),side:"top",delayDuration:150,className:"align-middle",children:n.jsx(on,{onClick:()=>o(!0)})}),r&&n.jsx(Di,{FormattedText:t,codeMessage:e.codeMessage,codeExecutionOutputMessage:e.codeExecutionOutputMessage,onDismiss:()=>o(!1)})]})}const zi=xt({viewAnalysis:{id:"viewAnalysis",defaultMessage:"View analysis"}});function Wi({contentReference:e,clientThreadId:t,turnIndex:s}){const{toggleThreadSidebar:r}=Ct(),o=po("codingCitations"),[a,l]=m.useState(!1),c=m.useRef(null),i=()=>{c.current!=null&&window.clearTimeout(c.current),l(!0)},u=()=>{c.current=window.setTimeout(()=>l(!1),100)},p=m.useCallback(()=>{t&&r({type:"codingCitations",clientThreadId:t,turnIndex:s||1,messageId:e.cited_message?.id??"",matchedText:e.matched_text},o)},[r,t,o,e,s]);if(!e.cited_message||!e.highlighted_text)return null;let f;e.type==="python"?f=e.cited_message?.metadata?.aggregate_result?.code:e.type==="container"&&(f=e.cited_message?.metadata?.container_citation?.source_cmd);const x=f?.split(`
`).length??0;return n.jsx("span",{className:"relative top-[0.1rem] inline-block align-middle",children:n.jsx("span",{className:"inline-flex items-center",children:n.jsxs(gt,{open:a,onOpenChange:l,children:[n.jsx(bt,{asChild:!0,children:n.jsx(on,{onClick:p,onMouseEnter:i,onMouseLeave:u})}),n.jsx(yt,{children:n.jsx(vt,{align:"start",sideOffset:4,onMouseEnter:i,onMouseLeave:u,className:k("border-default bg-token-bg-primary rounded-2xl border p-3"),children:n.jsxs("aside",{className:"flex flex-col gap-3",children:[n.jsx("h2",{className:k("text-token-text-secondary text-xs font-medium"),children:e.type==="python"?n.jsx($,{id:"citation.popover.label.python",defaultMessage:"Python script · {count, number} lines",values:{count:x}}):n.jsx($,{id:"citation.popover.label.container",defaultMessage:"Bash script · {count, number} lines",values:{count:x}})}),n.jsx("hr",{}),n.jsx("h2",{className:k("text-sm font-medium","max-w-full break-words whitespace-pre-line sm:max-w-[300px]"),children:e.highlighted_text})]})})})]})})})}function Hi({iconRef:e,className:t,alt:s}){const r=e?.vector_url??e?.raster_url;return r?n.jsx("img",{src:r,className:t,alt:s}):n.jsx(Es,{className:t})}function rn(e,t,s,r){const o=L(s,"3958255976"),a=L(s,"1424158285"),l=xo(e.cloud_doc_url??""),c=(o?e.fff_metadata?.name:void 0)??e.name,i=(o?e.fff_metadata?.display_file_type_name:void 0)??l?.type??r.formatMessage({id:"bqY3sN",defaultMessage:"File"}),u=(o&&e.fff_metadata?.display_file_type_icon?n.jsx(Hi,{alt:i,className:t,iconRef:e.fff_metadata?.display_file_type_icon}):void 0)??(l?.Icon?n.jsx(l.Icon,{alt:i,className:t}):e.cloud_doc_url?a?n.jsx(je,{url:e.cloud_doc_url,className:t,fallback:n.jsx(ft,{alt:i,className:t})}):n.jsx(ft,{alt:i,className:t}):void 0)??n.jsx(Es,{alt:i,className:t}),p=(o?e.fff_metadata?.capabilities?.user_view:void 0)??e.cloud_doc_url;let f;o&&e.fff_metadata?.snippet&&e.fff_metadata?.snippet.content.content_type==="text"?f=e.fff_metadata.snippet.content.text:f=e.description;const x=(o?e.fff_metadata?.file_last_modified_time:void 0)??e.last_modified_time,b=o?e.fff_metadata?.file_created_time:void 0;return{fileName:c,fileTypeDisplayName:i,fileTypeIcon:u,url:p,snippet:f,fileLastModifiedTime:x,fileCreatedTime:b}}const ls=24;function Ui(e){const t=e.split(".");let s=e;return t.length>1&&t.slice(0,-1).some(r=>r.length>0)&&(s=t.slice(0,-1).join(".")),s.length>ls&&(s=s.slice(0,ls-1)+"…"),s}function Ji({fileRef:e,index:t,trackContentReferenceEvent:s}){const r=ur(fr),o=hr(),a=m.useContext(U),l=m.useMemo(()=>({source:e.source,index:t}),[e.source,t]);m.useEffect(()=>{s("File Citation Shown","file_citation_shown","file",l)},[]);const c=m.useCallback(x=>{x?s("File Citation Hovered","file_citation_hovered","file",l):s("File Citation Unhovered","file_citation_unhovered","file",l)},[l,s]),i=m.useCallback(()=>{s("File Citation Clicked","file_citation_clicked","file",l)},[l,s]),u=m.useCallback(()=>{s("File Citation Followup Clicked","file_citation_followup_clicked","file",l)},[l,s]),p=m.useCallback(()=>o(e.id,e.name),[o,e.id,e.name]),f=Ve(a?.analyticsMetadata.clientThreadId??Bs,x=>x?.mode);return r&&Fs(e.id)?null:go(f)?f.gizmo_id&&mr(f.gizmo_id)?n.jsx("span",{className:k(oa,"ms-1"),title:e.name,children:Ui(e.name)}):null:n.jsx(Xi,{fileItem:e,onClickDownloadFile:p,trackCloudLinkClick:i,trackFileCitationFollowup:u,trackTooltipOpenChange:c})}function Xi({className:e,fileItem:t,onClickDownloadFile:s,trackCloudLinkClick:r,trackFileCitationFollowup:o,trackTooltipOpenChange:a}){const l=M(),c=X(),i=L(c,"1424158285"),{fileName:u,fileTypeDisplayName:p,fileTypeIcon:f,url:x,snippet:b}=rn(t,"h-[16px] w-[16px] object-contain",c,l);let y=k("ms-1 flex h-[22px] items-center rounded-xl px-2 relative bottom-[-2px]","text-token-text-secondary! hover:bg-token-bg-secondary dark:bg-token-main-surface-secondary dark:hover:bg-token-bg-secondary",e);i||(y+=" bg-[#f4f4f4] ");const h=n.jsx("span",{className:"relative inline-flex items-center",children:x?n.jsx(Y,{href:x,className:y,onClick:r,children:f}):Fs(t.id)?n.jsx("button",{onClick:s,className:y,children:f}):n.jsx("span",{className:y,children:n.jsx(ft,{})})});return n.jsx(Gi,{contentType:p,fileId:t.id,href:x,icon:f,name:u,snippet:b,trackFileCitationFollowup:o,trackTooltipOpenChange:a,fileItem:t,children:h})}function Gi({children:e,className:t,contentType:s,fileId:r,href:o,icon:a,name:l,snippet:c,trackFileCitationFollowup:i,trackTooltipOpenChange:u,fileItem:p}){const f=Ke(),b=m.useContext(U)?.clientThreadId??Bs,y=_t(),h=X(),_=L(h,"1424158285"),j=L(h,"733205176"),N=sa(b,r,l,o),v=m.useCallback((g,w)=>{w.length&&(N(g,w),i?.())},[N,i]);return n.jsx(Ze,{label:n.jsxs(n.Fragment,{children:[n.jsxs(Y,{href:o,className:k("text-token-text-primary flex max-w-80 flex-col gap-1 text-start text-xs font-normal no-underline!",t),children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("div",{className:"h-4 w-4 shrink-0 overflow-hidden rounded-full",children:a}),n.jsx("div",{className:"text-token-text-primary truncate",children:_?p.medical_file_reference?.journal_name:s})]}),n.jsx("div",{className:"line-clamp-2 text-sm font-medium break-all",children:l}),_&&n.jsxs("div",{className:"line-clamp-2 text-sm break-words",children:[n.jsx("span",{className:"italic",children:p.medical_file_reference?.authors_display}),n.jsx("span",{className:"ms-1 not-italic",children:p.medical_file_reference?.publication_year})]}),c&&n.jsx("div",{className:"text-token-text-secondary line-clamp-2 text-sm",children:c})]}),y||j?null:n.jsx("div",{className:"flex w-full cursor-pointer flex-row items-center gap-2 pt-3 text-sm",children:n.jsx(na,{sendReply:v})})]}),align:"start",cornerRadius:"xl",customBorderClassName:"border-token-border-default border",customPaddingClassName:"p-3",delayDuration:150,interactive:!0,onOpenChange:u,side:"bottom",theme:f?"default":"white",wide:!0,children:e})}function Vi(e,t){return new Date(e).toLocaleDateString(t,{month:"long",day:"numeric",year:"numeric"})}function qi({metadata:e,trackContentReferenceEvent:t}){return e.items.length===0?null:n.jsx("div",{className:"mt-6 flex flex-col gap-3",children:e.items.map((s,r)=>n.jsx(Yi,{item:s,index:r,trackContentReferenceEvent:t},r))})}function Yi({item:e,index:t,trackContentReferenceEvent:s}){const r=M(),o=X(),{fileName:a,fileTypeDisplayName:l,fileTypeIcon:c,snippet:i,url:u,fileLastModifiedTime:p}=rn(e,"icon object-contain",o,r),f={title:a,description:i?.toString()??"",index:t};return m.useEffect(()=>{s("Contextual Answers Content Reference Shown","contextual_answers_content_reference_shown","file_navlist",f)},[]),n.jsxs(Y,{className:"group/nav-list relative flex items-center gap-6 py-1.5",href:u??"/",onClick:()=>{s("Contextual Answers Content Reference Clicked","contextual_answers_content_reference_clicked","file_navlist",f)},children:[n.jsx("div",{className:"absolute start-0 top-0 bottom-0 w-[3px] rounded-t-lg rounded-b-lg bg-black/10"}),n.jsxs("div",{className:"ms-4 flex grow flex-col gap-1 overflow-hidden text-ellipsis",children:[n.jsxs("div",{className:"not-prose text-token-text-primary flex items-center gap-1.5 text-sm",children:[c,n.jsx("div",{className:"text-token-text-primary line-clamp-2 text-sm",children:l})]}),n.jsx("div",{className:"text-token-link decoration-token-link line-clamp-2 font-semibold group-hover/nav-list:underline",children:a}),n.jsx("div",{className:"text-token-text-primary line-clamp-2 text-sm leading-snug font-normal",children:i}),p&&n.jsx("div",{className:"text-token-text-secondary text-sm",children:Vi(p,r.locale)})]})]})}var ct={line:{color:"#F66",width:1,dashPattern:[]},sync:{enabled:!0,group:1,suppressTooltips:!1},zoom:{enabled:!0,zoomboxBackgroundColor:"rgba(66,133,244,0.2)",zoomboxBorderColor:"#48F",zoomButtonText:"Reset Zoom",zoomButtonClass:"reset-zoom"},snap:{enabled:!1},callbacks:{beforeZoom:function(e,t){return!0},afterZoom:function(e,t){}}},Zi={id:"crosshair",afterInit:function(e){if(e.config.options.scales.x){var t=e.config.options.scales.x.type;if(!(t!=="linear"&&t!=="time"&&t!=="category"&&t!=="logarithmic")){e.options.plugins.crosshair===void 0&&(e.options.plugins.crosshair=ct),e.crosshair={enabled:!1,suppressUpdate:!1,x:null,originalData:[],originalXRange:{},dragStarted:!1,dragStartX:null,dragEndX:null,suppressTooltips:!1,ignoreNextEvents:0,reset:function(){this.resetZoom(e,!1,!1)}.bind(this)};var s=this.getOption(e,"sync","enabled");s&&(e.crosshair.syncEventHandler=function(r){this.handleSyncEvent(e,r)}.bind(this),e.crosshair.resetZoomEventHandler=function(r){var o=this.getOption(e,"sync","group");r.chartId!==e.id&&r.syncGroup===o&&this.resetZoom(e,!0)}.bind(this),window.addEventListener("sync-event",e.crosshair.syncEventHandler),window.addEventListener("reset-zoom-event",e.crosshair.resetZoomEventHandler)),e.panZoom=this.panZoom.bind(this,e)}}},afterDestroy:function(e){var t=this.getOption(e,"sync","enabled");t&&(window.removeEventListener("sync-event",e.crosshair.syncEventHandler),window.removeEventListener("reset-zoom-event",e.crosshair.resetZoomEventHandler))},panZoom:function(e,t){if(e.crosshair.originalData.length!==0){var s=e.crosshair.end-e.crosshair.start,r=e.crosshair.min,o=e.crosshair.max;t<0?(e.crosshair.start=Math.max(e.crosshair.start+t,r),e.crosshair.end=e.crosshair.start===r?r+s:e.crosshair.end+t):(e.crosshair.end=Math.min(e.crosshair.end+t,e.crosshair.max),e.crosshair.start=e.crosshair.end===o?o-s:e.crosshair.start+t),this.doZoom(e,e.crosshair.start,e.crosshair.end)}},getOption:function(e,t,s){return Ft(e.options.plugins.crosshair[t]?e.options.plugins.crosshair[t][s]:void 0,ct[t][s])},getXScale:function(e){return e.data.datasets.length?e.scales[e.getDatasetMeta(0).xAxisID]:null},getYScale:function(e){return e.scales[e.getDatasetMeta(0).yAxisID]},handleSyncEvent:function(e,t){var s=this.getOption(e,"sync","group");if(t.chartId!==e.id&&t.syncGroup===s){var r=this.getXScale(e);if(r){var o=t.original.native.buttons===void 0?t.original.native.which:t.original.native.buttons;t.original.type==="mouseup"&&(o=0);var a={type:t.original.type=="click"?"mousemove":t.original.type,chart:e,x:r.getPixelForValue(t.xValue),y:t.original.y,native:{buttons:o},stop:!0};e._eventHandler(a)}}},afterEvent:function(e,t){if(e.config.options.scales.x.length==0)return;let s=t.event;var r=e.config.options.scales.x.type;if(!(r!=="linear"&&r!=="time"&&r!=="category"&&xscaleType!=="logarithmic")){var o=this.getXScale(e);if(o){if(e.crosshair.ignoreNextEvents>0){e.crosshair.ignoreNextEvents-=1;return}var a=s.native.buttons===void 0?s.native.which:s.native.buttons;s.native.type==="mouseup"&&(a=0);var l=this.getOption(e,"sync","enabled"),c=this.getOption(e,"sync","group");if(!s.stop&&l){var t=new CustomEvent("sync-event");t.chartId=e.id,t.syncGroup=c,t.original=s,t.xValue=o.getValueForPixel(s.x),window.dispatchEvent(t)}var i=this.getOption(e,"sync","suppressTooltips");if(e.crosshair.suppressTooltips=s.stop&&i,e.crosshair.enabled=s.type!=="mouseout"&&s.x>o.getPixelForValue(o.min)&&s.x<o.getPixelForValue(o.max),!e.crosshair.enabled&&!e.crosshair.suppressUpdate)return s.x>o.getPixelForValue(o.max)&&(e.crosshair.suppressUpdate=!0,e.update("none")),e.crosshair.dragStarted=!1,!1;e.crosshair.suppressUpdate=!1;var u=this.getOption(e,"zoom","enabled");if(a===1&&!e.crosshair.dragStarted&&u&&(e.crosshair.dragStartX=s.x,e.crosshair.dragStarted=!0),e.crosshair.dragStarted&&a===0){e.crosshair.dragStarted=!1;var p=o.getValueForPixel(e.crosshair.dragStartX),f=o.getValueForPixel(e.crosshair.x);Math.abs(e.crosshair.dragStartX-e.crosshair.x)>1&&this.doZoom(e,p,f),e.update("none")}e.crosshair.x=s.x,e.draw()}}},afterDraw:function(e){if(e.crosshair.enabled)return e.crosshair.dragStarted?this.drawZoombox(e):(this.drawTraceLine(e),this.interpolateValues(e),this.drawTracePoints(e)),!0},beforeTooltipDraw:function(e){return!e.crosshair.dragStarted&&!e.crosshair.suppressTooltips},resetZoom:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(s){if(e.crosshair.originalData.length>0)for(var r=0;r<e.data.datasets.length;r++){var o=e.data.datasets[r];o.data=e.crosshair.originalData.shift(0)}e.crosshair.originalXRange.min?(e.options.scales.x.min=e.crosshair.originalXRange.min,e.crosshair.originalXRange.min=null):delete e.options.scales.x.min,e.crosshair.originalXRange.max?(e.options.scales.x.max=e.crosshair.originalXRange.max,e.crosshair.originalXRange.max=null):delete e.options.scales.x.max}e.crosshair.button&&e.crosshair.button.parentNode&&(e.crosshair.button.parentNode.removeChild(e.crosshair.button),e.crosshair.button=!1);var a=this.getOption(e,"sync","enabled");if(!t&&s&&a){var l=this.getOption(e,"sync","group"),c=new CustomEvent("reset-zoom-event");c.chartId=e.id,c.syncGroup=l,window.dispatchEvent(c)}s&&e.update("none")},doZoom:function(e,t,s){if(t>s){var r=t;t=s,s=r}var o=Ft(e.options.plugins.crosshair.callbacks?e.options.plugins.crosshair.callbacks.beforeZoom:void 0,ct.callbacks.beforeZoom);if(!o(t,s))return!1;if(e.crosshair.dragStarted=!1,e.options.scales.x.min&&e.crosshair.originalData.length===0&&(e.crosshair.originalXRange.min=e.options.scales.x.min),e.options.scales.x.max&&e.crosshair.originalData.length===0&&(e.crosshair.originalXRange.max=e.options.scales.x.max),!e.crosshair.button){var a=document.createElement("button"),l=this.getOption(e,"zoom","zoomButtonText"),c=this.getOption(e,"zoom","zoomButtonClass"),i=document.createTextNode(l);a.appendChild(i),a.className=c,a.addEventListener("click",function(){this.resetZoom(e)}.bind(this)),e.canvas.parentNode.appendChild(a),e.crosshair.button=a}e.options.scales.x.min=t,e.options.scales.x.max=s;var u=e.crosshair.originalData.length===0,p=e.config.options.scales.x.type!=="category";if(p)for(var f=0;f<e.data.datasets.length;f++){var x=[],b=0,y=!1,h=!1;u&&(e.crosshair.originalData[f]=e.data.datasets[f].data);for(var _=e.crosshair.originalData[f],j=0;j<_.length;j++){var N=_[j],v=N.x!==void 0?N.x:NaN;v>=t&&!y&&b>0&&(x.push(_[b-1]),y=!0),v>=t&&v<=s&&x.push(N),v>s&&!h&&b<_.length&&(x.push(N),h=!0),b+=1}e.data.datasets[f].data=x}if(e.crosshair.start=t,e.crosshair.end=s,u){var g=this.getXScale(e);e.crosshair.min=g.min,e.crosshair.max=g.max}e.crosshair.ignoreNextEvents=2,e.update("none");var w=this.getOption(e,"callbacks","afterZoom");w(t,s)},drawZoombox:function(e){var t=this.getYScale(e),s=this.getOption(e,"zoom","zoomboxBorderColor"),r=this.getOption(e,"zoom","zoomboxBackgroundColor");e.ctx.beginPath(),e.ctx.rect(e.crosshair.dragStartX,t.getPixelForValue(t.max),e.crosshair.x-e.crosshair.dragStartX,t.getPixelForValue(t.min)-t.getPixelForValue(t.max)),e.ctx.lineWidth=1,e.ctx.strokeStyle=s,e.ctx.fillStyle=r,e.ctx.fill(),e.ctx.fillStyle="",e.ctx.stroke(),e.ctx.closePath()},drawTraceLine:function(e){var t=this.getYScale(e),s=this.getOption(e,"line","width"),r=this.getOption(e,"line","color"),o=this.getOption(e,"line","dashPattern"),a=this.getOption(e,"snap","enabled"),l=e.crosshair.x;a&&e._active.length&&(l=e._active[0].element.x),e.ctx.beginPath(),e.ctx.setLineDash(o),e.ctx.moveTo(l,t.getPixelForValue(t.max)),e.ctx.lineWidth=s,e.ctx.strokeStyle=r,e.ctx.lineTo(l,t.getPixelForValue(t.min)),e.ctx.stroke(),e.ctx.setLineDash([])},drawTracePoints:function(e){for(var t=0;t<e.data.datasets.length;t++){var s=e.data.datasets[t],r=e.getDatasetMeta(t),o=e.scales[r.yAxisID];r.hidden||!s.interpolate||(e.ctx.beginPath(),e.ctx.arc(e.crosshair.x,o.getPixelForValue(s.interpolatedValue),3,0,2*Math.PI,!1),e.ctx.fillStyle="white",e.ctx.lineWidth=2,e.ctx.strokeStyle=s.borderColor,e.ctx.fill(),e.ctx.stroke())}},interpolateValues:function(e){for(var t=0;t<e.data.datasets.length;t++){var s=e.data.datasets[t],r=e.getDatasetMeta(t),o=e.scales[r.xAxisID],a=o.getValueForPixel(e.crosshair.x);if(!(r.hidden||!s.interpolate)){var l=s.data,c=l.findIndex(function(f){return f.x>=a}),i=l[c-1],u=l[c];if(e.data.datasets[t].steppedLine&&i)s.interpolatedValue=i.y;else if(i&&u){var p=(u.y-i.y)/(u.x-i.x);s.interpolatedValue=i.y+(a-i.x)*p}else s.interpolatedValue=NaN}}}};const ze=(e=1)=>`rgba(48, 166, 51, ${e})`,We=(e=1)=>`rgba(241, 77, 66, ${e})`,cs="text-[#30a633]",ds="text-[#f14d42]",Ki=["1d","5d","1m","6m","ytd","1y","5y","max"];function Qi({histories:e,selectedInterval:t,onSelectHistoryInterval:s}){const r=Object.keys(e?.quotes??{});return n.jsx("div",{className:"text-token-text-tertiary inline-flex items-start justify-between rounded-[10px] bg-[#f4f4f4] p-[3px] text-xs font-semibold sm:justify-start sm:gap-1 dark:bg-[#393939]",children:r.map(o=>n.jsx("button",{onClick:()=>{s?.(o)},className:k("border border-transparent px-3 py-1.5 text-xs font-semibold uppercase",t===o?"border-token-border-default! bg-token-main-surface-primary text-token-text-primary shadow-xxs dark:border-token-border-medium! rounded-lg":"hover:text-token-text-secondary"),children:an[o].label},o))})}const an={"1d":{label:"1D",formatTimestampLabel:us,formatTimestampTooltip:us,maxTicksLimit:6,lineTension:.1},"5d":{label:"5D",formatTimestampLabel:fs,formatTimestampTooltip:tl,maxTicksLimit:6,lineTension:.1},"1m":{label:"1M",formatTimestampLabel:fs,formatTimestampTooltip:sl,maxTicksLimit:6,lineTension:.1,useUtc:!0},"6m":{label:"6M",formatTimestampLabel:dt,formatTimestampTooltip:ke,maxTicksLimit:5,lineTension:.1,useUtc:!0},ytd:{label:"YTD",formatTimestampLabel:dt,formatTimestampTooltip:ke,maxTicksLimit:5,lineTension:.1,useUtc:!0},"1y":{label:"1Y",formatTimestampLabel:dt,formatTimestampTooltip:ke,maxTicksLimit:5,lineTension:.2,useUtc:!0},"5y":{label:"5Y",formatTimestampLabel:hs,formatTimestampTooltip:ke,maxTicksLimit:5,lineTension:.2,useUtc:!0},max:{label:"max",formatTimestampLabel:hs,formatTimestampTooltip:ke,maxTicksLimit:5,lineTension:.2,useUtc:!0}};function el(e){return e?Ki.filter(s=>s in e.quotes).find(s=>e.quotes[s].length>0):void 0}function oe(e,t){return Ne(new Date(e*1e3),t??"America/New_York")}function us(e,t,s){const r=oe(t,s);return e.formatTime(r,{hour:"numeric",minute:"numeric"})}function tl(e,t,s){const r=oe(t,s);return e.formatDate(r,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}function ke(e,t,s){const r=oe(t,s);return e.formatDate(r,{month:"short",day:"numeric",year:"numeric"})}function dt(e,t,s){const r=oe(t,s);return e.formatDate(r,{month:"short",year:"numeric"})}function fs(e,t,s){const r=oe(t,s);return e.formatDate(r,{month:"short",day:"numeric"})}function sl(e,t,s){const r=oe(t,s);return e.formatDate(r,{weekday:"short",month:"short",day:"numeric"})}function hs(e,t,s){const r=oe(t,s);return e.formatDate(r,{year:"numeric"})}ra.register(aa,ia,la,ca,da,ua,fa,ha,ma,Zi,pa);const nl=100,ms={color:"#b4b4b4",font:{size:10,weight:"600",family:"Menlo"}};function ol({isUp:e,histories:t,selectedInterval:s,setHighlightedPrice:r,latestTradingPeriod:o,timezone:a}){return n.jsx(n.Fragment,{children:t&&s&&o?n.jsx(rl,{isUp:e,histories:t,selectedInterval:s,latestTradingPeriod:o,timezone:a,setHighlightedPrice:r}):n.jsx(Ce,{className:"h-full",index:1,width:100})})}function rl({isUp:e,histories:t,selectedInterval:s,latestTradingPeriod:r,timezone:o,setHighlightedPrice:a}){const[l,c]=m.useState(null),[i,u]=m.useState(!1),p=s==="1d",f=m.useMemo(()=>{let g=t.quotes[s].filter(w=>w.close>=0);if(p&&r){const w=r.regular.start_timestamp,d=r.regular.end_timestamp;if(g=g.filter(S=>S.timestamp>=w&&S.timestamp<=d),g.length===0||g[g.length-1].timestamp<d){let T=g.length>0?g[g.length-1].timestamp:w-600;for(;T<d;)T+=600,g.push({timestamp:T,close:null})}}return g},[t,s,p,r]),x=an[s],{formatTimestampTooltip:b,maxTicksLimit:y,useUtc:h=!1}=x,_=M(),j=zs(),N=Ke(),v=m.useMemo(()=>{const{formatTimestampLabel:g,lineTension:w}=x;return{labels:f.map(d=>g(_,d.timestamp,h?"UTC":o)),datasets:[{data:f.map(d=>d.close),borderColor:e?ze():We(),pointRadius:0,pointHoverRadius:4,pointStyle:"circle",pointBackgroundColor:e?ze():We(),pointHoverBorderWidth:2,pointHoverBorderColor:"rgba(255, 255, 255, 1)",backgroundColor:function(d){const{ctx:S,chartArea:T}=d.chart;if(T)return il(S,T,e)},fill:!0,borderWidth:2,lineTension:w??.4}]}},[x,f,e,h,o,_]);return n.jsx("div",{className:"flex h-full flex-col gap-6",children:n.jsxs("div",{className:"relative h-full",onMouseEnter:()=>u(!0),onMouseLeave:()=>{u(!1),a(null)},children:[n.jsx(xa,{options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},hover:{mode:i?"index":"point"},animation:!1,scales:{x:{afterBuildTicks:g=>{if(g.ticks.length>y)if(p)g.ticks=g.ticks.filter((w,d)=>f[d].timestamp%(j?3600:7200)===0);else{const w=Math.ceil(g.ticks.length/(y-1));g.ticks=g.ticks.filter((d,S)=>S>0&&(S%w===0||S===g.ticks.length-1))}},grid:{display:!1},ticks:{...ms,align:"end"}},y:{ticks:{...ms,maxTicksLimit:7},border:{display:!1},grid:{color:N?"rgba(255, 255, 255, 0.1)":"rgba(229, 229, 229, 0.5)"}}},plugins:{datalabels:{display:!1},legend:{display:!1},tooltip:{enabled:!1,animation:!1,displayColors:!1,callbacks:{title:function(g){const w=g[0];if(!w)return"";const d=f[w.dataIndex]?.timestamp;return d?b(_,d,h?"UTC":o):""}},external:({tooltip:g})=>{i&&g.opacity>0&&a(Se(g.dataPoints?.[0]?.parsed?.y??0)),c(w=>{const d=g.chart.width,S=g.caretX>d-nl;return!w||w.x!==g.caretX||w.y!==g.caretY||w.opacity!==g.opacity||w.flip!==S?{...w,x:g.caretX,y:g.caretY,dateLabel:g.title?.[0],value:Se(g.dataPoints?.[0]?.parsed?.y??0),opacity:g.opacity,flip:S}:w})}},dropShadow:!1,crosshair:{line:{color:N?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.3)",width:.5},zoom:{enabled:!1}}}},data:v}),n.jsx(al,{tooltipData:l})]})})}function al({tooltipData:e}){return!e||!e.opacity?null:n.jsx("div",{style:{left:e.x-5,top:10,transform:"translate(-50%, -50%)"},className:k("text-token-main-surface-primary dark:bg-token-main-surface-secondary pointer-events-none absolute translate-y-[-100%] rounded-lg bg-black px-2 py-1 font-mono font-semibold whitespace-nowrap dark:text-white"),children:n.jsx("div",{className:"text-xs",children:e.dateLabel})})}function il(e,t,s){const r=e.createLinearGradient(0,t.top,0,t.bottom);return r.addColorStop(0,s?ze(.4):We(.4)),r.addColorStop(1,s?ze(0):We(0)),r}function Se(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function W({label:e,value:t,className:s}){return n.jsxs("div",{className:k("flex w-full flex-1 flex-row justify-between text-sm",s),children:[n.jsx("span",{className:"text-token-text-secondary font-normal whitespace-nowrap",children:e}),n.jsx("span",{className:"text-token-text-primary font-normal whitespace-nowrap",children:t})]})}function ll({metrics:e}){const t=M(),s=!!(e.marketCap&&e.peRatio&&e.eps);return n.jsx("div",{className:"border-token-border-default flex flex-col gap-1 rounded-b-lg border-t bg-[#f4f4f4] px-4 py-3 dark:bg-[#393939]",children:n.jsxs("div",{className:k("grid grid-cols-2 gap-x-10 gap-y-3 lg:grid-cols-3 lg:gap-x-6"),children:[n.jsx(W,{label:t.formatMessage({id:"MDHEj7",defaultMessage:"Open"}),value:t.formatNumber(e.openPrice,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-1"}),n.jsx(W,{label:t.formatMessage({id:"PboNMC",defaultMessage:"Volume"}),value:t.formatNumber(e.intradayVolume,{notation:"compact",maximumFractionDigits:1}),className:k("order-2",!s&&"lg:order-last")}),n.jsxs("div",{className:"order-4 row-span-2 flex flex-col gap-3",children:[n.jsx(W,{label:t.formatMessage({id:"bresUW",defaultMessage:"Day Low"}),value:t.formatNumber(e.intradayLow,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),n.jsx(W,{label:t.formatMessage({id:"oWyv5V",defaultMessage:"Day High"}),value:t.formatNumber(e.intradayHigh,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]}),n.jsxs("div",{className:"order-5 row-span-2 flex flex-col gap-3",children:[n.jsx(W,{label:t.formatMessage({id:"DcEYIK",defaultMessage:"Year Low"}),value:t.formatNumber(e.fiftyTwoWeekLow,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})}),n.jsx(W,{label:t.formatMessage({id:"ZfFtJ4",defaultMessage:"Year High"}),value:t.formatNumber(e.fiftyTwoWeekHigh,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.marketCap&&n.jsx(W,{label:t.formatMessage({id:"BzyP4Y",defaultMessage:"Market Cap"}),value:t.formatNumber(e.marketCap,{notation:"compact",maximumFractionDigits:2}),className:"order-last lg:order-3"}),e.peRatio&&e.eps&&n.jsxs(n.Fragment,{children:[n.jsx(W,{label:t.formatMessage({id:"edGd+S",defaultMessage:"EPS (TTM)"}),value:t.formatNumber(e.eps,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-last"}),n.jsx(W,{label:t.formatMessage({id:"AhpCu1",defaultMessage:"P/E Ratio"}),value:t.formatNumber(e.peRatio,{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),className:"order-last"})]})]})})}function cl({data:e,priceChange:t,highlightedPrice:s,extendedPriceChange:r,url:o}){function a(l,c="intraday",i=null){const{isUp:u,changePercentage:p,changeLabel:f,changeAmount:x}=l,b=Math.abs(p).toFixed(2),y=Se(x);return n.jsxs("span",{className:"flex min-w-0 items-center gap-1",children:[c==="extended_hours"&&i!=null&&n.jsx("span",{className:"font-semibold",children:n.jsx($,{id:"HWwWpW",defaultMessage:"{price}",values:{price:i}})}),n.jsx("span",{className:k("font-semibold",u?cs:ds),children:n.jsx($,{id:"3x4Lkl",defaultMessage:"{sign}{changeAmount}",values:{changeAmount:y,sign:u?"+":""}})}),n.jsx("span",{className:k("font-semibold",u?cs:ds),children:n.jsx($,{id:"MbfF1T",defaultMessage:"({sign}{changePercentage}%)",values:{changePercentage:b,sign:u?"+":"-"}})}),c==="extended_hours"?n.jsx("span",{className:"text-token-text-primary min-w-0 truncate",children:f}):n.jsx("span",{className:"text-token-text-primary min-w-0 truncate",children:f})]})}return n.jsxs("div",{children:[n.jsx("div",{className:"mt-2 text-sm",children:e?n.jsx($,{id:"+2WHuv",defaultMessage:"{name} ({ticker})",values:{name:e.asset.name,ticker:e.asset.ticker}}):n.jsx("div",{className:"w-32 font-medium",children:n.jsx(Ce,{index:9,width:100})})}),n.jsx("div",{className:"text-token-text-tertiary text-sm",children:e?n.jsx(n.Fragment,{children:o!=null&&n.jsxs(n.Fragment,{children:[" · ",n.jsx(Y,{href:o,className:"text-token-link hover:underline",children:Ge(o,"hostname")})]})}):n.jsx("div",{className:"mt-2 w-36",children:n.jsx(Ce,{index:6,width:100})})}),n.jsx("div",{className:"mt-2 flex text-4xl font-semibold",children:e?n.jsx($,{id:"s+1uly",defaultMessage:"{price}",values:{price:s??Se(e.price.price)}}):n.jsx("div",{className:"w-32",children:n.jsx(Ce,{index:0,width:100})})}),n.jsx("div",{className:"mt-2 flex items-center justify-start gap-1 text-sm",children:t?a(t):n.jsx("div",{className:"mt-2 w-40",children:n.jsx(Ce,{index:3,width:100})})}),n.jsx("div",{className:"mt-0.5 flex items-center justify-start gap-1 text-sm",children:e?.price?.extended_price!=null&&r!=null&&a(r,"extended_hours",Se(e.price.extended_price))})]})}function dl({contentReference:e,trackContentReferenceEvent:t}){const s=M();m.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown","stock")},[t]);const r=el(e?.stock?.histories),o=e?.stock,[a,l]=m.useState(r),[c,i]=m.useState(null),u=a==="1d",p=o?.histories?.quotes?.[a??""]?.[0],f=a&&a in De?a:void 0,x=o&&(p&&!u?{changePercentage:(o.price.price-p.close)/p.close*100,changeAmount:o.price.price-p.close,changeLabel:f?s.formatMessage(De[f]):"",isUp:o.price.price>p.close}:o.price.change_percent&&o.price.change?{changePercentage:o.price.change_percent*100,changeAmount:o.price.change,changeLabel:fl(o.price.latest_trade_timestamp,o.asset.timezone,s),isUp:o.price.change?o.price.change>0:!1}:null),b=o&&o.price.extended_price!=null&&o.price.extended_change_percent!=null&&o.price.extended_change!=null?{changePercentage:o.price.extended_change_percent*100,changeAmount:o.price.extended_change,changeLabel:s.formatMessage(ul(o.price.market_status)??De.extended),isUp:o.price.extended_change>0}:null,{fiftyTwoWeekHigh:y,fiftyTwoWeekLow:h}=m.useMemo(()=>{const N=o?.histories?.quotes["1y"];if(!N)return{fiftyTwoWeekHigh:null,fiftyTwoWeekLow:null};const v=N.map(w=>w.high).filter(w=>w!=null),g=N.map(w=>w.low).filter(w=>w!=null);return{fiftyTwoWeekHigh:v.length>0?Math.max(...v):null,fiftyTwoWeekLow:g.length>0?Math.min(...g):null}},[o?.histories?.quotes]),_=o?.price.open_price&&o.price.intraday_high&&o.price.intraday_low&&o.price.intraday_volume&&y&&h?{openPrice:o.price.open_price,intradayHigh:o.price.intraday_high,intradayLow:o.price.intraday_low,intradayVolume:o.price.intraday_volume,fiftyTwoWeekHigh:y,fiftyTwoWeekLow:h,marketCap:o.metrics?.market_cap??void 0,peRatio:o.metrics?.pe_ratio??void 0,eps:o.metrics?.eps??void 0}:null,j=_!=null;return n.jsxs("div",{"data-testid":"finance-widget",className:k("border-token-border-default mb-2 flex min-h-[480px] flex-col gap-8 rounded-lg border"),children:[n.jsxs("div",{className:"mx-6 flex flex-wrap items-end justify-between",children:[n.jsx(cl,{data:o??null,highlightedPrice:c,priceChange:x??null,extendedPriceChange:b??null,url:e?.url??null}),n.jsx("div",{className:"mt-4",children:n.jsx(Qi,{selectedInterval:a,onSelectHistoryInterval:l,histories:o?.histories})})]}),n.jsx("div",{className:"mx-6 h-[340px]",children:n.jsx(ol,{isUp:x?.isUp??!1,selectedInterval:a,histories:o?.histories,setHighlightedPrice:i,onSelectHistoryInterval:N=>l(N),latestTradingPeriod:o?.asset.latest_trading_period,timezone:o?.asset.timezone??null})}),j&&n.jsx("div",{className:"-mt-4",children:n.jsx(ll,{metrics:_})})]})}function ul(e){if(e==null)return null;const t=e.toLowerCase();return t==="premarket"||t==="open"?ot({id:"By+pvF",defaultMessage:"Pre-Market"}):t==="afterhours"||t==="closed"?ot({id:"aLCg3c",defaultMessage:"After Hours"}):ot({id:"2p526c",defaultMessage:"Extended Hours"})}function fl(e,t,s){function r(o,a){const c=Ne(new Date,a),i=s.formatDate(c,{year:"numeric",month:"2-digit",day:"2-digit"}),u=Rt(o*1e3),p=Ne(u,a),f=s.formatDate(p,{year:"numeric",month:"2-digit",day:"2-digit"});return i===f}if(!e||!t||r(e,t))return s.formatMessage(De["1d"]);{const o=Rt(e*1e3),a=Ne(o,t);return s.formatDate(a,{month:"long",day:"numeric"})}}const De=xt({"1d":{id:"SMdcuo",defaultMessage:"Today"},extended:{id:"2p526c",defaultMessage:"Extended Hours"},"5d":{id:"HCA6lr",defaultMessage:"Past 5 days"},"1m":{id:"DJpPMq",defaultMessage:"Past month"},"6m":{id:"1mUJ2L",defaultMessage:"Past 6 months"},ytd:{id:"b9KkhV",defaultMessage:"Year to date"},"1y":{id:"XnvD9A",defaultMessage:"Past year"},"5y":{id:"DfI1RB",defaultMessage:"Past 5 years"},max:{id:"WzOhuU",defaultMessage:"Max"}}),hl={google_maps:{title:"Google Maps"}};function ml({metadata:e,trackContentReferenceEvent:t}){m.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",e.type)},[t,e.type]);const s=hl[e.provider]?.title??"Maps";return n.jsx("span",{children:n.jsx($,{id:"ZSUz1k",defaultMessage:" ({link}) ",values:{link:n.jsx(Y,{href:e.url,children:s})}})})}const pl=30;function xl(e){"use forget";const t=pt.c(19),{metadata:s,trackContentReferenceEvent:r}=e,o=s.items.length>0,a=m.useRef(r);let l,c;t[0]!==r?(l=()=>{a.current=r},c=[r],t[0]=r,t[1]=l,t[2]=c):(l=t[1],c=t[2]),m.useEffect(l,c);let i,u;t[3]!==o?(i=()=>{o&&a.current("Search Content Reference Shown","search_content_reference_shown","nav_list")},u=[o],t[3]=o,t[4]=i,t[5]=u):(i=t[4],u=t[5]),m.useEffect(i,u);let p;t[6]!==r?(p=(j,N)=>{r("link_action",null,"nav_list",{...ps(j,N),action:"click"})},t[6]=r,t[7]=p):p=t[7];const f=p;let x;t[8]!==r?(x=(j,N)=>{r("link_action",null,"nav_list",{...ps(j,N),action:"show"})},t[8]=r,t[9]=x):x=t[9];const b=x;if(s.items.length===0)return null;let y;t[10]!==s.title?(y=s.title&&n.jsx("div",{className:"text-token-text-primary -mb-1 pb-3 font-semibold",children:s.title}),t[10]=s.title,t[11]=y):y=t[11];let h;t[12]!==f||t[13]!==b||t[14]!==s.items?(h=n.jsx(nn,{items:s.items,onCardRender:gl,onCardShown:b,onCardClicked:f,cardClassName:"transition-all duration-200 border-token-border-default hover:border-light border rounded-xl bg-clip-padding hover:shadow-md overflow-hidden"}),t[12]=f,t[13]=b,t[14]=s.items,t[15]=h):h=t[15];let _;return t[16]!==y||t[17]!==h?(_=n.jsxs("div",{className:"mt-6 mb-1","data-testid":"nav-list-widget",children:[y,h]}),t[16]=y,t[17]=h,t[18]=_):_=t[18],_}function gl(e){return n.jsx(yl,{item:e})}function bl(e,t){if(t==null)return null;const s=new Date(t*1e3),r=e.locale,o=Math.max(Math.floor((Date.now()-s.getTime())/(1e3*60*60*24)),0);if(o>pl)return e.formatDate(s,{dateStyle:"medium"});const a=e.formatRelativeTime(-o,"day",{numeric:"auto"});return r.startsWith("en")?a.charAt(0).toUpperCase()+a.slice(1):a}function yl({item:e}){const{isSuccess:t}=ht(e.thumbnail_url??void 0),s=M(),r=bl(s,e.pub_date);return n.jsxs(Y,{className:"flex flex-col items-center gap-4 overflow-hidden pb-6",href:e.url,children:[t&&e.thumbnail_url?n.jsx("div",{className:"relative h-36 w-full overflow-hidden",children:n.jsx("img",{src:e.thumbnail_url,className:"m-0 h-full w-full",style:{objectFit:"cover"},alt:e.title})}):n.jsxs("div",{className:"icon-bg relative flex h-36 w-full shrink-0 items-center justify-center overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-cover bg-center bg-no-repeat blur-3xl",children:n.jsx(je,{url:e.url,size:256,minSize:128,className:"mix-soft-light opacity-30 dark:opacity-20"})}),n.jsx("div",{className:"absolute flex h-10 w-10 items-center justify-center",children:n.jsx(je,{url:e.url,size:128,minSize:80,className:"icon-xl rounded-full"})})]}),n.jsxs("div",{className:"flex flex-col gap-2 overflow-hidden px-4 text-ellipsis",children:[n.jsxs("div",{className:"text-token-text-primary flex items-center gap-1.5 text-xs",children:[n.jsx(je,{url:e.url,size:32,minSize:16,className:"icon-xs my-0 rounded-full"}),e.attribution??Ge(e.url)]}),n.jsx("div",{className:"text-token-text-primary decoration-token-link line-clamp-5 text-sm font-medium",children:e.title}),r&&n.jsx("div",{className:"text-token-text-secondary text-xs",children:r})]})]})}const ps=(e,t)=>({url:e.url,title:e.title,section_index:t,link_type:"text",section:"nav_list",section_location:"response"}),vl="/assets/missing-logo-h96s4tk9.webp",xs={src:vl};function ln({team:e,className:t}){const[s,r]=m.useState(e.logo??xs.src),o=()=>{Ye.addError("Unable to load sports widget logo",{name:e.name,logo:e.logo}),r(xs.src)};return n.jsx("img",{src:s,alt:e.name,className:t,onError:o})}const $e=["ipl"],gs=6,te="home",se="away";function wl({scheduleRef:e,trackContentReferenceEvent:t}){const[s,r]=m.useState(!0),o=M(),a=e.games.length>0,l=e.league.id,c=pr(),i=Me();if(m.useEffect(()=>{a&&t("Search Content Reference Shown","search_content_reference_shown","sports",{hasSchedule:!0})},[a]),!a)return null;const p=(o.formatDateToParts(new Date,{timeZoneName:"long"}).find(y=>y.type==="timeZoneName")?.value??Intl.DateTimeFormat().resolvedOptions().timeZone).replace(/Daylight|Standard/g,"");let f=e.games;const x=y=>Math.abs(new Date().getTime()-new Date(y.date).getTime());x(f[0])>x(f[f.length-1])&&(f=f.slice().reverse());const b=s?f.slice(0,gs):f;return n.jsxs("div",{className:"not-prose mb-3","data-testid":"sports-schedule-widget",children:[n.jsx("div",{className:"font-semibold",children:n.jsx($,{id:"LA6z9q",defaultMessage:"{league} Schedule",values:{league:e.league.display_name}})}),n.jsx("div",{className:"text-token-text-secondary text-sm",children:p}),b.length===1?n.jsx("div",{children:n.jsx(Mt,{children:n.jsx(ut.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},exit:{opacity:0,y:-15},transition:{duration:.2},children:n.jsx("div",{className:"border-token-border-medium mt-3 rounded-xl border py-3",children:n.jsx(kl,{game:b[0],useAlias:$e.includes(l),leagueId:l,activeTeam:b[0]?.active_team??null,isMobile:i})})})})}):n.jsx("div",{className:"grid grid-cols-1 pt-3 lg:grid-cols-2",children:n.jsx(Mt,{children:b.map((y,h)=>n.jsx(ut.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0,transition:{delay:h*.04}},exit:{opacity:0,y:-15},transition:{duration:.2},children:n.jsx("div",{className:k("border-token-border-medium border-b py-3",h%2===0&&"lg:border-e lg:pe-4",h%2===1&&"lg:ps-4",Math.floor(h/2)===Math.ceil(f.length/2)-1&&"lg:border-b-0",h===f.length-1&&"border-b-0"),children:n.jsx(_l,{game:y,useAlias:(c||i)&&$e.includes(l),leagueId:l,activeTeam:y.active_team??null})})},h))})}),f.length>gs&&n.jsx("div",{className:"mt-2 flex items-center justify-between",children:n.jsx("button",{className:"flex items-center text-sm font-semibold",onClick:()=>r(!s),children:s?n.jsx($,{id:"BH/Ee5",defaultMessage:"Show more {icon}",values:{icon:n.jsx(bo,{className:"mb-[-2px]"})}}):n.jsx($,{id:"Z9BlEu",defaultMessage:"Show less {icon}",values:{icon:n.jsx(yo,{className:"mb-[-2px]"})}})})})]})}function _l({game:e,useAlias:t=!1,leagueId:s,activeTeam:r}){const o=dn(e),a=[e.first_team_info,e.second_team_info],l=a.find(p=>p.location===te)??e.first_team_info,c=a.find(p=>p.location===se)??e.second_team_info,i=o?.team.name===l?.team.name,u=o?.team.name===c?.team.name;return n.jsxs("div",{className:"flex w-full gap-1.5 py-3 text-base",children:[n.jsxs("div",{className:"flex flex-auto flex-col items-start gap-1 pe-3",children:[n.jsx(Ue,{team:c.team,isWinner:u,isActive:r===se,logoSize:"small",useAlias:t}),n.jsx(Ue,{team:l.team,isWinner:i,isActive:r===te,logoSize:"small",useAlias:t})]}),n.jsxs("div",{className:k("flex flex-none flex-col items-start gap-1",$e.includes(s)&&"me-4"),children:[n.jsx(Je,{score:c.score,scoreSuffix:c.score_suffix,scoreParenthetical:c.score_parenthetical?{message:c.score_parenthetical,position:"right"}:null,isWinner:u,negateScore:He(s,se,r)}),n.jsx(Je,{score:l.score,scoreSuffix:l.score_suffix,scoreParenthetical:l.score_parenthetical?{message:l.score_parenthetical,position:"right"}:null,isWinner:i,negateScore:He(s,te,r)})]}),n.jsx("div",{className:"flex min-w-24 flex-none flex-col items-end justify-center gap-1 text-sm",children:n.jsx(un,{game:e})})]})}function kl({game:e,useAlias:t=!1,leagueId:s,activeTeam:r,isMobile:o}){const a=dn(e),l=[e.first_team_info,e.second_team_info],c=l.find(f=>f.location===te)??e.first_team_info,i=l.find(f=>f.location===se)??e.second_team_info,u=a?.team.name===c?.team.name,p=a?.team.name===i?.team.name;return n.jsxs("div",{className:"flex w-full py-3 text-base",children:[n.jsx("div",{className:"flex flex-1 items-center justify-center px-2",children:n.jsx(Ue,{team:i.team,isWinner:p,isActive:r===se,useAlias:t,layoutDirection:o?"column":"row"})}),n.jsx("div",{className:"ms-2 flex items-center justify-start sm:ms-8",children:n.jsx(Je,{score:i.score,scoreSuffix:i.score_suffix,scoreParenthetical:i.score_parenthetical?{message:i.score_parenthetical,position:"bottom"}:null,isWinner:p,negateScore:He(s,se,r),className:"text-sm font-semibold sm:text-lg"})}),n.jsx("div",{className:"mx-2 flex w-24 shrink flex-col items-center justify-center gap-1 align-middle text-sm",children:n.jsx(un,{game:e})}),n.jsx("div",{className:"me-2 flex items-center justify-end sm:me-8",children:n.jsx(Je,{score:c.score,scoreSuffix:c.score_suffix,scoreParenthetical:c.score_parenthetical?{message:c.score_parenthetical,position:"bottom"}:null,isWinner:u,negateScore:He(s,te,r),className:"text-sm font-semibold sm:text-lg"})}),n.jsx("div",{className:"flex flex-1 items-center justify-center md:px-2",children:n.jsx(Ue,{team:c.team,isWinner:u,isActive:r===te,useAlias:t,layoutDirection:o?"column":"row"})})]})}function cn(e){return e.live?"live":new Date(e.date)<new Date?"complete":"scheduled"}function dn(e){return cn(e)!=="complete"||e.first_team_info.score==null||e.second_team_info.score==null?null:e.first_team_info.score>e.second_team_info.score?e.first_team_info:e.second_team_info}function He(e,t,s){return $e.includes(e)&&t===te&&s===se}function Ue({team:e,isWinner:t,isActive:s,logoSize:r,useAlias:o=!1,layoutDirection:a="row"}){return n.jsxs("span",{className:k("flex items-center gap-1",t&&"font-semibold","max-w-64 lg:max-w-52 xl:max-w-64",a==="column"&&"flex-col"),children:[e.logo&&n.jsx(ln,{team:{name:e.name,logo:e.logo},className:k(r==="small"?"w-6":"w-8")}),n.jsx("span",{className:"truncate",children:o?e.alias:e.name}),s&&n.jsx("span",{className:"bg-token-surface-error inline-block h-2 w-2 rounded-full"})]})}function Je({score:e,scoreSuffix:t,scoreParenthetical:s,isWinner:r,negateScore:o=!1,className:a}){const l=M();return e==null?null:n.jsxs("span",{className:k(r&&"font-semibold",a),children:[o?l.formatMessage({id:"sports.dash",defaultMessage:"-"}):e,t&&!o&&n.jsx("span",{children:t}),s&&!o&&n.jsx("span",{className:k("text-token-text-secondary font-normal",s.position==="right"&&"ms-1",s.position==="bottom"&&"mx-auto block text-center"),children:`(${s.message})`})]})}function un({game:e}){const t=M();switch(cn(e)){case"live":return n.jsxs(n.Fragment,{children:[n.jsx(Cl,{}),n.jsx("div",{children:e.details})]});case"complete":return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"font-semibold",children:n.jsx($,{id:"q/iMZL",defaultMessage:"Final"})}),n.jsx("div",{className:"text-token-text-secondary",children:mt(t,new Date(e.date))})]});case"scheduled":{const s=new Date(e.date);return isNaN(s.getTime())?null:n.jsxs(n.Fragment,{children:[n.jsx("div",{children:mt(t,s)}),n.jsx("div",{className:"text-token-text-secondary",children:t.formatDate(s,{timeStyle:"short"})})]})}}}function Cl(){return n.jsx("div",{className:"bg-token-surface-error rounded-[4px] px-1.5 py-1 text-xs font-semibold text-white",children:n.jsx($,{id:"vObALn",defaultMessage:"Live"})})}function jl({standingsRef:e,trackContentReferenceEvent:t}){const[s,r]=m.useState(0),o=e.conferences.length>0,a=Me(),l=e.league.id;m.useEffect(()=>{o&&t("Search Content Reference Shown","search_content_reference_shown","sports",{hasStandings:!0})},[o]);const c=e.conferences[s],i=e.conferences.length>1?e.conferences.map((u,p)=>n.jsx("button",{className:k(s===p?"text-token-text-primary":"text-token-text-tertiary","text-sm font-semibold"),onClick:()=>r(p),children:u.name},u.name)):null;return n.jsxs("div",{"data-testid":"sports-standings-widget",children:[i&&n.jsx("div",{className:"flex gap-4",children:i}),n.jsx("div",{className:"mt-3",children:c.divisions.map(u=>u.name?n.jsx("div",{className:"mt-3",children:n.jsx(bs,{division:u,teamsColumnHeader:u.name})},u.name):n.jsx(bs,{division:u,useAlias:a&&$e.includes(l)}))})]})}function bs({division:e,teamsColumnHeader:t,useAlias:s}){const r=e.headers.map(o=>o.key);return n.jsxs(R.Root,{size:"compact",className:"not-prose",children:[n.jsxs(R.Header,{children:[n.jsx(Nl,{children:t??n.jsx($,{id:"kKSGje",defaultMessage:"Team"})}),e.headers.map(o=>n.jsx(fn,{textAlign:"center",className:"min-w-11 px-0!",children:n.jsx(ys,{data:o})},o.key))]}),n.jsx(R.Body,{children:e.teams.map(({team:o,data:a},l)=>{const c=a.reduce((i,u)=>(i[u.key]=u,i),{});return n.jsxs(R.Row,{children:[n.jsx(R.Cell,{className:"w-full border-0! py-0! ps-0!",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"text-token-text-tertiary me-2 w-4 whitespace-nowrap tabular-nums",children:l+1}),n.jsxs("div",{className:"flex items-center justify-start gap-2",children:[n.jsx(ln,{team:o,className:"w-6"}),n.jsx("span",{className:"text-base whitespace-nowrap",children:s?o.alias:o.name})]})]})}),r.map(i=>n.jsx(R.Cell,{className:"min-w-11 border-0! px-0! py-0! text-start whitespace-nowrap tabular-nums",textAlign:"center",children:n.jsx(ys,{data:c[i]})},i))]},o.name)})})]})}function ys({data:e}){switch(e.type){case"text":return n.jsx(n.Fragment,{children:e.text});default:return n.jsx(n.Fragment,{children:e.alt})}}const fn=Ws(R.HeaderCell)`text-token-text-secondary font-normal! text-sm static! bg-transparent! border-token-border-default! border-t-0! border-s-0! border-e-0!`,Nl=Ws(fn)`text-token-text-primary ps-0!`;function Sl({metadata:e,trackContentReferenceEvent:t}){m.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",e.type)},[t,e.type]);const s=M(),r=Ne(e.utc_time,e.utc_offset),o=s.formatDate(r,{hour:"numeric",minute:"numeric"});return n.jsx("span",{children:o})}function $l({metadata:e,trackContentReferenceEvent:t}){return m.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",e.type)},[t,e.type]),n.jsx("div",{children:e.url?n.jsx(vo,{webpageItem:{url:e.url,title:e.description,pub_date:null,snippet:"",attributions:null},className:"inline-flex flex-col",children:n.jsx(Y,{href:e.url,className:"font-semibold!",children:e.description})}):n.jsx("div",{className:"font-semibold!",children:e.description})})}function Tl({videoId:e,title:t="YouTube video player",fallbackText:s,cookieLess:r=!0,timeoutMs:o=5e3,className:a=""}){const l=m.useRef(null),c=m.useRef(null),i=m.useRef(!1),[u,p]=m.useState("idle"),f=()=>{i.current=!0,c.current&&(clearTimeout(c.current),c.current=null)};if(m.useEffect(()=>{p("loading"),i.current=!1;let b=null;return Pl().then(()=>{if(!l.current)return;l.current.textContent="",b=document.createElement("div"),b.style.width="200px",b.style.height="150px",l.current.appendChild(b),c.current=window.setTimeout(()=>{i.current||p("timeout")},o);const y=r?"https://www.youtube-nocookie.com":"https://www.youtube.com";new window.YT.Player(b,{width:200,height:150,videoId:e,host:y,playerVars:{rel:0,playsinline:1,origin:window.location.origin},events:{onReady:()=>{f(),p("ready")},onError:()=>{f(),p("error")}}})}).catch(()=>p("error")),()=>{f()}},[e,r,o]),u==="error"||u==="timeout")return n.jsx("a",{href:`https://www.youtube.com/watch?v=${e}`,target:"_blank",rel:"noopener noreferrer",children:s});const x=r?"https://www.youtube-nocookie.com":"https://www.youtube.com";return n.jsxs(n.Fragment,{children:[n.jsx("div",{ref:l,"aria-hidden":!0,inert:!0,className:"hidden"}),n.jsx("iframe",{src:`${x}/embed/${e}`,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0,className:a,title:t})]})}function Pl(){return new Promise(e=>{if(window.YT?.Player)return e();const t=window.onYouTubeIframeAPIReady;if(window.onYouTubeIframeAPIReady=()=>{t?.(),e(),window.onYouTubeIframeAPIReady=t||(()=>{})},!document.querySelector("script[src*='youtube.com/iframe_api']")){const s=document.createElement("script");s.src="https://www.youtube.com/iframe_api",document.head.appendChild(s)}})}function Ml({url:e,className:t,iframeClassName:s,iframeTitle:r}){const o=X(),a=L(o,"1256582879");let l;const c=k("aspect-video w-full",s),i=Al(e);i&&(l=a?n.jsx(Tl,{className:c,videoId:i,title:r,fallbackText:r??n.jsx($,{id:"sonic.video.youtube.title",defaultMessage:"YouTube video link"}),cookieLess:!1}):n.jsx(Il,{videoId:i,className:c,iframeTitle:r}));const u=El(e);return u&&(l=n.jsx(Fl,{videoId:u,className:c,iframeTitle:r})),l?n.jsx("div",{className:t,children:l}):null}function Al(e){const t=/^(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,s=e.match(t);return s?s[1]:null}function Il({videoId:e,className:t,iframeTitle:s}){return n.jsx("iframe",{className:t,src:`https://www.youtube.com/embed/${e}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerPolicy:"strict-origin-when-cross-origin",allowFullScreen:!0,title:s})}function El(e){const t=/vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/[^/]+\/videos\/|video\/|)(\d+)/,s=e.match(t);return s?s[1]:null}function Fl({videoId:e,className:t,iframeTitle:s}){return n.jsx(n.Fragment,{children:n.jsx("iframe",{className:t,src:`https://player.vimeo.com/video/${e}`,frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:s})})}function Rl({video:e,trackContentReferenceEvent:t}){const s={url:e.url,title:e.title};return m.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",e.type,s)},[]),e.url==null||e.url===""?null:n.jsx("div",{className:"not-prose mb-3 flex flex-col gap-4 text-base","data-testid":"video-widget",children:n.jsx(Ml,{url:e.url,iframeClassName:"rounded-lg"})})}const Ll="webp",Dl=96,Ol=96,Bl="srgb",zl=4,Wl="uchar",Hl=288,Ul=!1,Jl=!1,Xl=!0,Gl="/assets/cloud-foggy-o4a3hmky.webp",Vl={format:Ll,width:Dl,height:Ol,space:Bl,channels:zl,depth:Wl,density:Hl,isProgressive:Ul,hasProfile:Jl,hasAlpha:Xl,src:Gl},ql="webp",Yl=96,Zl=96,Kl="srgb",Ql=4,ec="uchar",tc=288,sc=!1,nc=!1,oc=!0,rc="/assets/cloudy-co8vwrk7.webp",ac={format:ql,width:Yl,height:Zl,space:Kl,channels:Ql,depth:ec,density:tc,isProgressive:sc,hasProfile:nc,hasAlpha:oc,src:rc},ic="webp",lc=96,cc=96,dc="srgb",uc=4,fc="uchar",hc=288,mc=!1,pc=!1,xc=!0,gc="/assets/heavy-snow-mke52kag.webp",bc={format:ic,width:lc,height:cc,space:dc,channels:uc,depth:fc,density:hc,isProgressive:mc,hasProfile:pc,hasAlpha:xc,src:gc},yc="webp",vc=96,wc=96,_c="srgb",kc=4,Cc="uchar",jc=288,Nc=!1,Sc=!1,$c=!0,Tc="/assets/light-snow-mcy1l7t9.webp",Pc={format:yc,width:vc,height:wc,space:_c,channels:kc,depth:Cc,density:jc,isProgressive:Nc,hasProfile:Sc,hasAlpha:$c,src:Tc},Mc="webp",Ac=96,Ic=96,Ec="srgb",Fc=4,Rc="uchar",Lc=288,Dc=!1,Oc=!1,Bc=!0,zc="/assets/moon-drizzle-cplxr2ub.webp",Wc={format:Mc,width:Ac,height:Ic,space:Ec,channels:Fc,depth:Rc,density:Lc,isProgressive:Dc,hasProfile:Oc,hasAlpha:Bc,src:zc},Hc="webp",Uc=96,Jc=96,Xc="srgb",Gc=4,Vc="uchar",qc=288,Yc=!1,Zc=!1,Kc=!0,Qc="/assets/moon-hazy-jvgt25bp.webp",ed={format:Hc,width:Uc,height:Jc,space:Xc,channels:Gc,depth:Vc,density:qc,isProgressive:Yc,hasProfile:Zc,hasAlpha:Kc,src:Qc},td="webp",sd=96,nd=96,od="srgb",rd=4,ad="uchar",id=288,ld=!1,cd=!1,dd=!0,ud="/assets/moon-mostly-cloudy-cia3do0v.webp",fd={format:td,width:sd,height:nd,space:od,channels:rd,depth:ad,density:id,isProgressive:ld,hasProfile:cd,hasAlpha:dd,src:ud},hd="webp",md=96,pd=96,xd="srgb",gd=4,bd="uchar",yd=288,vd=!1,wd=!1,_d=!0,kd="/assets/moon-mostly-sunny-n3mh1b6a.webp",Cd={format:hd,width:md,height:pd,space:xd,channels:gd,depth:bd,density:yd,isProgressive:vd,hasProfile:wd,hasAlpha:_d,src:kd},jd="webp",Nd=96,Sd=96,$d="srgb",Td=4,Pd="uchar",Md=288,Ad=!1,Id=!1,Ed=!0,Fd="/assets/moon-shower-ntzhti9o.webp",Rd={format:jd,width:Nd,height:Sd,space:$d,channels:Td,depth:Pd,density:Md,isProgressive:Ad,hasProfile:Id,hasAlpha:Ed,src:Fd},Ld="webp",Dd=96,Od=96,Bd="srgb",zd=4,Wd="uchar",Hd=288,Ud=!1,Jd=!1,Xd=!0,Gd="/assets/moon-sunny-eg2emh4d.webp",Vd={format:Ld,width:Dd,height:Od,space:Bd,channels:zd,depth:Wd,density:Hd,isProgressive:Ud,hasProfile:Jd,hasAlpha:Xd,src:Gd},qd="webp",Yd=96,Zd=96,Kd="srgb",Qd=4,eu="uchar",tu=288,su=!1,nu=!1,ou=!0,ru="/assets/rain-thunder-bx7a0l5g.webp",au={format:qd,width:Yd,height:Zd,space:Kd,channels:Qd,depth:eu,density:tu,isProgressive:su,hasProfile:nu,hasAlpha:ou,src:ru},iu="webp",lu=96,cu=96,du="srgb",uu=4,fu="uchar",hu=288,mu=!1,pu=!1,xu=!0,gu="/assets/rain-cxs76xuj.webp",bu={format:iu,width:lu,height:cu,space:du,channels:uu,depth:fu,density:hu,isProgressive:mu,hasProfile:pu,hasAlpha:xu,src:gu},yu="webp",vu=96,wu=96,_u="srgb",ku=4,Cu="uchar",ju=288,Nu=!1,Su=!1,$u=!0,Tu="/assets/sleet-gc63vwmo.webp",Pu={format:yu,width:vu,height:wu,space:_u,channels:ku,depth:Cu,density:ju,isProgressive:Nu,hasProfile:Su,hasAlpha:$u,src:Tu},Mu="webp",Au=96,Iu=96,Eu="srgb",Fu=4,Ru="uchar",Lu=288,Du=!1,Ou=!1,Bu=!0,zu="/assets/snow-d0k6tmmc.webp",Wu={format:Mu,width:Au,height:Iu,space:Eu,channels:Fu,depth:Ru,density:Lu,isProgressive:Du,hasProfile:Ou,hasAlpha:Bu,src:zu},Hu="webp",Uu=96,Ju=96,Xu="srgb",Gu=4,Vu="uchar",qu=288,Yu=!1,Zu=!1,Ku=!0,Qu="/assets/sun-drizzle-g94obr5e.webp",ef={format:Hu,width:Uu,height:Ju,space:Xu,channels:Gu,depth:Vu,density:qu,isProgressive:Yu,hasProfile:Zu,hasAlpha:Ku,src:Qu},tf="webp",sf=96,nf=96,of="srgb",rf=4,af="uchar",lf=288,cf=!1,df=!1,uf=!0,ff="/assets/sun-hazy-c3z1j0hy.webp",hf={format:tf,width:sf,height:nf,space:of,channels:rf,depth:af,density:lf,isProgressive:cf,hasProfile:df,hasAlpha:uf,src:ff},mf="webp",pf=96,xf=96,gf="srgb",bf=4,yf="uchar",vf=288,wf=!1,_f=!1,kf=!0,Cf="/assets/sun-mostly-cloudy-d4o4zkga.webp",jf={format:mf,width:pf,height:xf,space:gf,channels:bf,depth:yf,density:vf,isProgressive:wf,hasProfile:_f,hasAlpha:kf,src:Cf},Nf="webp",Sf=96,$f=96,Tf="srgb",Pf=4,Mf="uchar",Af=288,If=!1,Ef=!1,Ff=!0,Rf="/assets/sun-mostly-sunny-livrdkgu.webp",Lf={format:Nf,width:Sf,height:$f,space:Tf,channels:Pf,depth:Mf,density:Af,isProgressive:If,hasProfile:Ef,hasAlpha:Ff,src:Rf},Df="webp",Of=96,Bf=96,zf="srgb",Wf=4,Hf="uchar",Uf=288,Jf=!1,Xf=!1,Gf=!0,Vf="/assets/sun-shower-lvtjthah.webp",qf={format:Df,width:Of,height:Bf,space:zf,channels:Wf,depth:Hf,density:Uf,isProgressive:Jf,hasProfile:Xf,hasAlpha:Gf,src:Vf},Yf="webp",Zf=96,Kf=96,Qf="srgb",eh=4,th="uchar",sh=288,nh=!1,oh=!1,rh=!0,ah="/assets/sun-sunny-kqjpjzd8.webp",ih={format:Yf,width:Zf,height:Kf,space:Qf,channels:eh,depth:th,density:sh,isProgressive:nh,hasProfile:oh,hasAlpha:rh,src:ah},lh="webp",ch=96,dh=96,uh="srgb",fh=4,hh="uchar",mh=288,ph=!1,xh=!1,gh=!0,bh="/assets/thunder-jgjqg9ai.webp",yh={format:lh,width:ch,height:dh,space:uh,channels:fh,depth:hh,density:mh,isProgressive:ph,hasProfile:xh,hasAlpha:gh,src:bh},vh="webp",wh=96,_h=96,kh="srgb",Ch=4,jh="uchar",Nh=288,Sh=!1,$h=!1,Th=!0,Ph="/assets/tornado-opa24tq3.webp",Mh={format:vh,width:wh,height:_h,space:kh,channels:Ch,depth:jh,density:Nh,isProgressive:Sh,hasProfile:$h,hasAlpha:Th,src:Ph},Ah="webp",Ih=96,Eh=96,Fh="srgb",Rh=4,Lh="uchar",Dh=288,Oh=!1,Bh=!1,zh=!0,Wh="/assets/windy-mw0a3u21.webp",Hh={format:Ah,width:Ih,height:Eh,space:Fh,channels:Rh,depth:Lh,density:Dh,isProgressive:Oh,hasProfile:Bh,hasAlpha:zh,src:Wh},Uh="webp",Jh=96,Xh=96,Gh="srgb",Vh=4,qh="uchar",Yh=288,Zh=!1,Kh=!1,Qh=!0,em="/assets/cloud-foggy-fhg0jn0w.webp",tm={format:Uh,width:Jh,height:Xh,space:Gh,channels:Vh,depth:qh,density:Yh,isProgressive:Zh,hasProfile:Kh,hasAlpha:Qh,src:em},sm="webp",nm=96,om=96,rm="srgb",am=4,im="uchar",lm=288,cm=!1,dm=!1,um=!0,fm="/assets/cloudy-disd26f3.webp",hm={format:sm,width:nm,height:om,space:rm,channels:am,depth:im,density:lm,isProgressive:cm,hasProfile:dm,hasAlpha:um,src:fm},mm="webp",pm=96,xm=96,gm="srgb",bm=4,ym="uchar",vm=288,wm=!1,_m=!1,km=!0,Cm="/assets/heavy-snow-g6jjwo2d.webp",jm={format:mm,width:pm,height:xm,space:gm,channels:bm,depth:ym,density:vm,isProgressive:wm,hasProfile:_m,hasAlpha:km,src:Cm},Nm="webp",Sm=96,$m=96,Tm="srgb",Pm=4,Mm="uchar",Am=288,Im=!1,Em=!1,Fm=!0,Rm="/assets/light-snow-iz0efpkh.webp",Lm={format:Nm,width:Sm,height:$m,space:Tm,channels:Pm,depth:Mm,density:Am,isProgressive:Im,hasProfile:Em,hasAlpha:Fm,src:Rm},Dm="webp",Om=96,Bm=96,zm="srgb",Wm=4,Hm="uchar",Um=288,Jm=!1,Xm=!1,Gm=!0,Vm="/assets/moon-drizzle-b1nfv39c.webp",qm={format:Dm,width:Om,height:Bm,space:zm,channels:Wm,depth:Hm,density:Um,isProgressive:Jm,hasProfile:Xm,hasAlpha:Gm,src:Vm},Ym="webp",Zm=96,Km=96,Qm="srgb",ep=4,tp="uchar",sp=288,np=!1,op=!1,rp=!0,ap="/assets/moon-hazy-nfnzea7a.webp",ip={format:Ym,width:Zm,height:Km,space:Qm,channels:ep,depth:tp,density:sp,isProgressive:np,hasProfile:op,hasAlpha:rp,src:ap},lp="webp",cp=96,dp=96,up="srgb",fp=4,hp="uchar",mp=288,pp=!1,xp=!1,gp=!0,bp="/assets/moon-mostly-cloudy-e56e3z55.webp",yp={format:lp,width:cp,height:dp,space:up,channels:fp,depth:hp,density:mp,isProgressive:pp,hasProfile:xp,hasAlpha:gp,src:bp},vp="webp",wp=96,_p=96,kp="srgb",Cp=4,jp="uchar",Np=288,Sp=!1,$p=!1,Tp=!0,Pp="/assets/moon-mostly-sunny-ffu4gzf4.webp",Mp={format:vp,width:wp,height:_p,space:kp,channels:Cp,depth:jp,density:Np,isProgressive:Sp,hasProfile:$p,hasAlpha:Tp,src:Pp},Ap="webp",Ip=96,Ep=96,Fp="srgb",Rp=4,Lp="uchar",Dp=288,Op=!1,Bp=!1,zp=!0,Wp="/assets/moon-shower-e5dy9u48.webp",Hp={format:Ap,width:Ip,height:Ep,space:Fp,channels:Rp,depth:Lp,density:Dp,isProgressive:Op,hasProfile:Bp,hasAlpha:zp,src:Wp},Up="webp",Jp=96,Xp=96,Gp="srgb",Vp=4,qp="uchar",Yp=288,Zp=!1,Kp=!1,Qp=!0,ex="/assets/moon-sunny-d9o08xiw.webp",tx={format:Up,width:Jp,height:Xp,space:Gp,channels:Vp,depth:qp,density:Yp,isProgressive:Zp,hasProfile:Kp,hasAlpha:Qp,src:ex},sx="webp",nx=96,ox=96,rx="srgb",ax=4,ix="uchar",lx=288,cx=!1,dx=!1,ux=!0,fx="/assets/rain-thunder-eplemvu1.webp",hx={format:sx,width:nx,height:ox,space:rx,channels:ax,depth:ix,density:lx,isProgressive:cx,hasProfile:dx,hasAlpha:ux,src:fx},mx="webp",px=96,xx=96,gx="srgb",bx=4,yx="uchar",vx=288,wx=!1,_x=!1,kx=!0,Cx="/assets/rain-ogayr6kt.webp",jx={format:mx,width:px,height:xx,space:gx,channels:bx,depth:yx,density:vx,isProgressive:wx,hasProfile:_x,hasAlpha:kx,src:Cx},Nx="webp",Sx=96,$x=96,Tx="srgb",Px=4,Mx="uchar",Ax=288,Ix=!1,Ex=!1,Fx=!0,Rx="/assets/sleet-o8noil7l.webp",Lx={format:Nx,width:Sx,height:$x,space:Tx,channels:Px,depth:Mx,density:Ax,isProgressive:Ix,hasProfile:Ex,hasAlpha:Fx,src:Rx},Dx="webp",Ox=96,Bx=96,zx="srgb",Wx=4,Hx="uchar",Ux=288,Jx=!1,Xx=!1,Gx=!0,Vx="/assets/snow-lq4cl3uc.webp",qx={format:Dx,width:Ox,height:Bx,space:zx,channels:Wx,depth:Hx,density:Ux,isProgressive:Jx,hasProfile:Xx,hasAlpha:Gx,src:Vx},Yx="webp",Zx=96,Kx=96,Qx="srgb",eg=4,tg="uchar",sg=288,ng=!1,og=!1,rg=!0,ag="/assets/sun-drizzle-htsohv65.webp",ig={format:Yx,width:Zx,height:Kx,space:Qx,channels:eg,depth:tg,density:sg,isProgressive:ng,hasProfile:og,hasAlpha:rg,src:ag},lg="webp",cg=96,dg=96,ug="srgb",fg=4,hg="uchar",mg=288,pg=!1,xg=!1,gg=!0,bg="/assets/sun-hazy-nfj7clcd.webp",yg={format:lg,width:cg,height:dg,space:ug,channels:fg,depth:hg,density:mg,isProgressive:pg,hasProfile:xg,hasAlpha:gg,src:bg},vg="webp",wg=96,_g=96,kg="srgb",Cg=4,jg="uchar",Ng=288,Sg=!1,$g=!1,Tg=!0,Pg="/assets/sun-mostly-cloudy-e3pqqgs7.webp",Mg={format:vg,width:wg,height:_g,space:kg,channels:Cg,depth:jg,density:Ng,isProgressive:Sg,hasProfile:$g,hasAlpha:Tg,src:Pg},Ag="webp",Ig=96,Eg=96,Fg="srgb",Rg=4,Lg="uchar",Dg=288,Og=!1,Bg=!1,zg=!0,Wg="/assets/sun-mostly-sunny-o99k1c7a.webp",Hg={format:Ag,width:Ig,height:Eg,space:Fg,channels:Rg,depth:Lg,density:Dg,isProgressive:Og,hasProfile:Bg,hasAlpha:zg,src:Wg},Ug="webp",Jg=96,Xg=96,Gg="srgb",Vg=4,qg="uchar",Yg=288,Zg=!1,Kg=!1,Qg=!0,eb="/assets/sun-shower-ldwl4jbp.webp",tb={format:Ug,width:Jg,height:Xg,space:Gg,channels:Vg,depth:qg,density:Yg,isProgressive:Zg,hasProfile:Kg,hasAlpha:Qg,src:eb},sb="webp",nb=96,ob=96,rb="srgb",ab=4,ib="uchar",lb=!1,cb=!1,db=!0,ub="/assets/sun-sunny-kqjpjzd8.webp",fb={format:sb,width:nb,height:ob,space:rb,channels:ab,depth:ib,isProgressive:lb,hasProfile:cb,hasAlpha:db,src:ub},hb="webp",mb=96,pb=96,xb="srgb",gb=4,bb="uchar",yb=288,vb=!1,wb=!1,_b=!0,kb="/assets/thunder-xzn1cku3.webp",Cb={format:hb,width:mb,height:pb,space:xb,channels:gb,depth:bb,density:yb,isProgressive:vb,hasProfile:wb,hasAlpha:_b,src:kb},jb="webp",Nb=96,Sb=96,$b="srgb",Tb=4,Pb="uchar",Mb=288,Ab=!1,Ib=!1,Eb=!0,Fb="/assets/tornado-diqu61wg.webp",Rb={format:jb,width:Nb,height:Sb,space:$b,channels:Tb,depth:Pb,density:Mb,isProgressive:Ab,hasProfile:Ib,hasAlpha:Eb,src:Fb},Lb="webp",Db=96,Ob=96,Bb="srgb",zb=4,Wb="uchar",Hb=288,Ub=!1,Jb=!1,Xb=!0,Gb="/assets/windy-n2v8wtyp.webp",Vb={format:Lb,width:Db,height:Ob,space:Bb,channels:zb,depth:Wb,density:Hb,isProgressive:Ub,hasProfile:Jb,hasAlpha:Xb,src:Gb},qb={foggy:{default:Vl},cloudy:{default:ac},"heavy-snow":{default:bc},"light-snow":{default:Pc},sleet:{default:Pu},drizzle:{default:ef,night:Wc},hazy:{default:hf,night:ed},"mostly-cloudy":{default:jf,night:fd},"mostly-sunny":{default:Lf,night:Cd},shower:{default:qf,night:Rd},sunny:{default:ih,night:Vd},"rain-thunder":{default:au},rain:{default:bu},snow:{default:Wu},thunder:{default:yh},tornado:{default:Mh},windy:{default:Hh}},Yb={foggy:{default:tm},cloudy:{default:hm},"heavy-snow":{default:jm},"light-snow":{default:Lm},sleet:{default:Lx},drizzle:{default:ig,night:qm},hazy:{default:yg,night:ip},"mostly-cloudy":{default:Mg,night:yp},"mostly-sunny":{default:Hg,night:Mp},shower:{default:tb,night:Hp},sunny:{default:fb,night:tx},"rain-thunder":{default:hx},rain:{default:jx},snow:{default:qx},thunder:{default:Cb},tornado:{default:Rb},windy:{default:Vb}};function Zb({weatherCode:e,isDarkMode:t,isNight:s}){const r=t?Yb:qb,o=Kb(e),a=r[o];return a.night&&s?a.night:a.default}function Kb(e){switch(e){case 1:case 33:return"sunny";case 2:case 3:case 34:case 35:case 36:return"mostly-sunny";case 4:case 6:case 13:case 14:case 38:return"mostly-cloudy";case 5:case 37:return"hazy";case 7:case 8:return"cloudy";case 11:return"foggy";case 12:case 39:case 40:return"shower";case 15:case 16:case 17:case 41:case 42:return"thunder";case 18:return"rain";case 19:case 20:case 21:case 43:return"light-snow";case 22:case 23:case 44:return"snow";case 24:case 25:case 26:case 29:return"sleet";case 32:return"windy";default:return"cloudy"}}const Qb="C";function ey(e,t){return Math.round(e==="F"?t*9/5+32:(t-32)*5/9)}function vs(e,t,s=Qb){return e===s?`${Math.round(t)}°`:`${ey(e,t)}°`}const ty=7,ws=8,sy=m.memo(function({weatherResults:t,dateRange:s,turnIndex:r,trackContentReferenceEvent:o}){const[a,l]=hy(),c=ry(t);m.useEffect(()=>{o("Search Content Reference Shown","search_content_reference_shown","forecast")},[o]);const{daily:i,hourly:u,historical:p}=t;let f="daily";if(s||u&&i.length<2)f="hourly";else if(i.length>0)f="daily";else if(p&&p?.length>0)f="historical";else return null;return n.jsxs("div",{className:"relative","data-testid":"weather-widget",children:[c?n.jsxs(n.Fragment,{children:[n.jsx(oy,{weatherResults:t}),n.jsx(ay,{weatherResults:t,temperatureUnit:a,setTemperatureUnit:l})]}):n.jsx("div",{className:"bg-token-main-surface-primary absolute end-0 top-3 z-10 rounded-sm",children:n.jsx(hn,{onTemperatureUnitChange:l,temperatureUnit:a})}),n.jsx(dy,{turnIndex:r}),f==="hourly"&&n.jsx(iy,{weatherResults:t,temperatureUnit:a,dateRange:s}),f==="daily"&&n.jsx(ly,{dailyForecast:i.slice(0,ty),temperatureUnit:a}),f==="historical"&&n.jsx(cy,{historical:p,temperatureUnit:a})]})});function ny({weatherAlert:e}){const[t,s]=m.useState(!1),r=M(),o=zs(),a=J(e.start_timestamp,e.utc_offset_sec),l=e.end_timestamp?J(e.end_timestamp,e.utc_offset_sec):null,c=n.jsxs(n.Fragment,{children:[n.jsx("div",{children:n.jsx($,{id:"JnuGPS",defaultMessage:"{start}{separator}{end}",values:{start:r.formatDate(a,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),separator:l?" - ":"",end:l?r.formatDate(l,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):""}})}),n.jsx("div",{children:e.summary})]});return n.jsxs("button",{className:"my-2 flex w-full flex-col gap-2 rounded-xl border border-red-200 bg-red-100 px-4 py-3 text-start text-sm text-red-800",onClick:()=>s(!t),children:[n.jsxs("div",{className:"flex w-full items-center gap-4",children:[n.jsx(vr,{className:"h-9 w-9 shrink-0"}),n.jsxs("div",{className:"flex flex-col",children:[n.jsx("div",{className:"font-bold",children:n.jsx($,{id:"y+fy/l",defaultMessage:"Severe Weather: {name}",values:{name:e.name}})}),o&&c]}),n.jsx("div",{className:"grow"}),n.jsx("div",{className:"opacity-30",children:t?n.jsx(ba,{className:"icon-lg"}):n.jsx(ga,{className:"icon-lg"})})]}),t&&e.details&&n.jsxs(n.Fragment,{children:[!o&&c,n.jsx("div",{className:"mt-1 whitespace-pre-wrap",children:e.details.trim()})]})]})}function oy({weatherResults:e}){const{severe:t}=e;return t?n.jsx("div",{className:"my-2",children:t.map((s,r)=>n.jsx(ny,{weatherAlert:s},r))}):null}function ry(e){const{historical:t,daily:s,hourly:r,current:o}=e;if(!o)return!1;let a=!1;const l=J(o.timestamp,o.utc_offset_sec);for(const c of[t,s,r])c&&(a=a||c?.some(i=>gr(l,J(i.timestamp,i.utc_offset_sec))));return a}function ay({weatherResults:e,temperatureUnit:t,setTemperatureUnit:s}){const r=M(),{current:o}=e;if(!o)return null;const a=o.temperature.current,l=o.description,c=a!=null&&l&&" · ";return n.jsxs("div",{className:"not-prose flex items-center gap-4",children:[n.jsxs("div",{className:"grow",children:[n.jsxs("div",{className:"text-lg font-semibold",children:[a!=null&&n.jsx($,{id:"FiwByI",defaultMessage:"Currently {temperature}",values:{temperature:ne(r,a,t)}}),c,l.description]}),n.jsx("div",{className:"text-token-text-secondary",children:fy(e.location)})]}),n.jsxs("div",{className:"flex",children:[n.jsx(hn,{onTemperatureUnitChange:s,temperatureUnit:t}),n.jsx(Tt,{weatherDescriptionData:l,isNight:o.night})]})]})}function $t({children:e}){return n.jsx("div",{className:"no-scrollbar not-prose mt-1 overflow-auto sm:overflow-hidden",children:n.jsx(R.Root,{className:"min-w-0",children:n.jsx(R.Body,{className:"border-token-border-medium border-b-[0.5px] [&_tr:last-child]:border-b-0",children:e})})})}function iy({weatherResults:e,temperatureUnit:t,dateRange:s}){const r=M(),{hourly:o,current:a}=e;let l=o??[];s&&(l=l.filter(p=>p.timestamp>=s.start_timestamp&&p.timestamp<s.end_timestamp));const[c,i]=m.useState(!1),u=l.length>ws;if(!c&&u){const p=l[0],f=J(p.timestamp,p.utc_offset_sec);let x=!1;if(a){const b=J(a.timestamp,a.utc_offset_sec);f.getTime()-b.getTime()>8*60*60*1e3&&l.length>18&&(l=l.slice(7,18),x=!0)}x||(l=l.slice(0,ws))}return n.jsxs($t,{children:[l.map((p,f)=>n.jsxs(R.Row,{children:[n.jsxs(B,{className:"w-44",children:[n.jsx(Tt,{weatherDescriptionData:p.description,isNight:p.night,size:"small"}),n.jsx("div",{className:"ms-3 whitespace-nowrap",children:n.jsx("span",{className:"lowercase",children:uy(r,p)})})]}),n.jsx(B,{className:"w-[60px] tabular-nums",children:n.jsx("div",{children:ne(r,p.temperature.current,t)})}),n.jsx(B,{children:p.description.description})]},f)),u&&n.jsx(R.Row,{children:n.jsx(B,{className:"w-44",children:n.jsx(q,{color:"secondary",onClick:()=>i(!c),size:"small",children:c?n.jsx($,{id:"KoC8Ym",defaultMessage:"Show less"}):n.jsx($,{id:"X8F8Y/",defaultMessage:"Show more"})})})})]})}function ly({dailyForecast:e,temperatureUnit:t}){const s=M();return n.jsx($t,{children:e.map((r,o)=>n.jsxs(R.Row,{children:[n.jsxs(B,{className:"w-[7.5rem] min-w-[7.5rem]",children:[n.jsx(Tt,{weatherDescriptionData:r.description,isNight:r.night,size:"small"}),n.jsx("div",{className:"ms-3 whitespace-nowrap",children:mt(s,J(r.timestamp,r.utc_offset_sec))})]}),n.jsxs(B,{className:"tabular-nums",children:[n.jsx("div",{children:ne(s,r.temperature.max,t)}),n.jsx("div",{className:"text-token-text-secondary ms-1",children:ne(s,r.temperature.min,t)})]}),n.jsx(B,{className:"min-w-80",children:r.description.description})]},o))})}function cy({historical:e,temperatureUnit:t}){const s=M();return e?n.jsx($t,{children:e.map((r,o)=>{const a=J(r.timestamp,r.utc_offset_sec);return n.jsxs(R.Row,{children:[n.jsx(B,{className:"w-[250px]",children:n.jsx("div",{className:"ms-3 whitespace-nowrap",children:s.formatDate(a,{weekday:"long",month:"short",day:"numeric"})})}),n.jsx(B,{className:"tabular-nums",children:r.temperature.max&&r.temperature.min?n.jsxs(n.Fragment,{children:[n.jsx("div",{children:ne(s,r.temperature.max,t)}),n.jsx("div",{className:"text-token-text-secondary ms-1",children:ne(s,r.temperature.min,t)})]}):n.jsx("div",{children:ne(s,r.temperature.current,t)})}),n.jsx(B,{})]},o)})}):null}function B({className:e,children:t}){return n.jsx(R.Cell,{className:k("border-token-border-xlight! border-s-0! border-e-0! py-2! ps-4! pe-3! first:ps-0! last:pe-0!",e),divClassName:"items-start leading-relaxed",children:t})}function dy({turnIndex:e}){const t=Qr(r=>r.thread?.turns[e]?.use_location),[s]=Xr();return!s.useLocation&&t?n.jsx("div",{className:"mt-3",children:n.jsx(q,{color:"secondary",icon:_o,onClick:()=>{Gr.setSettingsModalOpen(!0)},children:n.jsx($,{id:"f47VEc",defaultMessage:"Share precise location"})})}):null}function hn({temperatureUnit:e,onTemperatureUnitChange:t}){const s=r=>e===r?"font-bold":"font-light";return n.jsx(br,{size:"small",triggerButton:n.jsx("button",{className:"text-token-text-tertiary hover:text-token-text-primary flex items-center justify-center p-1.5",children:n.jsx(wo,{className:"icon-sm"})}),children:n.jsxs(yr.Item,{onClick:()=>{t(e==="C"?"F":"C")},className:"text-token-text-primary",children:[n.jsx($,{id:"bQIoe/",defaultMessage:"Temperature"}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:s("F"),children:n.jsx($,{id:"bvDeBB",defaultMessage:"°F"})}),n.jsx("div",{className:"mx-1 h-4 border-s border-gray-300"}),n.jsx("div",{className:s("C"),children:n.jsx($,{id:"iNiz6O",defaultMessage:"°C"})})]})]})})}function Tt({weatherDescriptionData:e,isNight:t=!1,size:s="normal"}){const r=Ke(),o=s==="small"?30:50;return n.jsx("img",{draggable:!1,alt:e.description,src:Zb({weatherCode:e.id,isDarkMode:r,isNight:t}).src,width:o,height:o})}function uy(e,t){const s=J(t.timestamp,t.utc_offset_sec);return e.formatDate(s,{hour:"numeric"})}function ne(e,t,s){return t==null?"-":vs(s?s??"F":mn(e),t)}function mn(e){const t=["en-US","en-BZ","en-BS","en-KY","en-PW"],s=e.locale||"en-US";return t.includes(s)?"F":"C"}function fy(e){const t=e.name.split(",").map(s=>s.trim());return e.country&&!t.includes(e.country)&&t.push(e.country),t.join(", ")}const hy=()=>{const e=M(),[t,s]=xr("USER_TEMPERATURE_UNIT",mn(e),r=>["F","C"].includes(r));return[t,s]},my=wr(()=>_r(()=>import("./l6cv5nzindj4r51t.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(e=>e.BusinessesMap));function py(e){"use forget";const t=pt.c(123),{index:s,FormattedText:r,node:o,wordFadeType:a}=e,l=parseInt(s,10),c=m.useContext(U),i=Ms(c?.analyticsMetadata),u=m.useRef(!1);if(c==null)return null;const{contentReferences:p,onShowSearchResults:f,numImageResults:x,analyticsMetadata:b,message:y}=c,h=p?.[l];if(!h||b.turnIndex===void 0||h.type===void 0)return null;let _;t[0]===Symbol.for("react.memo_cache_sentinel")?(_={img:gy},t[0]=_):_=t[0];let j;t[1]!==h.alt?(j=n.jsx(wt,{components:_,children:h.alt}),t[1]=h.alt,t[2]=j):j=t[2];const N=j;let v=null;e:switch(h.type){case"title_citation":{let d;t[3]!==h||t[4]!==i?(d=n.jsx($l,{metadata:h,trackContentReferenceEvent:i}),t[3]=h,t[4]=i,t[5]=d):d=t[5],v=d;break e}case"location_search":{let d;t[6]!==h||t[7]!==i?(d=n.jsx(ml,{metadata:h,trackContentReferenceEvent:i}),t[6]=h,t[7]=i,t[8]=d):d=t[8],v=d;break e}case"time":{let d;t[9]!==h||t[10]!==i?(d=n.jsx(Sl,{metadata:h,trackContentReferenceEvent:i}),t[9]=h,t[10]=i,t[11]=d):d=t[11],v=d;break e}case"image_v2":{const d=x??0;let S;t[12]!==b||t[13]!==h||t[14]!==i||t[15]!==d?(S=n.jsx(Nt,{metadata:h,numImageResults:d,analyticsMetadata:b,trackContentReferenceEvent:i}),t[12]=b,t[13]=h,t[14]=i,t[15]=d,t[16]=S):S=t[16],v=S;break e}case"nav_list":{let d;t[17]!==h||t[18]!==i?(d=n.jsx(xl,{metadata:h,trackContentReferenceEvent:i}),t[17]=h,t[18]=i,t[19]=d):d=t[19],v=d;break e}case"file_navlist":{let d;t[20]!==h||t[21]!==i?(d=n.jsx(qi,{metadata:h,trackContentReferenceEvent:i}),t[20]=h,t[21]=i,t[22]=d):d=t[22],v=d;break e}case"file":{let d;t[23]!==h||t[24]!==i||t[25]!==l?(d=n.jsx(Ji,{fileRef:h,index:l,trackContentReferenceEvent:i}),t[23]=h,t[24]=i,t[25]=l,t[26]=d):d=t[26],v=d;break e}case"grouped_webpages_model_predicted_fallback":{let d;t[27]!==h||t[28]!==c.message.id||t[29]!==i||t[30]!==l||t[31]!==o?(d=n.jsx(Co,{webpageRef:h,node:o,trackContentReferenceEvent:i,messageId:c.message.id,index:l}),t[27]=h,t[28]=c.message.id,t[29]=i,t[30]=l,t[31]=o,t[32]=d):d=t[32],v=d;break e}case"grouped_webpages":{let d;t[33]!==h||t[34]!==c.message.id||t[35]!==i||t[36]!==l||t[37]!==o?(d=n.jsx(ko,{webpageRef:h,node:o,trackContentReferenceEvent:i,messageId:c.message.id,index:l}),t[33]=h,t[34]=c.message.id,t[35]=i,t[36]=l,t[37]=o,t[38]=d):d=t[38],v=d;break e}case"tldr":break e;case"navigation":{let d;t[39]!==h||t[40]!==i||t[41]!==f?(d=n.jsx(So,{navigation:h,onShowSearchResults:f,trackContentReferenceEvent:i}),t[39]=h,t[40]=i,t[41]=f,t[42]=d):d=t[42],v=d;break e}case"stock":{let d;t[43]!==h||t[44]!==i?(d=n.jsx(dl,{contentReference:h,trackContentReferenceEvent:i}),t[43]=h,t[44]=i,t[45]=d):d=t[45],v=d;break e}case"calculator":{let d;t[46]!==h||t[47]!==i?(d=n.jsx(Li,{data:h,trackContentReferenceEvent:i}),t[46]=h,t[47]=i,t[48]=d):d=t[48],v=d;break e}case"python":case"container":{let d;t[49]!==b.turnIndex||t[50]!==h||t[51]!==c.clientThreadId?(d=n.jsx(Wi,{clientThreadId:c.clientThreadId,turnIndex:b.turnIndex,contentReference:h}),t[49]=b.turnIndex,t[50]=h,t[51]=c.clientThreadId,t[52]=d):d=t[52],v=d;break e}case"code_execution":{let d;t[53]!==r||t[54]!==h||t[55]!==i?(d=n.jsx(Bi,{FormattedText:r,displayInfo:h,trackContentReferenceEvent:i}),t[53]=r,t[54]=h,t[55]=i,t[56]=d):d=t[56],v=d;break e}case"forecast":{let d;t[57]!==b||t[58]!==h.date_range||t[59]!==h.forecast||t[60]!==i?(d=h?.forecast&&n.jsx(sy,{weatherResults:h.forecast,dateRange:h.date_range,turnIndex:b.turnIndex,trackContentReferenceEvent:i}),t[57]=b,t[58]=h.date_range,t[59]=h.forecast,t[60]=i,t[61]=d):d=t[61],v=d;break e}case"businesses_map":{let d;t[62]!==h||t[63]!==i?(d=n.jsx(my,{contentReference:h,trackContentReferenceEvent:i}),t[62]=h,t[63]=i,t[64]=d):d=t[64],v=d;break e}case"video":{let d;t[65]!==h||t[66]!==i?(d=n.jsx(Rl,{video:h,trackContentReferenceEvent:i}),t[65]=h,t[66]=i,t[67]=d):d=t[67],v=d;break e}case"sports_standings":{let d;t[68]!==h||t[69]!==i?(d=n.jsx(jl,{standingsRef:h,trackContentReferenceEvent:i}),t[68]=h,t[69]=i,t[70]=d):d=t[70],v=d;break e}case"sports_schedule":{let d;t[71]!==h||t[72]!==i?(d=n.jsx(wl,{scheduleRef:h,trackContentReferenceEvent:i}),t[71]=h,t[72]=i,t[73]=d):d=t[73],v=d;break e}case"attribution":{let d;t[74]!==h||t[75]!==a?(d=n.jsx(Ai,{attribution:h,wordFadeType:a}),t[74]=h,t[75]=a,t[76]=d):d=t[76],v=d;break e}case"debug":{let d;t[77]!==h?(d=Object.entries(h).map(xy),t[77]=h,t[78]=d):d=t[78];let S;t[79]!==d?(S=n.jsx(n.Fragment,{children:d}),t[79]=d,t[80]=S):S=t[80],v=S;break e}case"image_inline":{let d;t[81]!==h||t[82]!==c.clientThreadId||t[83]!==i||t[84]!==y?(d=y.metadata?.b1de6e2_rm?n.jsx(wi,{reference:h,clientThreadId:c.clientThreadId,trackContentReferenceEvent:i,message:y}):n.jsx(ki,{reference:h,clientThreadId:c.clientThreadId,trackContentReferenceEvent:i,message:y}),t[81]=h,t[82]=c.clientThreadId,t[83]=i,t[84]=y,t[85]=d):d=t[85],v=d;break e}case"image_group":{let d;t[86]!==b||t[87]!==h||t[88]!==i?(d=n.jsx(si,{contentReference:h,trackContentReferenceEvent:i,analyticsMetadata:b}),t[86]=b,t[87]=h,t[88]=i,t[89]=d):d=t[89],v=d;break e}case"product_entity":{let d;t[90]!==b.turnIndex||t[91]!==h||t[92]!==c.clientThreadId||t[93]!==c.message.id||t[94]!==i?(d=n.jsx(Ci,{contentReference:h,clientThreadId:c.clientThreadId,messageId:c.message.id,turnIndex:b.turnIndex,trackContentReferenceEvent:i}),t[90]=b.turnIndex,t[91]=h,t[92]=c.clientThreadId,t[93]=c.message.id,t[94]=i,t[95]=d):d=t[95],v=d;break e}case"checkout_confirmation":{let d;t[96]!==h||t[97]!==i?(d=null,t[96]=h,t[97]=i,t[98]=d):d=t[98],v=d;break e}case"entity":{let d;t[99]!==b||t[100]!==h||t[101]!==c.clientThreadId||t[102]!==c.message||t[103]!==i?(d=null,t[99]=b,t[100]=h,t[101]=c.clientThreadId,t[102]=c.message,t[103]=i,t[104]=d):d=t[104],v=d;break e}case"products":{let d;t[105]!==b||t[106]!==h||t[107]!==c.clientThreadId||t[108]!==c.message.id?(d=n.jsx(Si,{contentReference:h,clientThreadId:c.clientThreadId,messageId:c.message.id,turnIndex:b.turnIndex,analyticsMetadata:b}),t[105]=b,t[106]=h,t[107]=c.clientThreadId,t[108]=c.message.id,t[109]=d):d=t[109],v=d;break e}case"product_reviews":{let d;t[110]!==h||t[111]!==i?(d=n.jsx(No,{contentReference:h,disableAnimation:!0,trackContentReferenceEvent:i}),t[110]=h,t[111]=i,t[112]=d):d=t[112],v=d;break e}case"product_rationale":{let d;t[113]!==h||t[114]!==i?(d=n.jsx(jo,{contentReference:h,trackContentReferenceEvent:i,disableAnimation:!0}),t[113]=h,t[114]=i,t[115]=d):d=t[115],v=d;break e}case"sources_footnote":return null}let g;t[116]!==N||t[117]!==h||t[118]!==i?(g=d=>(u.current||(i("Search Content Reference Failed","search_content_reference_failed",h.type),Ye.addError(`Error rendering content reference: ${h.type}`,{...d,contentReference:h}),u.current=!0),h?.alt?N:n.jsx("span",{className:`errored-object-${h.type}`})),t[116]=N,t[117]=h,t[118]=i,t[119]=g):g=t[119];let w;return t[120]!==v||t[121]!==g?(w=n.jsx(Hs,{name:"content-reference-renderer",fallback:g,children:v}),t[120]=v,t[121]=g,t[122]=w):w=t[122],w}function xy(e){const[t,s]=e;return n.jsx("sub",{className:"ms-1 w-fit rounded-md border-2 border-solid border-orange-500 px-1 leading-none",children:s},t)}function gy(e){const{src:t,alt:s}=e;return n.jsx("img",{src:t,alt:s,className:"max-h-28"})}const by=({onClick:e})=>{const[t,s]=m.useState(!1),r=$o(),o=M(),a=i=>{e(i),s(!0),setTimeout(()=>{r()&&s(!1)},2e3)},l=t?To:Po,c=o.formatMessage({id:"uG/ayY",defaultMessage:"Copy table"});return n.jsx(Ze,{label:c,side:"bottom",align:"center",alignOffset:0,children:n.jsx("button",{"aria-label":c,onClick:a,className:"hover:bg-token-bg-tertiary text-token-text-secondary my-1 rounded-sm p-1 transition-opacity group-[:not(:hover):not(:focus-within)]:pointer-events-none group-[:not(:hover):not(:focus-within)]:opacity-0",children:n.jsx(l,{className:"icon"})})})},yy=({onClickCopy:e,children:t,...s})=>{const r=m.useRef(null),o=m.useRef(null);return kr(()=>{Mo({axis:"height",target:r.current?.firstElementChild,onChange:({height:a})=>{o.current&&(o.current.style.height=`${a}px`)}})},[]),n.jsx("div",{className:Lt.tableContainer,children:n.jsxs("div",{tabIndex:-1,className:k(Lt.tableWrapper,"group flex w-fit flex-col-reverse"),children:[n.jsx("table",{...s,className:"w-fit min-w-(--thread-content-width)",ref:r,children:t}),n.jsx("div",{className:"sticky end-(--thread-content-margin) h-0 self-end select-none",children:n.jsx("div",{className:"absolute end-0 flex items-end",ref:o,children:n.jsx(by,{onClick:e})})})]})})},vy=({node:e,children:t,...s})=>n.jsx("td",{...s,children:m.Children.map(t,(r,o)=>r==="<br>"?n.jsx("br",{},o):r)});function wy(e){const{src:t,clientThreadId:s,...r}=e,o=kt(s),a=m.useContext(U),l=Ro(o,t,a?.useSafeUrls);return l==null?n.jsx("div",{}):n.jsx("img",{...r,src:l})}function _y(e){return n.jsx(py,{...e,FormattedText:ky})}function ky({size:e="medium",children:t,className:s,clientThreadId:r,messageId:o,isActivelyStreaming:a=!1,componentOverrides:l,isDeepResearchResultMessage:c,forceDarkMode:i,disableWordFade:u}){const p=Ke()||i,{wordFadeType:f}=Ao(),x=Io(),b=m.useMemo(()=>({pre:({children:g,"data-start":w,"data-end":d,"data-is-last-node":S})=>n.jsx("pre",{className:"overflow-visible!","data-start":w,"data-end":d,"data-is-last-node":S,children:g}),code:g=>n.jsx(Fo,{...g,clientThreadId:r}),[jr]:g=>n.jsx(_y,{wordFadeType:f,...g}),[Eo]:g=>r==null?null:n.jsx(Ra,{...g,clientThreadId:r,messageId:o}),[Jr]:Ur,[Dr]:La,[Lr]:Va,[Rr]:Xa,[Fr]:za,a:g=>{const{node:w,children:d,...S}=g,T=w?.properties?.href;if(typeof T=="string"&&T.startsWith(At))return r!=null&&o!=null?n.jsx(Nn,{...S,clientThreadId:r,messageId:o,href:T,children:d}):null;if(typeof T=="string"&&T===Sn){const I=w?.children?.map(E=>typeof E.value=="string"?E.value:"").join("").trim();return n.jsx($n,{...g,text:I,clientThreadId:r,messageId:o,className:"cursor-pointer"})}if(typeof T=="string"&&T===Tn){const I=w?.children?.map(E=>typeof E.value=="string"?E.value:"").join("").trim();return n.jsx(Pn,{...g,text:I,clientThreadId:r,messageId:o})}if(typeof T=="string"&&T===Mn){const I=w?.children?.map(E=>typeof E.value=="string"?E.value:"").join("").trim();return n.jsx(An,{...g,text:I,clientThreadId:r,messageId:o})}return T&&typeof T=="string"&&Za(T)?d:n.jsx(ya,{...g,clientThreadId:r,messageId:o})},table:({node:g,...w})=>n.jsx(yy,{...w,onClickCopy:d=>{Le.logEvent("ChatGPT Table Copy Clicked");const S=r!=null&&o!=null?Be.getNode(Cr(r),o).message:void 0;Ns(jn(g.markdownSource,S?.metadata?.content_references),void 0,d)}}),td:vy,...x?{h1:({node:g,...w})=>n.jsx("h1",{"data-section-id":at(g.markdownSource),...w}),h2:({node:g,...w})=>n.jsx("h2",{"data-section-id":at(g.markdownSource),...w}),h3:({node:g,...w})=>n.jsx("h3",{"data-section-id":at(g.markdownSource),...w})}:{},img:({node:g,...w})=>{const d=g?.properties?.src;return typeof d=="string"&&(d.startsWith(At)||d.startsWith("attachment:"))?null:n.jsx(wy,{...w,clientThreadId:r})},...f==="delay"?va:[],...l}),[x,f,l,r,o]),y=m.useMemo(()=>a&&t?wa(t):t??"",[t,a]),h=X(),_=L(h,"1839283687"),j=As(),N=m.useMemo(()=>[...Cs,[In,y]],[y]),v=m.useMemo(()=>f==="indexed"&&!u?{handlers:{text:(g,w,d)=>{const S=[];for(const T of j(w.value))S.push({type:"element",tagName:"span",properties:{className:Is.fadeIn},children:[{type:"text",value:T}]});return S}}}:void 0,[f,j,u]);return _?!1:n.jsx(Hs,{name:"formatted_text_error",fallback:()=>n.jsx(n.Fragment,{children:y}),children:n.jsx(Cy,{rehypePlugins:N,remarkPlugins:ks,remarkRehypeOptions:v,className:k(s,"markdown prose dark:prose-invert w-full break-words",p?"dark":"light",e==="small"&&"prose-xs",c&&"deep-research-result","markdown-new-styling"),urlTransform:_s,components:b,children:y})})}const Cy=m.memo(wt);export{ky as FormattedText,Cy as ReactMarkdownMemo};
//# sourceMappingURL=jq3vs33h4pwyfd63.js.map
