import{qZ as He,r7 as qe,r8 as Ie,r9 as Ge,ra as q,rb as $e,cx as Ke,rc as F,rd as j,re as fe,rf as We,rg as ze,rh as pe,ri as I,rj as G,rk as $,rl as Ve,rm as L,rn as Ye,ro as me,e9 as de,dU as Qe,ay as _,rp as Xe,rq as ge,rr as K,rs as Je,ci as T,qv as he,rt as Ze,ch as et,jA as tt}from"./rseqzngxzbdt1oxg.js";import{a as nt,ce as rt,P as N,d as st,c4 as ot,s as E,N as A,aQ as ye,cR as at,bg as it,c6 as ct,G as lt,nX as ut,nY as be,R as ft,W as pt,h2 as mt,ah as _e,h3 as U,aO as dt,aP as gt,dc as ht,ej as yt,t3 as bt,r as _t,df as wt,jm as Nt,rh as we,t4 as xt}from"./hml6mmd5fyx85si7.js";import{r as b,j as d,R as B,l as Ct,e as kt,d as St,u as Et}from"./lu2xqwqmjc95q6j6.js";import{r as At,c as Lt}from"./fsu81ov1h2xmh0dx.js";import{s as S,e as W,f as Dt,r as vt,a as Rt,b as Tt,c as Ot,d as Mt}from"./gi6j3i926p314he0.js";import{k as z}from"./pc2givv05uuq8g6l.js";const V={},Y={},Q={};function X(e,r){return`${e}::${r}`}function Pt({node:e,onClick:r,children:n,clientThreadId:t,messageId:s,href:i,disableSafeURLs:o,...a}){let c=r;const l=e?.properties?.href,u=b.useContext(He),p=nt(),w=rt(t),m=qe(w,i,u?.useSafeUrls&&!o),g=Ie(t,s)?.metadata?.__internal?.utm_tags??{},y=!o&&m===void 0&&Ge(p);return s!=null&&typeof l=="string"&&l.includes("/bing/redirect")&&(V[s]||(N.logEvent("Browsing Show Bing Link",{id:s,content:l}),V[s]=!0),c=x=>{Y[s]||(N.logEvent("Browsing Click Bing Link",{id:s,content:l}),Y[s]=!0),r?.(x)}),c=x=>{const C=""+l;if(s&&!Q[X(s,C)]){const Be=m||y?"URL Clicked Allowed":"URL Clicked Blocked";N.logEvent(Be,{id:s,content:C}),Q[X(s,C)]=!0}r?.(x),y&&i&&ot(p,$e,{urls:q(i,g)})},d.jsx(d.Fragment,{children:d.jsx("a",{onClick:c,...a,className:st(a.className,y&&"cursor-pointer"),href:m&&q(m,g),rel:"noopener",children:n})})}const Ft="w";function jt({messageId:e,clientThreadId:r,text:n,children:t,...s}){const o=`${window.location.origin}?q=${encodeURIComponent(n)}`,a=Ke(),c=b.useCallback(async l=>{l.preventDefault(),E.count(A.DEFAULT,"instant_follow_up_anchor_clicked"),N.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:r,messageId:e}),a(l,{text:n,type:ye.Reply},[],0)},[r,e,n,a]);return d.jsx(Pt,{...s,href:o,disableSafeURLs:!0,clientThreadId:r,messageId:e,className:"cursor-pointer",onClick:c,children:t})}const vr=B.memo(jt),Ut=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],J={}.hasOwnProperty;function Bt(e,r){const n=r||{};function t(s,...i){let o=t.invalid;const a=t.handlers;if(s&&J.call(s,e)){const c=String(s[e]);o=J.call(a,c)?a[c]:t.unknown}if(o)return o.call(this,s,...i)}return t.handlers=n.handlers||{},t.invalid=n.invalid,t.unknown=n.unknown,t}const Ht=/^>|^->|<!--|-->|--!>|<!-$/g,qt=[">"],It=["<",">"];function Gt(e,r,n,t){return t.settings.bogusComments?"<?"+S(e.value,Object.assign({},t.settings.characterReferences,{subset:qt}))+">":"<!--"+e.value.replace(Ht,s)+"-->";function s(i){return S(i,Object.assign({},t.settings.characterReferences,{subset:It}))}}function $t(e,r,n,t){return"<!"+(t.settings.upperDoctype?"DOCTYPE":"doctype")+(t.settings.tightDoctype?"":" ")+"html>"}const f=xe(1),Ne=xe(-1),Kt=[];function xe(e){return r;function r(n,t,s){const i=n?n.children:Kt;let o=(t||0)+e,a=i[o];if(!s)for(;a&&F(a);)o+=e,a=i[o];return a}}const Wt={}.hasOwnProperty;function Ce(e){return r;function r(n,t,s){return Wt.call(e,n.tagName)&&e[n.tagName](n,t,s)}}const H=Ce({body:Vt,caption:v,colgroup:v,dd:Jt,dt:Xt,head:v,html:zt,li:Qt,optgroup:Zt,option:en,p:Yt,rp:Z,rt:Z,tbody:nn,td:ee,tfoot:rn,th:ee,thead:tn,tr:sn});function v(e,r,n){const t=f(n,r,!0);return!t||t.type!=="comment"&&!(t.type==="text"&&F(t.value.charAt(0)))}function zt(e,r,n){const t=f(n,r);return!t||t.type!=="comment"}function Vt(e,r,n){const t=f(n,r);return!t||t.type!=="comment"}function Yt(e,r,n){const t=f(n,r);return t?t.type==="element"&&(t.tagName==="address"||t.tagName==="article"||t.tagName==="aside"||t.tagName==="blockquote"||t.tagName==="details"||t.tagName==="div"||t.tagName==="dl"||t.tagName==="fieldset"||t.tagName==="figcaption"||t.tagName==="figure"||t.tagName==="footer"||t.tagName==="form"||t.tagName==="h1"||t.tagName==="h2"||t.tagName==="h3"||t.tagName==="h4"||t.tagName==="h5"||t.tagName==="h6"||t.tagName==="header"||t.tagName==="hgroup"||t.tagName==="hr"||t.tagName==="main"||t.tagName==="menu"||t.tagName==="nav"||t.tagName==="ol"||t.tagName==="p"||t.tagName==="pre"||t.tagName==="section"||t.tagName==="table"||t.tagName==="ul"):!n||!(n.type==="element"&&(n.tagName==="a"||n.tagName==="audio"||n.tagName==="del"||n.tagName==="ins"||n.tagName==="map"||n.tagName==="noscript"||n.tagName==="video"))}function Qt(e,r,n){const t=f(n,r);return!t||t.type==="element"&&t.tagName==="li"}function Xt(e,r,n){const t=f(n,r);return!!(t&&t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd"))}function Jt(e,r,n){const t=f(n,r);return!t||t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd")}function Z(e,r,n){const t=f(n,r);return!t||t.type==="element"&&(t.tagName==="rp"||t.tagName==="rt")}function Zt(e,r,n){const t=f(n,r);return!t||t.type==="element"&&t.tagName==="optgroup"}function en(e,r,n){const t=f(n,r);return!t||t.type==="element"&&(t.tagName==="option"||t.tagName==="optgroup")}function tn(e,r,n){const t=f(n,r);return!!(t&&t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot"))}function nn(e,r,n){const t=f(n,r);return!t||t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot")}function rn(e,r,n){return!f(n,r)}function sn(e,r,n){const t=f(n,r);return!t||t.type==="element"&&t.tagName==="tr"}function ee(e,r,n){const t=f(n,r);return!t||t.type==="element"&&(t.tagName==="td"||t.tagName==="th")}const on=Ce({body:ln,colgroup:un,head:cn,html:an,tbody:fn});function an(e){const r=f(e,-1);return!r||r.type!=="comment"}function cn(e){const r=new Set;for(const t of e.children)if(t.type==="element"&&(t.tagName==="base"||t.tagName==="title")){if(r.has(t.tagName))return!1;r.add(t.tagName)}const n=e.children[0];return!n||n.type==="element"}function ln(e){const r=f(e,-1,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&F(r.value.charAt(0)))&&!(r.type==="element"&&(r.tagName==="meta"||r.tagName==="link"||r.tagName==="script"||r.tagName==="style"||r.tagName==="template"))}function un(e,r,n){const t=Ne(n,r),s=f(e,-1,!0);return n&&t&&t.type==="element"&&t.tagName==="colgroup"&&H(t,n.children.indexOf(t),n)?!1:!!(s&&s.type==="element"&&s.tagName==="col")}function fn(e,r,n){const t=Ne(n,r),s=f(e,-1);return n&&t&&t.type==="element"&&(t.tagName==="thead"||t.tagName==="tbody")&&H(t,n.children.indexOf(t),n)?!1:!!(s&&s.type==="element"&&s.tagName==="tr")}const D={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function pn(e,r,n,t){const s=t.schema,i=s.space==="svg"?!1:t.settings.omitOptionalTags;let o=s.space==="svg"?t.settings.closeEmptyElements:t.settings.voids.includes(e.tagName.toLowerCase());const a=[];let c;s.space==="html"&&e.tagName==="svg"&&(t.schema=j);const l=mn(t,e.properties),u=t.all(s.space==="html"&&e.tagName==="template"?e.content:e);return t.schema=s,u&&(o=!1),(l||!i||!on(e,r,n))&&(a.push("<",e.tagName,l?" "+l:""),o&&(s.space==="svg"||t.settings.closeSelfClosing)&&(c=l.charAt(l.length-1),(!t.settings.tightSelfClosing||c==="/"||c&&c!=='"'&&c!=="'")&&a.push(" "),a.push("/")),a.push(">")),a.push(u),!o&&(!i||!H(e,r,n))&&a.push("</"+e.tagName+">"),a.join("")}function mn(e,r){const n=[];let t=-1,s;if(r){for(s in r)if(r[s]!==null&&r[s]!==void 0){const i=dn(e,s,r[s]);i&&n.push(i)}}for(;++t<n.length;){const i=e.settings.tightAttributes?n[t].charAt(n[t].length-1):void 0;t!==n.length-1&&i!=='"'&&i!=="'"&&(n[t]+=" ")}return n.join("")}function dn(e,r,n){const t=fe(e.schema,r),s=e.settings.allowParseErrors&&e.schema.space==="html"?0:1,i=e.settings.allowDangerousCharacters?0:1;let o=e.quote,a;if(t.overloadedBoolean&&(n===t.attribute||n==="")?n=!0:(t.boolean||t.overloadedBoolean&&typeof n!="string")&&(n=!!n),n==null||n===!1||typeof n=="number"&&Number.isNaN(n))return"";const c=S(t.attribute,Object.assign({},e.settings.characterReferences,{subset:D.name[s][i]}));return n===!0||(n=Array.isArray(n)?(t.commaSeparated?We:ze)(n,{padLeft:!e.settings.tightCommaSeparatedLists}):String(n),e.settings.collapseEmptyAttributes&&!n)?c:(e.settings.preferUnquoted&&(a=S(n,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:D.unquoted[s][i]}))),a!==n&&(e.settings.quoteSmart&&W(n,o)>W(n,e.alternative)&&(o=e.alternative),a=o+S(n,Object.assign({},e.settings.characterReferences,{subset:(o==="'"?D.single:D.double)[s][i],attribute:!0}))+o),c+(a&&"="+a))}const gn=["<","&"];function ke(e,r,n,t){return n&&n.type==="element"&&(n.tagName==="script"||n.tagName==="style")?e.value:S(e.value,Object.assign({},t.settings.characterReferences,{subset:gn}))}function hn(e,r,n,t){return t.settings.allowDangerousHtml?e.value:ke(e,r,n,t)}function yn(e,r,n,t){return t.all(e)}const bn=Bt("type",{invalid:_n,unknown:wn,handlers:{comment:Gt,doctype:$t,element:pn,raw:hn,root:yn,text:ke}});function _n(e){throw new Error("Expected node, not `"+e+"`")}function wn(e){const r=e;throw new Error("Cannot compile unknown node `"+r.type+"`")}const Nn={},xn={},Cn=[];function kn(e,r){const n=r||Nn,t=n.quote||'"',s=t==='"'?"'":'"';if(t!=='"'&&t!=="'")throw new Error("Invalid quote `"+t+"`, expected `'` or `\"`");return{one:Sn,all:En,settings:{omitOptionalTags:n.omitOptionalTags||!1,allowParseErrors:n.allowParseErrors||!1,allowDangerousCharacters:n.allowDangerousCharacters||!1,quoteSmart:n.quoteSmart||!1,preferUnquoted:n.preferUnquoted||!1,tightAttributes:n.tightAttributes||!1,upperDoctype:n.upperDoctype||!1,tightDoctype:n.tightDoctype||!1,bogusComments:n.bogusComments||!1,tightCommaSeparatedLists:n.tightCommaSeparatedLists||!1,tightSelfClosing:n.tightSelfClosing||!1,collapseEmptyAttributes:n.collapseEmptyAttributes||!1,allowDangerousHtml:n.allowDangerousHtml||!1,voids:n.voids||Ut,characterReferences:n.characterReferences||xn,closeSelfClosing:n.closeSelfClosing||!1,closeEmptyElements:n.closeEmptyElements||!1},schema:n.space==="svg"?j:pe,quote:t,alternative:s}.one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}function Sn(e,r,n){return bn(e,r,n,this)}function En(e){const r=[],n=e&&e.children||Cn;let t=-1;for(;++t<n.length;)r[t]=this.one(n[t],t,e);return r.join("")}function An(e){const r=this,n={...r.data("settings"),...e};r.compiler=t;function t(s){return kn(s,n)}}const te=/[#.]/g;function Ln(e,r){const n=e||"",t={};let s=0,i,o;for(;s<n.length;){te.lastIndex=s;const a=te.exec(n),c=n.slice(s,a?a.index:n.length);c&&(i?i==="#"?t.id=c:Array.isArray(t.className)?t.className.push(c):t.className=[c]:o=c,s+=c.length),a&&(i=a[0],s++)}return{type:"element",tagName:o||r||"div",properties:t,children:[]}}const Dn=new Set(["button","menu","reset","submit"]),O={}.hasOwnProperty;function Se(e,r,n){const t=n&&On(n);function s(i,o,...a){let c=-1,l;if(i==null){l={type:"root",children:[]};const u=o;a.unshift(u)}else if(l=Ln(i,r),l.tagName=l.tagName.toLowerCase(),t&&O.call(t,l.tagName)&&(l.tagName=t[l.tagName]),vn(o,l.tagName)){let u;for(u in o)O.call(o,u)&&Rn(e,l.properties,u,o[u])}else a.unshift(o);for(;++c<a.length;)M(l.children,a[c]);return l.type==="element"&&l.tagName==="template"&&(l.content={type:"root",children:l.children},l.children=[]),l}return s}function vn(e,r){return e==null||typeof e!="object"||Array.isArray(e)?!1:r==="input"||!e.type||typeof e.type!="string"?!0:"children"in e&&Array.isArray(e.children)?!1:r==="button"?Dn.has(e.type.toLowerCase()):!("value"in e)}function Rn(e,r,n,t){const s=fe(e,n);let i=-1,o;if(t!=null){if(typeof t=="number"){if(Number.isNaN(t))return;o=t}else typeof t=="boolean"?o=t:typeof t=="string"?s.spaceSeparated?o=I(t):s.commaSeparated?o=G(t):s.commaOrSpaceSeparated?o=I(G(t).join(" ")):o=ne(s,s.property,t):Array.isArray(t)?o=t.concat():o=s.property==="style"?Tn(t):String(t);if(Array.isArray(o)){const a=[];for(;++i<o.length;){const c=ne(s,s.property,o[i]);a[i]=c}o=a}if(s.property==="className"&&Array.isArray(r.className)){const a=o;o=r.className.concat(a)}r[s.property]=o}}function M(e,r){let n=-1;if(r!=null)if(typeof r=="string"||typeof r=="number")e.push({type:"text",value:String(r)});else if(Array.isArray(r))for(;++n<r.length;)M(e,r[n]);else if(typeof r=="object"&&"type"in r)r.type==="root"?M(e,r.children):e.push(r);else throw new Error("Expected node, nodes, or string, got `"+r+"`")}function ne(e,r,n){if(typeof n=="string"){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(n===""||$(n)===$(r)))return!0}return n}function Tn(e){const r=[];let n;for(n in e)O.call(e,n)&&r.push([n,e[n]].join(": "));return r.join("; ")}function On(e){const r={};let n=-1;for(;++n<e.length;)r[e[n].toLowerCase()]=e[n];return r}const Mn=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],Pn=Se(pe,"div"),Fn=Se(j,"g",Mn),R={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg"};function jn(e,r){return Ee(e,{})||{type:"root",children:[]}}function Ee(e,r){const n=Un(e,r);return n&&r.afterTransform&&r.afterTransform(e,n),n}function Un(e,r){switch(e.nodeType){case 1:return In(e,r);case 3:return Hn(e);case 8:return qn(e);case 9:return re(e,r);case 10:return Bn();case 11:return re(e,r);default:return}}function re(e,r){return{type:"root",children:Ae(e,r)}}function Bn(){return{type:"doctype"}}function Hn(e){return{type:"text",value:e.nodeValue||""}}function qn(e){return{type:"comment",value:e.nodeValue||""}}function In(e,r){const n=e.namespaceURI,t=n===R.svg?Fn:Pn,s=n===R.html?e.tagName.toLowerCase():e.tagName,i=n===R.html&&s==="template"?e.content:e,o=e.getAttributeNames(),a={};let c=-1;for(;++c<o.length;)a[o[c]]=e.getAttribute(o[c])||"";return t(s,a,Ae(i,r))}function Ae(e,r){const n=e.childNodes,t=[];let s=-1;for(;++s<n.length;){const i=Ee(n[s],r);i!==void 0&&t.push(i)}return t}new DOMParser;function Gn(e,r){const n=$n(e);return jn(n)}function $n(e){const r=document.createElement("template");return r.innerHTML=e,r.content}const se=function(e,r,n){const t=Ve(n);if(!e||!e.type||!e.children)throw new Error("Expected parent node");if(typeof r=="number"){if(r<0||r===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if(r=e.children.indexOf(r),r<0)throw new Error("Expected child node or index");for(;++r<e.children.length;)if(t(e.children[r],r,e))return e.children[r]},oe=/\n/g,ae=/[\t ]+/g,P=L("br"),ie=L(Jn),Kn=L("p"),ce=L("tr"),Wn=L(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",Xn,Zn]),Le=L(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function zn(e,r){const n=r||{},t="children"in e?e.children:[],s=Le(e),i=Re(e,{whitespace:n.whitespace||"normal"}),o=[];(e.type==="text"||e.type==="comment")&&o.push(...ve(e,{breakBefore:!0,breakAfter:!0}));let a=-1;for(;++a<t.length;)o.push(...De(t[a],e,{whitespace:i,breakBefore:a?void 0:s,breakAfter:a<t.length-1?P(t[a+1]):s}));const c=[];let l;for(a=-1;++a<o.length;){const u=o[a];typeof u=="number"?l!==void 0&&u>l&&(l=u):u&&(l!==void 0&&l>-1&&c.push(`
`.repeat(l)||" "),l=-1,c.push(u))}return c.join("")}function De(e,r,n){return e.type==="element"?Vn(e,r,n):e.type==="text"?n.whitespace==="normal"?ve(e,n):Yn(e):[]}function Vn(e,r,n){const t=Re(e,n),s=e.children||[];let i=-1,o=[];if(Wn(e))return o;let a,c;for(P(e)||ce(e)&&se(r,e,ce)?c=`
`:Kn(e)?(a=2,c=2):Le(e)&&(a=1,c=1);++i<s.length;)o=o.concat(De(s[i],e,{whitespace:t,breakBefore:i?void 0:a,breakAfter:i<s.length-1?P(s[i+1]):c}));return ie(e)&&se(r,e,ie)&&o.push("	"),a&&o.unshift(a),c&&o.push(c),o}function ve(e,r){const n=String(e.value),t=[],s=[];let i=0;for(;i<=n.length;){oe.lastIndex=i;const c=oe.exec(n),l=c&&"index"in c?c.index:n.length;t.push(Qn(n.slice(i,l).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),i===0?r.breakBefore:!0,l===n.length?r.breakAfter:!0)),i=l+1}let o=-1,a;for(;++o<t.length;)t[o].charCodeAt(t[o].length-1)===8203||o<t.length-1&&t[o+1].charCodeAt(0)===8203?(s.push(t[o]),a=void 0):t[o]?(typeof a=="number"&&s.push(a),s.push(t[o]),a=0):(o===0||o===t.length-1)&&s.push(0);return s}function Yn(e){return[String(e.value)]}function Qn(e,r,n){const t=[];let s=0,i;for(;s<e.length;){ae.lastIndex=s;const o=ae.exec(e);i=o?o.index:e.length,!s&&!i&&o&&!r&&t.push(""),s!==i&&t.push(e.slice(s,i)),s=o?i+o[0].length:i}return s!==i&&!n&&t.push(""),t.join(" ")}function Re(e,r){if(e.type==="element"){const n=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return n.wrap?"pre-wrap":"pre";case"td":case"th":return n.noWrap?"nowrap":r.whitespace;case"textarea":return"pre-wrap"}}return r.whitespace}function Xn(e){return!!(e.properties||{}).hidden}function Jn(e){return e.tagName==="td"||e.tagName==="th"}function Zn(e){return e.tagName==="dialog"&&!(e.properties||{}).open}const er={},tr=[];function Te(e){const r=e||er;return function(n,t){Ye(n,"element",function(s,i){const o=Array.isArray(s.properties.className)?s.properties.className:tr,a=o.includes("language-math"),c=o.includes("math-display"),l=o.includes("math-inline");let u=c;if(!a&&!c&&!l)return;let p=i[i.length-1],w=s;if(s.tagName==="code"&&a&&p&&p.type==="element"&&p.tagName==="pre"&&(w=p,p=i[i.length-2],u=!0),!p)return;const m=zn(w,{whitespace:"pre"});let h;try{h=z.renderToString(m,{...r,displayMode:u,throwOnError:!0})}catch(y){const x=y,C=x.name.toLowerCase();t.message("Could not render math with KaTeX",{ancestors:[...i,s],cause:x,place:s.position,ruleId:C,source:"rehype-katex"}),C==="parseerror"?h=z.renderToString(m,{...r,displayMode:u,strict:"ignore",throwOnError:!1}):h=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(r.errorColor||"#cc0000"),title:String(y)},children:[{type:"text",value:m}]}]}typeof h=="string"&&(h=Gn(h).children);const g=p.children.indexOf(w);return p.children.splice(g,1,...h),me})}}function nr(e){Dt(e,[/\r?\n|\r/g,rr])}function rr(){return{type:"break"}}function sr(){return function(e){nr(e)}}const Oe="sandbox:";function Rr({messageId:e,clientThreadId:r,href:n,...t}){const s=Ct(),[i,o]=b.useState(!1),a=n.substring(Oe.length),c=at(r),l=kt(),u=it(),p=b.useCallback(g=>{const y=document.createElement("a");y.href=g,y.click(),o(!1)},[]),w=b.useCallback(g=>{o(!1),u.danger(g,{toastId:"file_download_failed"})},[u]),m=ar(i,e,c,a,w,p).data,h=b.useCallback(async g=>{r!==void 0&&(g.preventDefault(),(m===void 0||m?.status!=="success")&&s.invalidateQueries({queryKey:Me(e,a)}),m?.status==="success"&&m?.download_url?p(m.download_url):o(!0))},[r,m,s,e,a,p]);return d.jsx(ct,{closeOnOutsideClick:!1,label:d.jsxs("span",{className:"flex items-center gap-1",children:[i?l.formatMessage(le.startingDownload):l.formatMessage(le.downloadFile),i&&d.jsx(lt,{})]}),side:"top",children:d.jsx("a",{...t,className:"cursor-pointer",onClick:g=>!i&&h(g)})})}async function or(e,r,n){const t=await ft.safeGet("/conversation/{conversation_id}/interpreter/download",{parameters:{path:{conversation_id:r},query:{message_id:e,sandbox_path:n}}});if(t.status===pt.Success)return t;throw new be("Could not download file from advanced data analysis","error_code"in t?t.error_code:"unknown_error")}function ar(e,r,n,t,s,i){const o=ut();return Et({queryKey:Me(r,t),queryFn:()=>or(r,n,t).then(a=>(a?.status==="success"&&i(a.download_url),a)).catch(a=>{let c=o("default_download_link_error",{fileName:t});throw a instanceof be&&a.code!=null&&(c=o(a.code)),s?.(c),a}),enabled:!!(e&&r&&n&&t)})}function Me(e,r){return["downloadSandboxLink",e,r]}const le=St({downloadFile:{id:"SandboxDownload.downloadFile",defaultMessage:"Download file"},startingDownload:{id:"SandboxDownload.startingDownload",defaultMessage:"Starting download"}}),ir="f",Tr="dr",Pe=(e,r,n=!1)=>{const t=b.useRef(!1);b.useEffect(()=>{t.current||(t.current=!0,E.count(A.DEFAULT,"clickable_follow_up_text_shown"),n&&E.count(A.DEFAULT,"clickable_follow_up_deep_research_text_shown"),N.logEventWithStatsig("Clickable Follow Up Text Shown","chatgpt_clickable_follow_up_text_shown",{...U({clientThreadId:e,messageId:r})}))},[e,r,n])},Fe=({messageId:e,clientThreadId:r,text:n})=>{const t=de(r),s=mt.useStore(),i=_e(r);Pe(r,e,!1);const o=b.useCallback(a=>{a.preventDefault(),E.count(A.DEFAULT,"clickable_follow_up_text_clicked"),N.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",U({clientThreadId:r,messageId:e}));const c=s.getActiveSystemHintType();t({sourceEvent:a,promptMessage:gt(n.toLowerCase(),{suggestion_type:ye.Reply}),completionMetadata:{systemHints:c?[c]:[],conversationMode:i??{kind:dt.PrimaryAssistant}}})},[r,i,e,s,t,n]);return d.jsx("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:o,children:n})},cr=({messageId:e,clientThreadId:r,text:n})=>d.jsx(Fe,{messageId:e,clientThreadId:r,text:n}),Or=B.memo(cr),lr=({messageId:e,clientThreadId:r,text:n})=>{const t=ht(),{setThreadSystemHintMode:s}=yt(),i=!!bt(),o=de(r),a=_e(r);Pe(r,e,!0);const c=b.useCallback(l=>{l.preventDefault(),E.count(A.DEFAULT,"clickable_follow_up_text_clicked"),E.count(A.DEFAULT,"clickable_follow_up_deep_research_text_clicked"),N.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",U({clientThreadId:r,messageId:e}));const u={clientThreadId:r};s(_t.Research,!0,u);{const p=wt(t);p.focus(),Nt(p,n)}},[r,e,n,t,s,a,o]);return i?d.jsx(Fe,{messageId:e,clientThreadId:r,text:n}):d.jsxs("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:c,children:[d.jsx(Qe,{className:"icon me-1 inline-block"}),n]})},ur=({messageId:e,clientThreadId:r,text:n})=>d.jsx(lr,{messageId:e,clientThreadId:r,text:n}),Mr=B.memo(ur);function fr(){return e=>{_(e,{tagName:"table"},r=>{const n=r.children.find(s=>k(s,"thead"))?.children.find(s=>k(s,"tr"))?.children.filter(s=>k(s,"th"))??[],t=r.children.find(s=>k(s,"tbody"))?.children.filter(s=>k(s,"tr"))?.map(s=>s.children.filter(i=>k(i,"td")))??[];for(let s=0;s<n.length;s++){const i=n[s];let o=ue(i);for(let c=0;c<t.length;c++)o=Math.max(o,ue(t[c]?.[s]));const a=o>160?"xl":o>100?"lg":o>40?"md":"sm";i.properties["data-col-size"]=a;for(let c=0;c<t.length;c++)t[c]?.[s]&&(t[c][s].properties["data-col-size"]=a)}})}}function k(e,r){return e.type==="element"&&e.tagName===r}function ue(e){let r=0;return e&&_(e,"text",n=>{r+=n.value.length}),r}const pr=new Set([Ft,ir]),Pr=e=>e.startsWith(Oe)||pr.has(e)?e:Je(e);function mr(){return e=>{_(e,"list",r=>{for(const n of r.children)n.spread=!0})}}function Fr(e){return r=>{_(r,n=>{Object.defineProperties(n,{markdownSource:{get(){try{return e.slice(this.position.start.offset,this.position.end.offset)}catch{return""}}}})})}}const je=[vt,sr,mr,[Rt,{singleDollarTextMath:!1}],Tt,Ot,Mt,...K?[K]:[],At,dr,hr];function dr(){return e=>{_(e,"textDirective",r=>{r.name!==we&&(r.type="text",r.value=`:${r.name}`)})}}const gr=/\u200b/g;function hr(){return e=>{_(e,"text",r=>{r.value=r.value.replace(gr,"")})}}function yr(){return e=>{const r=e.position?.end.offset;_(e,"element",(n,t)=>{const{position:s}=n;if(!s)return;const{start:i,end:o}=s,a=i.offset,c=o.offset;n.properties??={},a!=null&&(n.properties["data-start"]=a),c!=null&&(n.properties["data-end"]=c,r===c&&(n.properties["data-is-last-node"]=""),t===e.children.length-1&&(n.properties["data-is-only-node"]=""))})}}const jr=[Te,yr,fr,[Xe,{target:"_new",rel:"noopener noreferrer"}],ge],br=[[Te,{output:"mathml"}],ge];function _r(e,r){const n=xt(e,r);return Ue(n,r)}function Ue(e,r){const n=T().use(he).use(je).use([[xr,r??[]]]).use(Lt,{rule:"-",tightDefinitions:!0,handlers:{break:()=>`
`,link:wr}}),t=T().use(Ze).use(br).use(An),s=n.runSync(n.parse(e)),i=n.stringify(s),o=t.stringify(t.runSync(s));return{"text/plain":i,"text/html":o}}const wr=(e,r,n,t)=>{const s=n.createTracker(t),i=n.enter("link"),o=n.enter("label");let a=s.move("[");return a+=s.move(n.containerPhrasing(e,{before:a,after:"](",...s.current()})),a+=s.move("]("),o(),a+=s.move(e.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,Nr)),e.title&&(a+=s.move(" "+JSON.stringify(e.title))),a+=s.move(")"),i(),a};function Nr(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}function xr(e){return r=>{const n={},t=(s,i)=>{switch(i.type){case"grouped_webpages":{const o=[];for(const a of i.items)if(a.url&&a.title){let c=n[a.url];c||(c=n[a.url]={type:"definition",identifier:String(Object.keys(n).length+1),url:a.url,title:a.title}),o.push({type:"linkReference",referenceType:"shortcut",identifier:c.identifier,children:[{type:"text",value:a.attribution??tt(a.url)}]})}return o.length===0?[]:[{type:"text",value:"("},...o.flatMap((a,c,l)=>c<l.length-1?[a,{type:"text",value:", "}]:[a]),{type:"text",value:")"}]}case"title_citation":case"location_search":case"time":case"image_v2":case"nav_list":case"file_navlist":case"file":case"grouped_webpages_model_predicted_fallback":case"tldr":case"navigation":case"stock":case"calculator":case"python":case"container":case"code_execution":case"forecast":case"businesses_map":case"video":case"entity":case"sources_footnote":case"sports_standings":case"sports_schedule":case"attribution":case"webpage_extended":case"checkout_confirmation":case"image_inline":case"image_group":case"product_entity":case"products":case"alt_text":case"product_reviews":case"product_rationale":if(i.alt){const o=T().use(he).use(je).parse(i.alt);if(s.type!=="textDirective")return o.children;const a=o.children[0];if(a.type==="paragraph")return a.children}return[];case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[]}};_(r,et,(s,i,o)=>{if(o==null||i==null)return;const a=Cr(s,e),c=a?t(s,a)??[s]:[];return o.children.splice(i,1,...c),[me,i+c.length]}),r.children.push(...Object.values(n))}}function Cr(e,r){if(e.name===we){const n=e.attributes?.index;if(n)return r[parseInt(n,10)]}}const Ur=Object.freeze(Object.defineProperty({__proto__:null,markdownToClipboardContent:Ue,messageTextToClipboardContent:_r},Symbol.toStringTag,{value:"Module"}));export{ir as C,Ft as I,Pt as M,je as R,Oe as S,jr as a,Rr as b,vr as c,Or as d,Tr as e,Mr as f,Ur as g,Ue as m,Fr as r,Pr as u};
//# sourceMappingURL=k9cs1paiwp280pwy.js.map
