import{r as p,e as te,j as e,d as ye,M as m,L as ce,l as oa,u as Ee,a as jt,b as ra,h as ia,an as la}from"./lu2xqwqmjc95q6j6.js";import{P as C,aJ as fe,cX as g,F as le,B as de,rG as ca,a as Me,c as Ie,d as G,rH as dt,C as Ce,c0 as da,bz as Mt,rI as Ae,bP as Et,bQ as Tt,bR as Dt,bS as Nt,bV as At,ca as ua,bg as Ue,b5 as ma,cM as pa,lJ as ut,aj as Ct,lL as ga,H as st,L as nt,bT as ot,bU as fa,G as Fe,d_ as ve,cd as ha,D as ya,rJ as Pa,jc as ke,jA as je,rK as _a,rL as It,rM as Ft,rN as Ut,c6 as ge,rO as Ke,fa as re,rP as Ma,r1 as Ca,r2 as Sa,R as Ot,b8 as Qe,q as xa,bO as ba,im as wa,aZ as ka,rQ as va,rR as ja,iR as Ea,V as Rt,aM as Ta,d7 as Da,rS as Na,bl as Aa,bW as Ia,c$ as Fa,rT as Ua,io as Oa,s as Ra,N as La}from"./hml6mmd5fyx85si7.js";import{S as Ga}from"./dy6grwmx1xskr6sg.js";import{P as Ba,pw as Oe,px as xe,aa as rt,a9 as it,ab as lt,py as he,pz as Ya,o4 as Ha,pA as za,pB as Lt,pC as ue,pD as J,Q as Wa,pE as Ve,kx as Gt,pF as Be,pG as Ye,a8 as $a,d9 as Va,pH as qa,df as Ka,dg as Qa,dh as Ja,dt as Pe,du as _e,pI as me,R as Za,oA as Xa,pJ as es,pK as ts,pm as as}from"./rseqzngxzbdt1oxg.js";import{u as mt}from"./imrgbs6xko452vv3.js";import{u as pt}from"./i4sx5w9qnb2pqgar.js";import{u as Bt}from"./n39npmecfg2nmjo7.js";import{C as St}from"./bhajl6jak2hedqsu.js";import{a as ss,b as ns,M as os}from"./fibktxptqydbr54o.js";const rs=t=>p.createElement("svg",{width:21,height:20,viewBox:"0 0 21 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},p.createElement("path",{d:"M10.2441 10.7759C12.7597 10.8965 14.8838 12.8648 14.8838 15.0601C14.8838 15.4273 14.586 15.7251 14.2188 15.7251H5.78125C5.41399 15.7251 5.11623 15.4273 5.11621 15.0601C5.11621 12.7959 7.37906 10.77 10 10.77L10.2441 10.7759Z"}),p.createElement("path",{d:"M0 14.436C0 11.5616 3.13043 10.5652 5.2998 11.4478C4.37179 12.4185 3.78619 13.6736 3.78613 15.0601L3.78809 15.1011H0.665039C0.298096 15.1011 0.000527744 14.8029 0 14.436Z"}),p.createElement("path",{d:"M14.7988 11.5532C16.969 10.4969 20.3301 11.4561 20.3301 14.436C20.3295 14.8029 20.032 15.1011 19.665 15.1011H16.2119L16.2139 15.0601C16.2138 13.7223 15.6689 12.5079 14.7988 11.5532Z"}),p.createElement("path",{d:"M3.4248 5.00146C4.85516 5.00146 6.01454 6.16098 6.01465 7.59131C6.01454 9.02164 4.85516 10.1812 3.4248 10.1812C1.99454 10.181 0.835068 9.02157 0.834961 7.59131C0.835066 6.16105 1.99454 5.00157 3.4248 5.00146Z"}),p.createElement("path",{d:"M16.5703 5.00146C18.0006 5.00157 19.1601 6.16105 19.1602 7.59131C19.16 9.02157 18.0006 10.181 16.5703 10.1812C15.14 10.1812 13.9806 9.02164 13.9805 7.59131C13.9806 6.16098 15.14 5.00146 16.5703 5.00146Z"}),p.createElement("path",{d:"M10 4.27002C11.6099 4.27002 12.915 5.57515 12.915 7.18506C12.915 8.79497 11.6099 10.1001 10 10.1001C8.39009 10.1001 7.08496 8.79497 7.08496 7.18506C7.08496 5.57515 8.39009 4.27002 10 4.27002Z"}));function is({value:t,onChange:s}){const a=te();return e.jsx(Ga,{value:t,onChange:s,ariaLabel:a.formatMessage(De.toggleArialabel),leftItem:{ariaLabel:a.formatMessage(De.togglePersonalArialabel),label:a.formatMessage(De.togglePersonalLabel),value:"personal"},rightItem:{ariaLabel:a.formatMessage(De.toggleBusinessArialabel),label:a.formatMessage(De.toggleBusinessLabel),value:"business"}})}const De=ye({toggleArialabel:{id:"U4v2Gf",defaultMessage:"Toggle for switching between Personal and Business plans"},togglePersonalArialabel:{id:"6Wikht",defaultMessage:"Toggle for switching to Personal plans"},toggleBusinessArialabel:{id:"uzlEV0",defaultMessage:"Toggle for switching to Business plans"},togglePersonalLabel:{id:"cGDsaD",defaultMessage:"Personal"},toggleBusinessLabel:{id:"sgisa2",defaultMessage:"Business"}}),Je=()=>{C.logEvent("Account Portal: Click Get Help")};function ls(t){if(ca(t))return"secondary";switch(t){case g.FREE:return"green";case g.GO:return"green";case g.PLUS:return"green";case g.TEAM:return"primary";case g.PRO:return"primary"}}function ct({isCurrentPlan:t=!1,planType:s,disabled:a,loading:n=!1,onClick:o,children:c,testId:l,activeColor:u,...d}){return e.jsx(de,{fullWidth:!0,size:"large",color:t?"secondary":u||ls(s),disabled:a,loading:n,onClick:o,"data-testid":l,className:a?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary border-none font-semibold":"font-semibold",...d,children:c})}function gt(t,s){const[a,n]=p.useState(!1);p.useEffect(()=>{if(!a){n(!0);return}t?C.logEventWithStatsig("Email Verify Popup Shown","chatgpt_email_verify_popup_shown",s):C.logEventWithStatsig("Email Verify Popup Hidden","chatgpt_email_verify_popup_hidden",s)},[t])}function Yt({ctx:t,shouldLogExposure:s}){return fe(t,"2273762597",{disableExposureLog:!s})}function cs({ctx:t,shouldLogExposure:s}){return Yt({ctx:t,shouldLogExposure:s}).get("web_plus_intro_offer_coupon","none")}function ds({ctx:t,shouldLogExposure:s}){return Yt({ctx:t,shouldLogExposure:s}).get("is_plus_intro_offer_enabled",!1)}function We({ctx:t,planType:s}){const n=fe(t,"978971143").get("cta_type","default");if(s===g.PLUS)switch(n){case"long_ctas":return le.longCtaPlus;case"upgrade_to_x":return le.upgradeToPlus;case"join_x":return le.joinPlus;case"unlock_x":return le.unlockPlus;default:return le.getPlus}else switch(n){case"long_ctas":return le.longCtaPro;case"upgrade_to_x":return le.upgradeToPro;case"join_x":return le.joinPro;case"unlock_x":return le.unlockPro;default:return le.getPro}}const us=({billingDetails:t,isWebRedesign:s,className:a,useComparisonSpacing:n})=>{const o=Me(),c=Ie(o,"1627380539"),l=Ba({isWebRedesign:s,inGPT5Gate:c});return e.jsx(Oe,{planType:g.FREE,pricingPlan:l,className:a,useComparisonSpacing:n,callToActionButton:e.jsx(de,{color:"secondary",disabled:!0,size:"large",className:G(s?"btn-secondary disabled:bg-token-bg-primary w-[100%]":"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary w-[100%] border-none font-semibold"),children:e.jsx(m,{...l.callToAction.inactive})}),additionalLinks:[e.jsx(m,{...ms.haveExistingPlan,values:{link:u=>e.jsx(ce,{target:"_blank",to:dt,onClick:Je,className:G("underline",s&&"font-medium"),children:u},"row-plus-plan-help-link")}},"existing-plan-help")],billingDetails:t,isWebRedesign:s})},ms=ye({haveExistingPlan:{id:"FreeColumn.haveExistingPlan",defaultMessage:"Have an existing plan? <link>See billing help</link>"}});function ft({isOpen:t,onClose:s,onContinue:a,analyticsParams:n}){p.useEffect(()=>{t&&C.logEventWithStatsig("Mobile Subscription Warning Modal Shown","chatgpt_mobile_subscription_warning_modal_shown",n)},[n,t]);const o=()=>{C.logEventWithStatsig("Mobile Subscription Warning Modal Continue Clicked","chatgpt_mobile_subscription_warning_modal_continue_clicked",n),a()},c=()=>{C.logEventWithStatsig("Mobile Subscription Warning Modal Close Clicked","chatgpt_mobile_subscription_warning_modal_close_clicked",n),s()};return e.jsx(Ce,{testId:"modal-mobile-subscription-warning",isOpen:t,onClose:c,type:"warning",icon:da,title:e.jsx(m,{...He.checkSubscriptionHeader}),primaryButton:e.jsx(Mt.Button,{title:He.dismissModal.defaultMessage,color:"primary",onClick:c}),secondaryButton:e.jsx(Mt.Button,{title:He.continueToNextStep.defaultMessage,color:"secondary",onClick:o}),children:e.jsx("span",{className:"gap-2 text-gray-600",children:He.checkSubscriptionBody.defaultMessage})})}const He=ye({checkSubscriptionHeader:{id:"mobileSubscriptionWarningModal.checkSubscriptionHeader",defaultMessage:"Check your App Store subscription"},checkSubscriptionBody:{id:"mobileSubscriptionWarningModal.checkSubscriptionBody",defaultMessage:"Your subscription through the Apple App Store is currently on pause due to a payment issue. Please resolve that issue to resume using ChatGPT Plus and avoid duplicate charges."},dismissModal:{id:"mobileSubscriptionWarningModal.dismissModal",defaultMessage:"Cancel"},continueToNextStep:{id:"mobileSubscriptionWarningModal.continueToNextStep",defaultMessage:"I understand, continue anyways"}});function xt(t,s,a,n){let o,c;n===Et?(o=rt,c=Tt):n===Dt?(o=it,c=Nt):(o=lt,c=At);const l=o*s;let u;if("percentage"in a)u=l*(1-a.percentage/100);else if("value"in a)u=l-a.value;else throw new Error("Invalid discount type");return{formattedDiscountedCost:t.formatNumber(u,{style:"currency",currency:n,minimumFractionDigits:0,maximumFractionDigits:2}),currencySymbol:c}}function Ht(t,s,a,n){const o={...s};let c;if(n&&(n.period==="year"?n.num_periods===1?c=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForSingleYear",defaultMessage:"for the first year"}):c=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForPluralYears",defaultMessage:"for the first {num_years} years"},{num_years:n.num_periods}):n.num_periods===1?c=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForSingleMonth",defaultMessage:"for the first month"}):c=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForPluralMonths",defaultMessage:"for the first {num_months} months"},{num_months:n.num_periods})),o.costDuration={id:"promoCostDuration",defaultMessage:c,description:"Cost duration for promo plan"},"percentage"in a||"discount_type"in a&&a.discount_type===Ae.PERCENTAGE){const l=("percentage"in a?a.percentage:a.amount)/100;o.costInDollars={id:"discountedCost",defaultMessage:xe((1-l)*lt).toString()},o.costInEuros={id:"discountedCostEuros",defaultMessage:xe((1-l)*rt).toString()},o.costInPounds={id:"discountedCostPounds",defaultMessage:xe((1-l)*it).toString()}}else if("value"in a||a.discount_type===Ae.FIXED){const l="value"in a?a.value:a.amount;o.costInDollars={id:"discountedCost",defaultMessage:xe(lt-l).toString()},o.costInEuros={id:"discountedCostEuros",defaultMessage:xe(rt-l).toString()},o.costInPounds={id:"discountedCostPounds",defaultMessage:xe(it-l).toString()}}return o}const Ze=ua(t=>({recentlyDowngraded:!1,recentlyUpgraded:!1,recentlyCanceled:!1,setRecentlyDowngraded:s=>t({recentlyDowngraded:s}),setRecentlyUpgraded:s=>t({recentlyUpgraded:s}),setRecentlyCanceled:s=>t({recentlyCanceled:s})}));function zt(t){switch(t){case g.FREE:return"chatgptfreeplan";case g.GO:return"chatgptgoplan";case g.PLUS:return"chatgptplusplan";case g.PRO:return"chatgptpro";case g.TEAM:return"chatgptteamplan";default:throw new Error(`Invalid plan type: ${t}`)}}function ht({isOpen:t,onClose:s,accountId:a,initialPlanType:n,updatedPlanType:o,billingDetails:c}){const l=te(),u=Ue(),d=ma(),[r,P]=p.useState(!1),f=n===o,i=he(n)<he(o),w=zt(o);p.useEffect(()=>{C.logTogglePlanManagementModal({isOpen:!0})},[]);const k=()=>{C.logTogglePlanManagementModal({isOpen:!1}),s()},b=Ya(a),x=Ha(a),I=za(a),{data:v,isError:j,isLoading:E}=Lt(a,void 0,w);!f&&j&&(d?.planType===g.TEAM?u.warning(l.formatMessage({id:"planManagement.errorUpgradingTeam",defaultMessage:"Updates to {capitalizedUpdatedPlanType} aren't yet supported for users with Team subscriptions"},{capitalizedUpdatedPlanType:ue(o.toLowerCase())}),{hasCloseButton:!0}):u.warning(l.formatMessage({id:"planManagement.errorFetchingPreview",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),s());const F=z=>{const D=ut(new Date,z);return new Intl.DateTimeFormat(l.locale,{year:"numeric",month:"short",day:"numeric"}).format(D)},h=d?.getDaysUntilPlanRenews();let S=h?F(h):"";const U=d?.getDaysUntilSubscriptionCancelAt();h&&U&&U>h&&(S=F(U));const{recentlyCanceled:_,setRecentlyUpgraded:O,setRecentlyDowngraded:K}=Ze(),T=d?.willRenewSubscription()||_,[W,$]=p.useState(!1),V=oa();if(!d)return null;const ae=async z=>{P(!0);try{if(f)await x.mutateAsync(a),u.success(S===""?l.formatMessage({id:"planManagement.successfullyRenewedSubscription2",defaultMessage:"Your subscription has been renewed."}):l.formatMessage({id:"planManagement.successfullyRenewedSubscription",defaultMessage:"Your subscription has been renewed. Your subscription will auto-renew on {renewalDate}."},{renewalDate:S}),{hasCloseButton:!0}),C.logEvent("Renew Plan Success",{planType:z}),Ct.logEvent("chatgpt_renew_plan_success",null,{planType:z});else{if(T||(await x.mutateAsync(a),$(!0)),await b.mutateAsync({accountId:a,updatedPlan:w,updatedPriceInterval:void 0,updatedSeats:void 0}),z!==o){const N=i?"Upgrade Plan Success":"Downgrade Plan Success",H=i?"chatgpt_upgrade_plan_success":"chatgpt_downgrade_plan_success";C.logEvent(N,{fromPlan:z,toPlan:o}),Ct.logEvent(H,null,{fromPlan:z,toPlan:o}),i?O(!0):K(!0)}const se=v?.renewal_date?new Date(v?.renewal_date).toLocaleDateString(l.locale,{year:"numeric",month:"long",day:"numeric"}):"N/A",X=i?l.formatMessage({id:"planManagement.successfullyUpdatedSubscription",defaultMessage:"You're now subscribed to ChatGPT {capitalizedUpdatedPlanType}"},{capitalizedUpdatedPlanType:ue(o.toLowerCase())}):l.formatMessage({id:"planManagement.updatedSubscriptionToPlus",defaultMessage:"Your subscription has been updated. Your subscription will change to {capitalizedUpdatedPlanType} on {renewalDateFormatted}."},{renewalDateFormatted:se,capitalizedUpdatedPlanType:ue(o.toLowerCase())});localStorage.setItem(`subscriptionUpdateMessage_${d.id}`,X)}V.invalidateQueries(ga());const D=st.getItem(nt.CheckoutFrom);D&&St[D]&&(st.removeItem(nt.CheckoutFrom),window.location.href=St[D]),s()}catch(D){D?.detail?.error_type==="card_declined"?u.warning(l.formatMessage({id:"planManagement.cardDeclinedError",defaultMessage:"Payment error. Your card may be invalid or authentication may be needed."}),{hasCloseButton:!0}):u.warning(l.formatMessage({id:"planManagement.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),W&&await I.mutateAsync(a),s()}finally{P(!1)}},{goCost:Z,plusCost:q,proCost:Q,currencySymbol:R}=Cs(c.currency);let B=q;return o===g.GO?B=Z:o===g.PRO?B=Q:o!==g.PLUS&&pa.error(`Invalid target plan type: ${o}`),e.jsx(Ce,{testId:"modal-plan-management",type:"success",isOpen:t,onClose:k,size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:l.formatMessage({id:"planManagementModal.title",defaultMessage:"Confirm changes"}),removePopoverStyling:!0,children:E?e.jsx(Wt,{}):f&&d?e.jsx(Ms,{account:d,renewalDate:S,handleUpdate:()=>ae(n),isUpdating:r,onClose:k,targetPlanCost:B,currencySymbol:R}):j||!v?null:i?e.jsx(gs,{accountId:a,handleUpdate:()=>ae(n),isUpdating:r,onClose:k,initialPlanType:n,updatedPlanType:o,currencySymbol:R}):e.jsx(_s,{renewalDate:v.renewal_date,handleUpdate:()=>ae(n),isUpdating:r,onClose:k,targetPlanCost:B,currentPlanType:n,updatedPlanType:o,currencySymbol:R})})}function Wt(){return e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(Fe,{})})}function ps({adjustmentMessage:t,proratedCreditMessage:s,proratedCreditInfoMessage:a}){return e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:t}),e.jsx("span",{className:"font-semibold text-green-600",children:s})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:a})]})}function gs({accountId:t,handleUpdate:s,isUpdating:a,onClose:n,currencySymbol:o,updatedPlanType:c,initialPlanType:l}){const u=te(),{data:d,isError:r,isLoading:P}=Lt(t,void 0,zt(c));if(P)return e.jsx(Wt,{});if(r||!d)return null;const f=fs({data:d,intl:u,currencySymbol:o,currentPlanType:l});return e.jsxs("div",{className:"p-6",children:[e.jsx(hs,{data:d,currencySymbol:o,updatedPlanType:c}),f.filter(i=>i.value!==0).map((i,w)=>e.jsx(ps,{adjustmentMessage:i.adjustmentMessage,proratedCreditMessage:i.proratedCreditMessage,proratedCreditInfoMessage:i.proratedCreditInfoMessage},w)),e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(ys,{data:d,currencySymbol:o}),d.default_payment_method&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(Ps,{defaultPaymentMethod:d.default_payment_method})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(ve,{title:u.formatMessage({id:"planUpgradeModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:n}),e.jsx(ve,{title:u.formatMessage({id:"planUpgradeModal.payNow",defaultMessage:"Pay now"}),color:"primary",onClick:s,loading:a})]})]})}function fs({data:t,intl:s,currencySymbol:a,currentPlanType:n}){return[{adjustmentMessage:e.jsx(m,{id:"planUpgradeModal.adjustment",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(m,{id:"planUpgradeModal.proratedCredit",defaultMessage:"-{currencySign}{adjustment}",values:{currencySign:s.formatMessage(a.sign),adjustment:(-t.negative_line_item_total/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(m,{id:"planUpgradeModal.proratedCreditInfo",defaultMessage:"Prorated credit for the remainder of your {currentPlanType} subscription",values:{currentPlanType:n}}),value:t.negative_line_item_total},{adjustmentMessage:e.jsx(m,{id:"planUpgradeModal.discount",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(m,{id:"planUpgradeModal.discountAmount",defaultMessage:"-{currencySign}{discount}",values:{currencySign:s.formatMessage(a.sign),discount:(t.discount_amount/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(m,{id:"planUpgradeModal.discountInfo",defaultMessage:"Account discount applied"}),value:t.discount_amount},{adjustmentMessage:e.jsx(m,{id:"planUpgradeModal.credits",defaultMessage:"Adjustments"}),proratedCreditMessage:e.jsx(m,{id:"planUpgradeModal.creditsAmount",defaultMessage:"-{currencySign}{credits}",values:{currencySign:s.formatMessage(a.sign),credits:(t.applied_balance/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(m,{id:"planUpgradeModal.creditsInfo",defaultMessage:"Credits applied"}),value:t.applied_balance}]}function hs({data:t,currencySymbol:s,updatedPlanType:a}){const n=te();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(m,{id:"planUpgradeModal.subscription",defaultMessage:"ChatGPT {capitalizedUpdatedPlanType} subscription",values:{capitalizedUpdatedPlanType:ue(a.toLowerCase())}})}),e.jsx("span",{className:"font-semibold",children:e.jsx(m,{id:"planUpgradeModal.subscriptionCost",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:n.formatMessage(s.sign),totalCost:(t.positive_line_item_total/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(m,{id:"planUpgradeModal.billingCycle",defaultMessage:"Billed monthly, starting today"})})]})}function ys({data:t,currencySymbol:s}){const a=te();return e.jsxs(e.Fragment,{children:[t.amount_due.tax_amount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(m,{id:"planUpgradeModal.subTotal",defaultMessage:"Subtotal"})}),e.jsx("span",{children:e.jsx(m,{id:"planUpgradeModal.subtotalPrice",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:a.formatMessage(s.sign),totalCost:(t.amount_due.amount_excluding_tax/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsxs("span",{className:"font-semibold",children:[e.jsx(m,{id:"planUpgradeModal.tax",defaultMessage:"Tax"}),e.jsx("span",{className:"text-token-text-secondary font-normal",children:e.jsx(m,{id:"planUpgradeModal.taxPercent",defaultMessage:" {taxPercent}%",values:{taxPercent:(t.amount_due.tax_amount/t.amount_due.amount_excluding_tax*100).toFixed(0)}})})]}),e.jsx("span",{children:e.jsx(m,{id:"planUpgradeModal.taxAmount",defaultMessage:"{currencySign}{tax}",values:{currencySign:a.formatMessage(s.sign),tax:(t.amount_due.tax_amount/100).toFixed(2)}})})]})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(m,{id:"planUpgradeModal.totalDueToday",defaultMessage:"Total due today"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(m,{id:"planUpgradeModal.totalDueTodayAmount",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:a.formatMessage(s.sign),totalCost:(t.amount_due.amount/100).toFixed(2)}})})]})]})}function Ps({defaultPaymentMethod:t}){return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(m,{id:"planUpgradeModal.paymentMethod",defaultMessage:"Payment Method"})}),e.jsxs("span",{className:"text-token-text-secondary",children:[t.card_brand?.toUpperCase()," *",t.card_last4]})]})}function _s({renewalDate:t,handleUpdate:s,isUpdating:a,onClose:n,targetPlanCost:o,currentPlanType:c,currencySymbol:l,updatedPlanType:u}){const d=te(),r=t?new Date(t).toLocaleDateString(d.locale,{year:"numeric",month:"long",day:"numeric"}):"N/A";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(m,{id:"planDowngradeModal.currentSubscription",defaultMessage:"Your current {currentPlanType} subscription will remain active until {renewalDateFormatted}, when it will change to Plus.",values:{renewalDateFormatted:r,currentPlanType:ue(c.toLowerCase())}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 rounded-md p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(m,{id:"planDowngradeModal.newPlan",defaultMessage:"ChatGPT {capitalizedUpdatedPlanType}",values:{capitalizedUpdatedPlanType:ue(u.toLowerCase())}})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(m,{id:"planDowngradeModal.newPlanCost",defaultMessage:"{currencyCode} {currencySign}{planCost}/month",values:{currencyCode:d.formatMessage(l.code),currencySign:d.formatMessage(l.sign),planCost:d.formatMessage(o)}})})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(m,{id:"planDowngradeModal.billingStart",defaultMessage:"Billing will start on {renewalDateFormatted}",values:{renewalDateFormatted:r}})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(ve,{title:d.formatMessage({id:"planDowngradeModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:n}),e.jsx(ve,{title:d.formatMessage({id:"planDowngradeModal.confirm",defaultMessage:"Confirm"}),color:"primary",onClick:s,loading:a})]})]})})}function Ms({account:t,renewalDate:s,handleUpdate:a,isUpdating:n,onClose:o,targetPlanCost:c,currencySymbol:l}){const u=te(),d=t.data.subscriptionStatus.planType,r=ue(d.toLowerCase());return e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(m,{id:"planRenewalModal.currentSubscription",defaultMessage:"Your current {planName} subscription will auto-renew on {renewalDate}.",values:{planName:r,renewalDate:s}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 rounded-md p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(m,{id:"planRenewalModal.newPlan",defaultMessage:"ChatGPT {planName}",values:{planName:r}})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(m,{id:"planRenewalModal.newPlanCost",defaultMessage:"{currencyCode} {currencySign}{planCost}/month",values:{currencyCode:u.formatMessage(l.code),currencySign:u.formatMessage(l.sign),planCost:u.formatMessage(c)}})})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(m,{id:"planRenewalModal.billingStart",defaultMessage:"Billing will auto-renew on {renewalDate}",values:{renewalDate:s}})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(ve,{title:u.formatMessage({id:"planRenewalModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:o}),e.jsx(ve,{title:u.formatMessage({id:"planRenewalModal.confirm",defaultMessage:"Confirm"}),color:"primary",onClick:a,loading:n})]})]})}function Cs(t){return t===Et?{goCost:J.go.goCostInEuros,plusCost:J.plus.plusCostInEuros,proCost:J.pro.proCostInEuros,currencySymbol:Tt}:t===Dt?{goCost:J.go.goCostInPounds,plusCost:J.plus.plusCostInPounds,proCost:J.pro.proCostInPounds,currencySymbol:Nt}:t===ot?{goCost:J.go.goCostInINR,plusCost:J.plus.plusCostInINR,proCost:J.pro.proCostInINR,currencySymbol:fa}:{goCost:J.go.goCost,plusCost:J.plus.plusCost,proCost:J.pro.proCost,currencySymbol:At}}const be=g.PLUS,Ss=()=>Ee({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await Ot.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")});function $t(t,s){const a=t.data.subscriptionStatus.planType,n=t.getNextPlanType();let o=t.getDaysUntilPlanChanges(),c=n===g.PLUS&&a===g.PRO||n===g.GO&&[g.PRO,g.PLUS].includes(a);return s&&!c&&(o=t.getDaysUntilPlanRenews(),c=!0),{daysUntilPlanChanges:o,isDowngradeScheduled:c,nextPlanType:n}}function $e(t,s){const a=ut(new Date,t);return new Intl.DateTimeFormat(s,{year:"numeric",month:"short",day:"numeric"}).format(a)}function bt(t,s,a){let n;switch(t){case"month":n=Sa(new Date,s);break;case"year":n=Ca(new Date,s);break}return new Intl.DateTimeFormat(a,{year:"numeric",month:"short",day:"numeric"}).format(n)}function wt(t){return Ma.includes(t)?t:"USD"}function xs(t,s,a,n){if(t==="plus-10-for-3-months")switch(a.currency){case"USD":{const o={value:10,currency_code:wt(a.currency)};return{plan_name:ke.PLUS,title:"",summary:s.formatMessage(n?Be.headline:Ye.plusSummary),discount:o,duration:{num_periods:3,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null}}case"EUR":case"GBP":return{plan_name:ke.PLUS,title:"",summary:s.formatMessage(n?Be.headline:Ye.plusSummary),discount:{percentage:52.18},duration:{num_periods:3,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null};case"INR":return null}else if(t==="plus-10-for-12-mos")switch(a.currency){case"USD":{const o={value:10,currency_code:wt(a.currency)};return{plan_name:ke.PLUS,title:"",summary:s.formatMessage(n?Be.headline:Ye.plusSummary),discount:o,duration:{num_periods:12,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null}}case"EUR":case"GBP":return{plan_name:ke.PLUS,title:"",summary:s.formatMessage(n?Be.headline:Ye.plusSummary),discount:{percentage:52.18},duration:{num_periods:12,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null};case"INR":return null}return null}const bs=({analyticsParams:t,className:s,currentAccount:a,planLoading:n,isPromoLoading:o,onUpgradeButtonClick:c,setPlanLoading:l,plusPricingPlan:u=null,shouldShowAdditionalLinks:d=!0,billingDetails:r,promoCode:P=null,promoMetadata:f=null,onClose:i,disableForMobile:w=!1,type:k,isWebRedesign:b,useComparisonSpacing:x})=>{const{data:I}=ha(),{data:v,refetch:j}=Ee(Qe),{data:{value:E}={}}=Ss(),{trackSelectedPixels:F}=mt({key:g.PLUS}),h=a.features,S=Me(),U=!ya(S),_=te(),O=Ue(),K=Ie(S,"1627380539");let T=u||Wa({isWebRedesign:b,inGPT5Gate:K});const W=cs({ctx:S,shouldLogExposure:!1}),{data:$}=Bt(W);f==null&&$?.coupon===W&&$?.state==="eligible"&&ds({ctx:S,shouldLogExposure:!0})&&(f=xs(W,_,r,b),P=W);const V=p.useRef(!1),[ae,Z]=p.useState(!1),[q,Q]=p.useState(!1),[R,B]=p.useState(!1),{recentlyDowngraded:z}=Ze();let D=[];const se=a.isOrWasPaidCustomer(),X=a.hasPaidSubscription(),N=X&&a.isPlus(),H=X&&a.isPro(),y=a.getLastActiveSubscription(),L=fe(S,"3950229590"),{prepareCheckoutSession:ie,navigateToCheckout:ne}=pt(),pe=Pa(I),Xe=h.includes("disable_plus_upgrade_ui")&&!se,{daysUntilPlanChanges:yt,isDowngradeScheduled:qt,nextPlanType:Pt}=$t(a,z),ee=p.useMemo(()=>({...t,promoCode:P,planType:be,isUpgradeUiDisabled:Xe}),[t,P,Xe]),Kt=!!v?.email,Te=p.useRef(new Map),et=p.useRef(null);p.useEffect(()=>{if(!N&&L.get("enabled_prefetch_checkout_for_plus",!1)){const A={plan_name:ke.PLUS,billing_details:r,promo_code:P},Y=JSON.stringify(A);if(!Te.current.has(Y)){C.logEventWithStatsig("Account Pay: Prefetch Checkout Session","chatgpt_account_payment_modal_prefetch_checkout_session",ee),Te.current.clear();const oe=L.get("skip_sentinel_checkout",!1),Se=ie(A,{skipSentinelCheckout:oe});Te.current.set(Y,Se)}}},[ie,ee,r,P,h,N,L]);const Qt=()=>{const A={plan_name:ke.PLUS,billing_details:r,promo_code:P},Y=Te.current.get(JSON.stringify(A));if(Y)return C.logEventWithStatsig("Account Pay: Using Prefetched Checkout Session","chatgpt_account_payment_modal_using_prefetched_checkout_session",ee),Y;C.logEventWithStatsig("Account Pay: Click to Fetch Checkout Session","chatgpt_account_payment_modal_click_to_fetch_checkout_session",ee),Te.current.clear();const oe=L.get("skip_sentinel_checkout",!1);return ie(A,{skipSentinelCheckout:oe})},Jt=async({skipEmailCheck:A})=>{if(!Kt&&!A){B(!0);return}l(g.PLUS),C.logEvent("Account Pay: Payment Checkout Clicked",ee),re(S,"chatgpt_account_payment_modal_upgrade_button_click",be),et.current=Date.now();try{const Y=await Qt();let oe;et.current&&(oe=Date.now()-et.current),C.logEvent("Account Pay: Navigating to Payment Checkout",{...ee,url:Y.url??"",latency_ms:oe});const Se={url:String(Y.url??"")};oe!==void 0&&(Se.latency_ms=oe.toString()),re(S,"chatgpt_account_payment_modal_navigating_to_checkout",be,Se),await ne(Y)}catch{O.warning(_.formatMessage(M.paymentErrorWarning),{hasCloseButton:!0})}l(null)},Zt=()=>{C.logEvent("Account Portal: Click iOS Manage Subscription",ee)},Xt=()=>{C.logEvent("Account Portal: Click Android Manage Subscription",ee)},ea=N&&y.purchase_origin_platform===je.MOBILE_IOS,ta=N&&y.purchase_origin_platform===je.MOBILE_ANDROID;pe&&!N&&D.push(e.jsx(ce,{to:_a,target:"_blank",className:G(b?"px-1 font-medium":"px-2","underline"),children:e.jsx(m,{...M.limitsApply})},"row-plus-plan-usage-limits")),ea&&D.push(e.jsx(ce,{to:It,target:"_blank",onClick:Zt,className:G(b?"px-1 font-medium":"px-2","underline"),children:_.formatMessage(Ve.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),ta&&D.push(e.jsx(ce,{to:Ft,target:"_blank",onClick:Xt,className:G(b?"px-1 font-medium":"px-2","underline"),children:_.formatMessage(Ve.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),N&&se&&D.push(e.jsx(ce,{target:"_blank",to:dt,onClick:Je,className:G(b?"px-1 font-medium":"px-2","underline"),children:e.jsx(m,{...M.billingHelp})},"row-plus-plan-help-link"));const tt=({skipAppStoreSubscriptionInBillingRetryCheck:A=!1,skipEmailCheck:Y=!1}={})=>{if(E&&!A)return Z(!0);if(c)return c(r,ee);X&&!N&&!a.isActiveSubscriptionGratis()?(C.logEvent("Account Pay: Payment Checkout Clicked",ee),re(S,"chatgpt_account_payment_modal_upgrade_button_click",be),Q(!0)):(F(),Jt({skipEmailCheck:Y}))},Re=(A,Y)=>e.jsx(ct,{planType:be,isCurrentPlan:N&&!Le,disabled:A,onClick:Y,testId:"select-plan-button-plus-upgrade",activeColor:H?"secondary":b&&k==="highlight"?"purple":k==="standard"||aa?"primary":void 0,children:n===g.PLUS&&!q?e.jsx(Fe,{}):Le&&N&&T.callToAction.promo?_.formatMessage(T.callToAction.promo):N?_.formatMessage(T.callToAction.active):_t&&U&&T.callToAction.inactiveUnauthenticated?_.formatMessage(T.callToAction.inactiveUnauthenticated):_.formatMessage(We({ctx:S,planType:g.PLUS}))});gt(R,{plan:ee});const Le=f!=null,aa=f?.promotion_type==="student_discount",_t=f!=null&&"referrer_name"in f,sa=(!N||Le)&&n==null;D=Le?[]:D;let at=null;const Ge=a.getDaysUntilPlanDiscountExpires();if(f!=null)T=ws(_,T,f,r.currency);else if(a.data.subscriptionStatus.discount){const A=a.data.subscriptionStatus.discount,Y=A.discount_start_in_num_periods??0,oe=_.formatNumber(A.amount,{style:"currency",currency:r.currency,minimumFractionDigits:0,maximumFractionDigits:2});if(Y>0){const Se=e.jsx("div",{className:"mb-3 w-full",children:e.jsx("div",{className:G(b?"font-medium text-[#615EEB]":"text-green-600","px-1 text-sm"),children:A.discount_type===Ae.PERCENTAGE?e.jsx(m,{id:"PlusColumn.scheduledPercentDiscount",defaultMessage:"Your {discountPercent}% discount will apply in {numPeriods, plural, one {the next billing period} other {# billing periods}}.",values:{discountPercent:A.amount,numPeriods:Y}}):e.jsx(m,{id:"PlusColumn.scheduledFixedDiscount",defaultMessage:"Your {discountFixed} discount will apply in {numPeriods, plural, one {the next billing period} other {# billing periods}}.",values:{discountFixed:oe,numPeriods:Y}})})});D.unshift(Se)}else T.cost=Ht(_,T.cost,A),f==null&&(T.summary=J.plus.plusSummaryWithDiscount,A.discount_type===Ae.PERCENTAGE&&(at={discount:{percentage:A.amount,expires_at:Ge?$e(Ge,_.locale):void 0}}),A.discount_type===Ae.FIXED&&(at={discount:{value:A.amount,expires_at:Ge?$e(Ge,_.locale):void 0}}))}if(o!=null&&o)return null;const na=ks(a);return e.jsxs(e.Fragment,{children:[e.jsx(Oe,{planType:be,elementId:Ut,pricingPlan:T,useComparisonSpacing:x,callToActionButton:Xe?e.jsx("div",{className:"relative w-full",children:e.jsx(ge,{side:"bottom",sideOffset:20,label:_.formatMessage(M.highDemandDisabledText),children:Re(!0,()=>{})})}):w&&na?e.jsx("div",{children:e.jsx(ge,{side:"top",sideOffset:20,label:_.formatMessage({id:"I2JCGZ",defaultMessage:"Mobile subscriptions are currently not eligible for this promotion."}),onOpenChange:A=>{A&&!V.current&&(_t&&Gt.logMobileSubscriptionTooltipOpen(),V.current=!0)},children:e.jsx("div",{children:Re(!0,()=>{})})})}):e.jsxs("div",{children:[yt&&qt&&Pt?e.jsx(ge,{side:"top",sideOffset:20,label:e.jsx(m,{id:"Rd9wuM",defaultMessage:"Your subscription will change to {nextPlanType} on {date}.",values:{date:$e(yt,_.locale),nextPlanType:ue(Pt.toLowerCase())}}),children:Re(!0,()=>{})}):Re(!sa,tt),e.jsx(ft,{isOpen:ae,onClose:()=>Z(!1),onContinue:()=>tt({skipAppStoreSubscriptionInBillingRetryCheck:!0}),analyticsParams:ee}),q&&e.jsx(ht,{isOpen:q,onClose:()=>Q(!1),accountId:a.id,initialPlanType:a.planType,updatedPlanType:g.PLUS,billingDetails:r})]}),secondaryCallToActionButton:k==="promo"?e.jsx(de,{size:"large",color:"secondary",onClick:i,children:e.jsx(m,{...M.notNow})}):null,additionalLinks:d?D:[],type:k,promoMetadata:f,activeDiscountMetadata:at,billingDetails:r,className:s,isWebRedesign:b}),e.jsx(Ce,{testId:"modal-add-email",isOpen:R,onClose:()=>B(!1),type:"success",className:"max-w-sm",children:e.jsx(Ke,{enterEmailTitle:_.formatMessage(M.addEmailTitle),enterEmailDescription:_.formatMessage(M.addEmailDescription),onVerified:()=>{j(),B(!1),tt({skipEmailCheck:!0})},cancelFlowButton:e.jsx(de,{className:"w-full rounded-md",color:"secondary",onClick:()=>B(!1),children:e.jsx(m,{...M.cancelAddEmail})})})})]})};function ws(t,s,a,n){const{costTitle:o,currencySymbol:c}=$a(s,n),l=o?.defaultMessage?.toString()??"20",{schedule:u}=a,d=a.duration?.period??"month",r=a.duration?.num_periods??1,P=u?.start_after_num_periods??0,f=u?.period??d,i=P>0?bt(f,P,t.locale):void 0,w=bt(d,r+(P>0?P:0),t.locale),k=Ht(t,s.cost,a.discount,a.duration??{num_periods:1,period:"month"}),b=c.code.defaultMessage?.toString()??"USD",x=t.formatNumber(parseFloat(l)||0,{style:"currency",currency:b,minimumFractionDigits:0,maximumFractionDigits:2}),I=a?.no_auto_renewal_at_discount_end===!0;let v;switch(d){case"month":P>0?r===1?v=t.formatMessage(M.promoPlanDisclaimerScheduledForSingleMonth,{start_date:i,end_date:w,cost:x}):v=t.formatMessage(M.promoPlanDisclaimerScheduledForPluralMonths,{num_months:r,start_date:i,end_date:w,cost:x}):r===1?v=I?t.formatMessage(M.promoPlanDisclaimerNoRenewForSingleMonth,{}):t.formatMessage(M.promoPlanDisclaimerForSingleMonth,{date:w,cost:x}):v=I?t.formatMessage(M.promoPlanDisclaimerNoRenewForPluralMonths,{num_months:r}):t.formatMessage(M.promoPlanDisclaimerForPluralMonths,{num_months:r,date:w,cost:x});break;case"year":P>0?r===1?v=t.formatMessage(M.promoPlanDisclaimerScheduledForSingleYear,{start_date:i,end_date:w,cost:x}):v=t.formatMessage(M.promoPlanDisclaimerScheduledForPluralYears,{num_years:r,start_date:i,end_date:w,cost:x}):r===1?v=I?t.formatMessage(M.promoPlanDisclaimerNoRenewForSingleYear,{}):t.formatMessage(M.promoPlanDisclaimerForSingleYear,{date:w,cost:x}):v=I?t.formatMessage(M.promoPlanDisclaimerNoRenewForPluralYears,{num_years:r}):t.formatMessage(M.promoPlanDisclaimerForPluralYears,{num_years:r,date:w,cost:x});break;case"hour":throw new Error("Period 'hour' is not supported")}const j="<article>"+t.formatMessage(M.termsApply)+"</article> "+v;let E=a.summary;if(P>0){const{formattedDiscountedCost:h}=xt(t,1,a.discount,n),S=h;switch(d){case"month":r===1?E=t.formatMessage(M.promoSummaryScheduledForSingleMonth,{discounted_cost:S}):E=t.formatMessage(M.promoSummaryScheduledForPluralMonths,{discounted_cost:S,num_months:r});break;case"year":r===1?E=t.formatMessage(M.promoSummaryScheduledForSingleYear,{discounted_cost:S}):E=t.formatMessage(M.promoSummaryScheduledForPluralYears,{discounted_cost:S,num_years:r});break}}let F=k;if(P>0){const{formattedDiscountedCost:h}=xt(t,1,a.discount,n);let S;switch(d){case"month":r===1?S=t.formatMessage(M.promoCostSubtitleScheduledForSingleMonth,{start_date:i,discounted_cost:h}):S=t.formatMessage(M.promoCostSubtitleScheduledForPluralMonths,{start_date:i,discounted_cost:h,num_months:r});break;case"year":r===1?S=t.formatMessage(M.promoCostSubtitleScheduledForSingleYear,{start_date:i,discounted_cost:h}):S=t.formatMessage(M.promoCostSubtitleScheduledForPluralYears,{start_date:i,discounted_cost:h,num_years:r});break}F={...s.cost,costDuration:{id:"promoCostDurationScheduled",defaultMessage:S,description:"Cost duration subtitle for scheduled promo indicating when discount starts and for how long"}}}return s={...s,summary:{id:"promoSummary",defaultMessage:E},disclaimer:{id:"promoDisclaimer",defaultMessage:j,article:"https://help.openai.com/en/articles/10492689-chatgpt-plus-promotions-referrals"},cost:F,callToAction:{...s.callToAction,promo:{id:"pricingPlanConstants.promo.callToAction",defaultMessage:"Apply to My Subscription",description:"Payment call to action for existing subscribers adding a discount to their plan"}}},s}function ks(t){const s=t.hasPaidSubscription(),a=t.getLastActiveSubscription(),n=s&&a.purchase_origin_platform===je.MOBILE_IOS,o=s&&a.purchase_origin_platform===je.MOBILE_ANDROID;return n||o}const M=ye({promoPlanDisclaimerForPluralMonths:{id:"pricingPlanConstants.promoPlanDisclaimerForPluralMonths",defaultMessage:"Promo pricing applies for {num_months} months. Starting {date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerScheduledForPluralMonths:{id:"pricingPlanConstants.promoPlanDisclaimerScheduledForPluralMonths",defaultMessage:"Promo pricing applies for {num_months} months starting {start_date}. Starting {end_date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerScheduledForSingleMonth:{id:"pricingPlanConstants.promoPlanDisclaimerScheduledForSingleMonth",defaultMessage:"Promo pricing applies for 1 month starting {start_date}. Starting {end_date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerScheduledForPluralYears:{id:"pricingPlanConstants.promoPlanDisclaimerScheduledForPluralYears",defaultMessage:"Promo pricing applies for {num_years} years starting {start_date}. Starting {end_date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},promoPlanDisclaimerScheduledForSingleYear:{id:"pricingPlanConstants.promoPlanDisclaimerScheduledForSingleYear",defaultMessage:"Promo pricing applies for 1 year starting {start_date}. Starting {end_date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},promoPlanDisclaimerForSingleMonth:{id:"pricingPlanConstants.promoPlanDisclaimerForSingleMonth",defaultMessage:"Promo pricing applies for 1 month. Starting {date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerNoRenewForPluralMonths:{id:"pricingPlanConstants.promoPlanDisclaimerNoRenewForPluralMonths",defaultMessage:"Promo pricing applies for {num_months} months."},promoPlanDisclaimerNoRenewForSingleMonth:{id:"pricingPlanConstants.promoPlanDisclaimerNoRenewForSingleMonth",defaultMessage:"Promo pricing applies for 1 month."},promoCostSubtitleScheduledForPluralMonths:{id:"pricingPlanConstants.promoCostSubtitleScheduledForPluralMonths",defaultMessage:"Starting {start_date}: {discounted_cost}/month for {num_months} months"},promoCostSubtitleScheduledForSingleMonth:{id:"pricingPlanConstants.promoCostSubtitleScheduledForSingleMonth",defaultMessage:"Starting {start_date}: {discounted_cost}/month for 1 month"},promoCostSubtitleScheduledForPluralYears:{id:"pricingPlanConstants.promoCostSubtitleScheduledForPluralYears",defaultMessage:"Starting {start_date}: {discounted_cost}/year for {num_years} years"},promoCostSubtitleScheduledForSingleYear:{id:"pricingPlanConstants.promoCostSubtitleScheduledForSingleYear",defaultMessage:"Starting {start_date}: {discounted_cost}/year for 1 year"},promoPlanDisclaimerForPluralYears:{id:"pricingPlanConstants.promoPlanDisclaimerForPluralYears",defaultMessage:"Promo pricing applies for {num_years} years. Starting {date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},promoPlanDisclaimerForSingleYear:{id:"pricingPlanConstants.promoPlanDisclaimerForSingleYear",defaultMessage:"Promo pricing applies for 1 year. Starting {date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},promoPlanDisclaimerNoRenewForPluralYears:{id:"pricingPlanConstants.promoPlanDisclaimerNoRenewForPluralYears",defaultMessage:"Promo pricing applies for {num_years} years."},promoPlanDisclaimerNoRenewForSingleYear:{id:"pricingPlanConstants.promoPlanDisclaimerNoRenewForSingleYear",defaultMessage:"Promo pricing applies for 1 year."},termsApply:{id:"pricingPlanConstants.termsApply",defaultMessage:"Terms apply."},promoSummaryScheduledForPluralMonths:{id:"pricingPlanConstants.promoSummaryScheduledForPluralMonths",defaultMessage:"Pay for the first month, then the next {num_months} months are {discounted_cost}."},promoSummaryScheduledForSingleMonth:{id:"pricingPlanConstants.promoSummaryScheduledForSingleMonth",defaultMessage:"Pay for the first month, then the next month is {discounted_cost}."},promoSummaryScheduledForPluralYears:{id:"pricingPlanConstants.promoSummaryScheduledForPluralYears",defaultMessage:"Pay for the first year, then the next {num_years} years are {discounted_cost}."},promoSummaryScheduledForSingleYear:{id:"pricingPlanConstants.promoSummaryScheduledForSingleYear",defaultMessage:"Pay for the first year, then the next year is {discounted_cost}."},addEmailTitle:{id:"AccountPaymentModal.addEmailTitle",defaultMessage:"Email required"},addEmailDescription:{id:"AccountPaymentModal.addEmailDescription",defaultMessage:"You'll be able to login with this email. It will also be used for account updates (like password resets) and information about OpenAI services."},cancelAddEmail:{id:"AccountPaymentModal.cancelAddEmail",defaultMessage:"Cancel"},haveExistingPlan:{id:"AccountPaymentModal.haveExistingPlan",defaultMessage:"Have an existing plan?"},billingHelp:{id:"AccountPaymentModel.billingHelp",defaultMessage:"I need help with a billing issue"},paymentErrorWarning:{id:"AccountPaymentModal.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},accountErrorWarning:{id:"AccountPaymentModal.accountErrorWarning",defaultMessage:"The account management page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},limitsApply:{id:"xda4i3",defaultMessage:"Limits apply"},notNow:{id:"AccountPaymentModal.notNow",defaultMessage:"Not Now"},highDemandDisabledText:{id:"AccountPaymentModal.highDemandDisabledText",defaultMessage:"Due to high demand, we've temporarily paused upgrades."}}),Ne=g.TEAM,vs=({analyticsParams:t,planLoading:s,billingDetails:a,isWebRedesign:n,type:o=me.standard,useComparisonSpacing:c})=>{const{data:l,refetch:u}=Ee(Qe),d=te(),r=Me(),P=Ie(r,"1627380539"),f=xa(r),i=jt(),w=Va(),[k,b]=p.useState(!1),x=f?.isTeam(),I=f?.isPlus(),v={...t,planType:Ne},j=!!l?.email,E=ba(r,"4293611158").get("enabled",!1),F=fe(r,"111733276").get("show_advertised_ca_icons",!1);let h=qa(E,n,P,F);const S=Ka(),{data:U}=Bt(S??""),_=U?.coupon===Qa&&U?.state==="eligible",O=U?.coupon===Ja&&U?.state==="eligible";let K=null;(_||O)&&(K={plan_name:"chatgptteamplan",title:"",summary:"",discount:{value:0,currency_code:"USD"},duration:{num_periods:1,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null}),_?h={...h,cost:{...h.cost,costInDollars:Pe.promoCost,costInPounds:Pe.promoCost,costInEuros:Pe.promoCost,costInINR:Pe.promoCostINR,costDuration:Pe.promoCostDuration},disclaimer:a.currency===ot?Pe.team1dollarPromoDisclaimerINR:Pe.team1dollarPromoDisclaimer}:O&&(h={...h,cost:{...h.cost,costInDollars:_e.promoCost,costInPounds:_e.promoCost,costInEuros:_e.promoCost,costInINR:_e.promoCostINR,costDuration:_e.promoCostDuration},disclaimer:a.currency===ot?_e.teamFreeTrialPromoDisclaimerINR:_e.teamFreeTrialPromoDisclaimer});const T=W=>{if(!j&&!W){b(!0);return}C.logEvent("Account Pay: Payment Checkout Clicked",v),re(r,"chatgpt_account_payment_modal_upgrade_button_click",Ne);const V=new URLSearchParams(window.location.search).get("referrer")??document.referrer;ka.setPurchaseWorkspaceData({minimumSeats:w,billingDetails:a,promoData:U?.state==="eligible"?U:void 0,referrer:V}),va(i)};return gt(k,{plan:v}),e.jsxs(e.Fragment,{children:[e.jsx(Oe,{planType:Ne,isWebRedesign:n,className:`${n?"md:max-w-117":""}`,elementId:wa,pricingPlan:h,promoData:U,promoMetadata:K,type:o,useComparisonSpacing:c,useRecommendedBadge:o===me.highlight,callToActionButton:e.jsxs("div",{className:"flex flex-col gap-2",children:[x&&e.jsx(ct,{planType:Ne,isCurrentPlan:!0,disabled:s!=null||x,onClick:()=>T(),testId:"select-plan-button-teams-upgrade",children:d.formatMessage(h.callToAction.active)}),e.jsx("div",{className:"w-full",children:e.jsx(ct,{planType:Ne,disabled:s!=null,activeColor:o===me.highlight?"purple":void 0,onClick:()=>T(),testId:"select-plan-button-teams-create",children:x||I?d.formatMessage(h.callToAction.create):d.formatMessage(h.callToAction.inactive)})})]}),billingDetails:a}),e.jsx(Ce,{testId:"modal-add-email",isOpen:k,onClose:()=>b(!1),type:"success",className:"max-w-sm",children:e.jsx(Ke,{enterEmailTitle:d.formatMessage(M.addEmailTitle),enterEmailDescription:d.formatMessage(M.addEmailDescription),onVerified:async()=>{b(!1),await u(),T(!0)}})})]})},we=g.PRO,Vt=()=>Ee({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await Ot.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")}),js=({analyticsParams:t,currentAccount:s,planLoading:a,onSubmit:n,setPlanLoading:o,billingDetails:c,isWebRedesign:l})=>{const{data:u,isError:d}=Vt(),r=Me(),{data:P,refetch:f}=Ee(Qe),i=te(),w=Ue(),[k]=ra(),{trackSelectedPixels:b}=mt({key:g.PRO}),x=k.get("checkout_from"),[I,v]=p.useState(!1),[j,E]=p.useState(!1),[F,h]=p.useState(!1),S=s.getLastActiveSubscription(),U=s.isOrWasPaidCustomer(),_=s.hasPaidSubscription(),O=_&&s.isPro(),K=!!P?.email,{prepareCheckoutSession:T,navigateToCheckout:W}=pt(),{recentlyDowngraded:$}=Ze(),{daysUntilPlanChanges:V,isDowngradeScheduled:ae}=$t(s,$),Z=Ie(r,"1627380539"),q=Za({isWebRedesign:l,inGPT5Gate:Z}),Q=[],R={...t,planType:we},B=_&&S.purchase_origin_platform===je.MOBILE_IOS,z=_&&S.purchase_origin_platform===je.MOBILE_ANDROID,D=async ne=>{if(!K&&!ne){h(!0);return}o(g.PRO),C.logEvent("Account Pay: Payment Checkout Clicked",R),re(r,"chatgpt_account_payment_modal_upgrade_button_click",we);try{const pe=await T({plan_name:"chatgptpro",billing_details:c});n?.(),b(),C.logEvent("Account Pay: Navigating to Payment Checkout",{...R,url:pe.url??""}),re(r,"chatgpt_account_payment_modal_navigating_to_checkout",we,{url:pe.url??""}),x==="vza493q"&&st.setItem(nt.CheckoutFrom,x),await W(pe)}catch{w.warning(i.formatMessage(M.paymentErrorWarning),{hasCloseButton:!0})}o(null)},se=()=>{C.logEvent("Account Portal: Click iOS Manage Subscription",R)},X=()=>{C.logEvent("Account Portal: Click Android Manage Subscription",R)};O&&B&&Q.push(e.jsx(ce,{to:It,target:"_blank",onClick:se,className:G(l?"px-1 font-medium":"px-2","underline"),children:i.formatMessage(Ve.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),O&&z&&Q.push(e.jsx(ce,{to:Ft,target:"_blank",onClick:X,className:G(l?"px-1 font-medium":"px-2","underline"),children:i.formatMessage(Ve.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),U&&Q.push(e.jsx(ce,{target:"_blank",to:dt,onClick:Je,className:G(l?"px-1 font-medium":"px-2","underline"),children:e.jsx(m,{...M.billingHelp})},"row-plus-plan-help-link"));const N=function(){v(!I)},H=function(){E(!j)},y=Ie(r,"1382475798"),L=async()=>{const ne=s.hasPaidSubscription(),pe=y&&s.isActiveSubscriptionGratis();ne&&!pe?(C.logEvent("Account Pay: Payment Checkout Clicked",R),re(r,"chatgpt_account_payment_modal_upgrade_button_click",we),E(!0)):await D()},ie=d||!u||!u.value?L:()=>{N()};return gt(F,{plan:R}),e.jsxs(e.Fragment,{children:[e.jsx(Oe,{planType:we,pricingPlan:q,callToActionButton:e.jsxs("div",{children:[B||z?e.jsx(ge,{side:"top",sideOffset:20,label:i.formatMessage(Es.switchToMobile),onOpenChange:ne=>{ne&&(C.logEvent("Account Pay: Show Mobile Subscription Tooltip",R),re(r,"chatgpt_account_payment_modal_show_mobile_subscription_tooltip",we))},children:e.jsx(de,{fullWidth:!0,size:"large",color:"primary",disabled:!0,"data-testid":"select-plan-button-pro-upgrade",children:i.formatMessage(We({ctx:r,planType:g.PRO}))})}):ae&&V?e.jsx(ge,{side:"top",sideOffset:20,label:e.jsx(m,{id:"MUQGzU",defaultMessage:"Your subscription will remain active until {date}, when it will change to {nextPlanType}.",values:{date:$e(V,i.locale),nextPlanType:ue(s.getNextPlanType()?.toLowerCase()??"")}}),children:e.jsx(de,{fullWidth:!0,size:"large",color:"primary",disabled:O||a!=null,"data-testid":"select-plan-button-pro-upgrade",className:O||a!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:a===g.PRO&&!j?e.jsx(Fe,{}):O?i.formatMessage(q.callToAction.active):i.formatMessage(We({ctx:r,planType:g.PRO}))})}):e.jsx(de,{fullWidth:!0,size:"large",color:"primary",disabled:O||a!=null,onClick:ie,"data-testid":"select-plan-button-pro-upgrade",className:O||a!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:a===g.PRO&&!j?e.jsx(Fe,{}):O?i.formatMessage(q.callToAction.active):i.formatMessage(We({ctx:r,planType:g.PRO}))}),e.jsx(ft,{isOpen:I,onClose:N,onContinue:D,analyticsParams:R}),j&&e.jsx(ht,{isOpen:j,onClose:H,accountId:s.id,initialPlanType:s.planType,updatedPlanType:g.PRO,billingDetails:c})]}),additionalLinks:Q,className:"bg-token-main-surface-primary",billingDetails:c,isWebRedesign:l}),e.jsx(Ce,{testId:"modal-add-email",isOpen:F,onClose:()=>h(!1),type:"success",className:"max-w-sm",children:e.jsx(Ke,{enterEmailTitle:i.formatMessage(M.addEmailTitle),enterEmailDescription:i.formatMessage(M.addEmailDescription),onVerified:()=>{f(),h(!1),D(!0)},cancelFlowButton:e.jsx(de,{className:"w-full rounded-md",color:"secondary",onClick:()=>h(!1),children:e.jsx(m,{...M.cancelAddEmail})})})})]})},Es=ye({switchToPersonalAccount:{id:"y5FjSF",defaultMessage:"Switch to a personal account to upgrade"},switchToMobile:{id:"gbjsg6",defaultMessage:"It looks like you already have an active mobile subscription. Switch to your mobile app to upgrade"}});function Ts(t,s){const a=ut(new Date,t);return new Intl.DateTimeFormat(s,{year:"numeric",month:"short",day:"numeric"}).format(a)}function Ds({isCurrentPlan:t=!1,testId:s,activeColor:a,children:n,...o}){return e.jsx(de,{fullWidth:!0,size:"large",color:t?"secondary":a||"primary","data-testid":s,...o,children:n})}function Ns(t,s){const a=t.planType,n=t.getNextPlanType(),o=t.getDaysUntilPlanChanges(),c=n&&he(n)<he(a);return s?{daysUntilPlanChanges:t.getDaysUntilPlanRenews(),isDowngradeScheduled:!0}:{daysUntilPlanChanges:o,isDowngradeScheduled:c}}function As({currentAccount:t,children:s,disableForMobile:a,promoMetadata:n,planType:o,downgradeToGoDisabled:c}){const{recentlyDowngraded:l}=Ze(),u=te(),{daysUntilPlanChanges:d,isDowngradeScheduled:r}=Ns(t,l),P=p.useRef(!1),f=n!=null&&"referrer_name"in n,i=Xa(t);return a&&!i?e.jsx(ge,{side:"top",sideOffset:20,label:u.formatMessage({id:"I2JCGZ",defaultMessage:"Mobile subscriptions are currently not eligible for this promotion."}),onOpenChange:k=>{k&&!P.current&&(f&&Gt.logMobileSubscriptionTooltipOpen(),P.current=!0)},children:s}):c?e.jsx(ge,{side:"top",labelTextAlign:"left",sideOffset:20,label:u.formatMessage({id:"AccountPaymentModal.primaryCTA.downgradeToGoDisabledTooltip",defaultMessage:"Downgrading to Go is not yet available. To purchase, you must first cancel your current plan."}),children:s}):r&&d?e.jsx(ge,{side:"top",sideOffset:20,label:e.jsx(m,{id:"3UZynm",defaultMessage:"Your subscription will change to {planType} on {date}.",values:{date:Ts(d,u.locale),planType:ue(o.toLowerCase())}}),children:s}):e.jsx(e.Fragment,{children:s})}function Is({analyticsParams:t,billingDetails:s,currentAccount:a,planType:n,planLoading:o,setPlanLoading:c,testId:l,activeColor:u,disableForMobile:d=!1,disabled:r,downgradeToGoDisabled:P=!1,inhouseCheckoutExperimentEnabled:f=!1,isCurrentPlan:i=!1,loading:w=!1,overrideOnClick:k,promoCode:b,promoMetadata:x,children:I,...v}){const{data:j,refetch:E}=Ee(Qe),{trackSelectedPixels:F}=mt({key:n}),h=Me(),{data:{value:S}={}}=Vt(),[U,_]=p.useState(!1),[O,K]=p.useState(!1),T=p.useRef(null),[W,$]=p.useState(!1),V=p.useRef(new Map),ae=Ue(),Z=te(),q=a.planType,Q=he(n)<he(q),R=fe(h,"3950229590"),{prepareCheckoutSession:B,navigateToCheckout:z}=pt(),D=()=>{const N={plan_name:es(n),billing_details:s,promo_code:b},H=V.current.get(JSON.stringify(N));if(H)return C.logEventWithStatsig("Account Pay: Using Prefetched Checkout Session","chatgpt_account_payment_modal_using_prefetched_checkout_session",t),H;C.logEventWithStatsig("Account Pay: Click to Fetch Checkout Session","chatgpt_account_payment_modal_click_to_fetch_checkout_session",t);let y=!1;return f&&(V.current.clear(),y=R.get("skip_sentinel_checkout",!1)),B(N,{skipSentinelCheckout:y})},se=async({skipEmailCheck:N})=>{if(!j?.email&&!N){$(!0);return}c(n),C.logEvent("Account Pay: Payment Checkout Clicked",t),re(h,"chatgpt_account_payment_modal_upgrade_button_click",n),T.current=performance.now();try{const H=await D();let y;T.current&&(y=performance.now()-T.current),C.logEvent("Account Pay: Navigating to Payment Checkout",{...t,url:H.url??"",latency_ms:y});const L={url:String(H.url??"")};y!==void 0&&(L.latency_ms=y.toString()),re(h,"chatgpt_account_payment_modal_navigating_to_checkout",n,L),await z(H)}catch{ae.warning(Z.formatMessage(ze.paymentErrorWarning),{hasCloseButton:!0})}c(null)},X=({skipAppStoreSubscriptionInBillingRetryCheck:N=!1,skipEmailCheck:H=!1}={})=>{if(S&&!N)return _(!0);if(k)return k();Q?(C.logEvent("Account Pay: Payment Checkout Clicked",t),re(h,"chatgpt_account_payment_modal_upgrade_button_click",n),K(!0)):(F(),se({skipEmailCheck:H}))};return e.jsxs(e.Fragment,{children:[e.jsx(As,{currentAccount:a,disableForMobile:d,promoMetadata:x,planType:n,downgradeToGoDisabled:P,children:e.jsx(Ds,{isCurrentPlan:i,disabled:r,loading:w,onClick:()=>X(),testId:l,activeColor:u,...v,children:o===n?e.jsx(Fe,{}):I})}),e.jsx(ft,{isOpen:U,onClose:()=>_(!1),onContinue:()=>X({skipAppStoreSubscriptionInBillingRetryCheck:!0}),analyticsParams:t}),O&&e.jsx(ht,{isOpen:O,onClose:()=>K(!1),accountId:a.id,initialPlanType:q,updatedPlanType:n,billingDetails:s}),e.jsx(Ce,{testId:"modal-add-email",isOpen:W,onClose:()=>$(!1),type:"success",className:"max-w-sm",children:e.jsx(Ke,{enterEmailTitle:Z.formatMessage(ze.addEmailTitle),enterEmailDescription:Z.formatMessage(ze.addEmailDescription),onVerified:()=>{E(),$(!1),X({skipEmailCheck:!0})},cancelFlowButton:e.jsx(de,{className:"w-full rounded-md",color:"secondary",onClick:()=>$(!1),children:e.jsx(m,{...ze.cancelAddEmail})})})})]})}const ze=ye({paymentErrorWarning:{id:"AccountPaymentModal.primaryCTA.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},addEmailTitle:{id:"AccountPaymentModal.primaryCTA.addEmailTitle",defaultMessage:"Email required"},addEmailDescription:{id:"AccountPaymentModal.primaryCTA.addEmailDescription",defaultMessage:"You'll be able to login with this email. It will also be used for account updates (like password resets) and information about OpenAI services."},cancelAddEmail:{id:"AccountPaymentModal.primaryCTA.cancelAddEmail",defaultMessage:"Cancel"},highDemandDisabledText:{id:"AccountPaymentModal.primaryCTA.highDemandDisabledText",defaultMessage:"Due to high demand, we've temporarily paused upgrades."}}),kt=g.GO,Fs=({analyticsParams:t,billingDetails:s,setPlanLoading:a,isWebRedesign:n,currentAccount:o,planLoading:c,promoMetadata:l,type:u})=>{const d={...t,planType:g.GO},r=ts({isWebRedesign:n}),P=o.hasPaidSubscription(),f=P&&o.isGo(),i=!f&&!c,w=o.getNextPlanType()===g.GO,k=!i||w,b=P&&he(g.GO)<he(o.planType),x=u==="highlight"?"purple":"primary";return e.jsx(Oe,{isGoColumn:!0,type:u,planType:kt,pricingPlan:r,callToActionButton:e.jsx(Is,{currentAccount:o,analyticsParams:d,billingDetails:s,planLoading:c,setPlanLoading:a,planType:kt,isCurrentPlan:f,disabled:k,testId:"select-plan-button-go-upgrade",activeColor:b?"secondary":x,promoMetadata:l,children:f?e.jsx(m,{...r.callToAction.active}):b?e.jsx(m,{...vt.switchToGo}):e.jsx(m,{...r.callToAction.inactive})}),additionalLinks:[e.jsx(m,{...vt.limitsApplyLink,values:{link:I=>e.jsx(ce,{target:"_blank",rel:"noopener noreferrer",to:ja,onClick:Je,className:G("underline",n&&"font-medium"),children:I},"row-go-plan-help-link")}},"limits-apply-link")],billingDetails:s,isWebRedesign:n})},vt=ye({limitsApplyLink:{id:"GoColumn.limitsApplyLink",defaultMessage:"Only available in certain regions. <link>Limits apply</link>"},switchToGo:{id:"GoColumn.switchToGo",defaultMessage:"Switch to Go"}});function Us({analyticsParams:t,currentAccount:s,planLoading:a,selectedTab:n,setPlanLoading:o,shouldSplitBetweenPersonalAndBusiness:c,billingDetails:l,scrollExperimentVariant:u,onClose:d,isWebRedesign:r,ctx:P,businessComparisonTreatment:f="control"}){const i=[],w=s.hasPaidSubscription(),k=Ea(P),b=u==="move_free_to_bottom",x=f!=="control",I=f==="highlight";n==="personal"?(!w&&!b&&i.push("free"),k&&i.push("go"),i.push("plus"),i.push("pro"),b&&i.push("free")):(x&&!s.isTeam()&&(s.isFree()||s.isPlus())&&(s.isPlus()?i.push("plus"):s.isFree()&&i.push("free")),i.push("team")),i.length===0&&Rt.addError(new Error("Account payment modal missing columns"));const v=s.isFree()&&!k?me.highlight:me.standard,j=k&&s.isFree()?me.highlight:me.standard;return i.map(E=>{switch(E){case"free":return e.jsx(us,{billingDetails:l,isWebRedesign:r,useComparisonSpacing:x,className:x?"md:max-w-117":void 0},E);case"go":return e.jsx(Fs,{analyticsParams:t,setPlanLoading:o,billingDetails:l,isWebRedesign:r,currentAccount:s,planLoading:a,type:j},E);case"plus":return e.jsx(bs,{analyticsParams:t,currentAccount:s,setPlanLoading:o,planLoading:a,billingDetails:l,onClose:d,isWebRedesign:r,type:v,useComparisonSpacing:x,className:x?"md:max-w-117":void 0},E);case"team":return e.jsx(vs,{analyticsParams:t,billingDetails:l,currentAccount:s,planLoading:a,isWebRedesign:r,type:I?me.highlight:me.standard,useComparisonSpacing:x},E);case"pro":return e.jsx(js,{analyticsParams:t,currentAccount:s,setPlanLoading:o,planLoading:a,billingDetails:l,isWebRedesign:r},E)}})}const Os=({defaultTab:t})=>{const a=!Fa(),n=Me();return a&&t==="personal"?fe(n,"2675205028").get("scroll_to_plus_variant","control"):null};function Ks({currentAccount:t,defaultTab:s="personal",onClose:a,subtitle:n,title:o}){const[c,l]=p.useState(null),u=ia(),d=Ta(),r=la(),P=Da(),f=Me(),i=fe(f,"2675205028").get("show_web_redesign",!1),w=Os({defaultTab:s});p.useEffect(()=>{const y=performance.now();return()=>{if(y){const L=performance.now()-y;C.logValueEventWithStatsig({segmentEventName:"Account Pay: Account Payment Modal Time Spent",statsigEventName:"chatgpt_web_account_payment_modal_time_spent",value:Math.round(L)})}}},[]);const k=!0,b=p.useMemo(()=>({...t.subscriptionAnalyticsParams,referrer:document.referrer}),[t]),x=jt(),I=Ue(),v=p.useCallback(()=>{C.logEvent("Account Pay: Close Account Payment Modal",b),a()},[b,a]);p.useEffect(()=>{const y=localStorage.getItem(`subscriptionUpdateMessage_${t.id}`);if(y){localStorage.removeItem(`subscriptionUpdateMessage_${t.id}`),I.success(y,{hasCloseButton:!0});const L=setTimeout(()=>{v()},5e3);return()=>{clearTimeout(L)}}},[t.id,I,v]);const[j,E]=p.useState(s),{country:F,setCountry:h,userCountry:S}=ss(),U=Rs({currentAccount:t,selectedTab:j}),_=ns({country:U?F:Ua,currentAccount:t,location:"AccountPaymentModal",shouldUsePaidSubscriptionBillingCurrency:j==="personal"}),O=d!=null&&Na(d),K=t.isFree()||t.isPlus(),W=j==="business"&&i&&O&&K,$=fe(f,"2762630623"),V=W?$.get("variant","control"):"control";as(()=>{const y=u.state?.[Oa],L=u.key;y&&x({hash:u.hash,search:u.search},{replace:!0,state:{}});const ne=new URLSearchParams(window.location.search).get("referrer")??document.referrer;Ra.count(La.DEFAULT,"chatgpt_account_payment_modal_show",[{key:"location",value:y},{key:"locationKey",value:L},{key:"navigationType",value:r},{key:"initialTab",value:s},{key:"initialCountrySelectorCountry",value:F},{key:"selectedCountry",value:_.country??""},{key:"selectedCurrency",value:_.currency??""},{key:"userCountry",value:S??""},{key:"isCountrySelectorEnabled",value:String(U)}]),C.logEventWithStatsig("Account Pay: Account Payment Modal Show","chatgpt_account_payment_modal_show",{...b,initialTab:s,location:y,locationKey:L,navigationType:r,initialCountrySelectorCountry:F,selectedCountry:_.country??"",selectedCurrency:_.currency??"",userCountry:S??"",isCountrySelectorEnabled:U,referrer:ne})});const ae=p.useCallback(y=>{Rt.addAction("chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:F,new_selected_country:y}),C.logEventWithStatsig("Selected country changed in pricing modal","chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:F,new_selected_country:y}),h(y)},[F,h]),Z=y=>{E(y);const ie=new URLSearchParams(window.location.search).get("referrer")??document.referrer;C.logEventWithStatsig("Account Pay: Account Payment Modal Toggle Clicked","chatgpt_account_payment_modal_toggle_clicked",{selectedTab:y,referrer:ie})},q=136,[Q,R]=p.useState(),B=p.useRef(null);p.useEffect(()=>{const y=()=>{if(B.current){const L=document.documentElement.clientHeight,ie=B.current.getBoundingClientRect().height,ne=L-ie;R(Math.max(ne,q))}};return y(),window.addEventListener("resize",y),()=>window.removeEventListener("resize",y)},[j]);const z=Us({analyticsParams:b,currentAccount:t,planLoading:c,selectedTab:j,setPlanLoading:l,shouldSplitBetweenPersonalAndBusiness:k,billingDetails:_,scrollExperimentVariant:w,onClose:a,isWebRedesign:i,ctx:f,businessComparisonTreatment:V}),D=Ls({defaultTitle:o,hasProSubscription:t.isPro()}),se=p.useRef(!1);p.useEffect(()=>{const y=document.getElementById(Ut);y?.scrollIntoView&&!se.current&&w==="scroll_to_plus"&&(y.scrollIntoView({behavior:"smooth"}),se.current=!0)},[w]);const H=i?"flex justify-center gap-6 flex-col md:flex-row px-4":"flex flex-col justify-center gap-4 px-3 py-3 md:min-h-[30rem] md:flex-row md:gap-0 md:py-0";return e.jsxs(Ce,{testId:"modal-account-payment",size:"fullscreen",isOpen:!0,onClose:v,type:"success",className:"flex flex-col",removePopoverStyling:!0,shouldIgnoreClickOutside:!0,children:[e.jsxs("div",{ref:B,className:G(i&&"bg-token-bg-elevated-secondary"),children:[e.jsxs("div",{className:G("relative grid grid-cols-[1fr_auto_1fr] px-6 py-4 md:pt-[4.5rem]",i?"md:pb-6":"md:pb-10"),children:[e.jsx("div",{}),e.jsxs("div",{className:"my-1 flex flex-col items-center justify-center md:mt-0 md:mb-0",children:[e.jsx("h2",{className:"text-page-header",children:e.jsx(m,{...D})}),n?e.jsx("div",{className:"text-token-text-secondary mt-3 mb-1",children:e.jsx(m,{...n})}):null]}),e.jsx("button",{className:"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-6 md:top-6",onClick:()=>{v()},children:e.jsx(Aa,{className:G({"h-5 w-5":!P,"icon-lg":P})})})]}),t.isPersonalAccount()&&k?e.jsx("div",{className:G("mb-3 flex justify-center",i?"md:mb-6":"md:mb-10"),children:e.jsx("div",{className:"w-[fit-content]",children:e.jsx(is,{value:j,onChange:Z})})}):null,e.jsx("div",{className:H,children:z})]}),e.jsxs("div",{className:G("relative grid grid-cols-[1fr_auto_1fr]",i&&"bg-token-bg-elevated-secondary"),style:{height:`${Q}px`},children:[e.jsx("div",{}),e.jsxs("span",{className:G("text-token-text-secondary mt-8 mb-12 flex flex-col items-center justify-start gap-2 text-sm md:mt-8 md:mb-8",i&&"md:mt-10"),children:[e.jsx(rs,{}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(m,{...qe.needMoreCapabilities}),e.jsx("div",{children:e.jsx(m,{...qe.seeChatGptEnterprise,values:{link:y=>e.jsx(ce,{target:"_blank",to:Ia,onClick:()=>{C.logEventWithStatsig("Account Pay: Click see enterprise link from Modal","chatgpt_account_payment_modal_enterprise_link_clicked")},className:G("mx-1 underline",i&&"font-medium"),children:y})}})})]})]}),e.jsx("span",{"data-testid":"country-selector-in-pricing-modal",className:G({hidden:!U},"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-4 md:bottom-4"),children:e.jsx(os,{onChange:ae,value:F})})]})]})}function Rs({currentAccount:t,selectedTab:s}){return!!(!t.hasPaidSubscription()||(t.isPlus()||t.isPro())&&s==="business"||t.isTeam())}function Ls({defaultTitle:t,hasProSubscription:s}){return t||(s?qe.proModalTitle:qe.modalTitle)}const qe=ye({modalTitle:{id:"AccountPaymentModal.modalTitle",defaultMessage:"Upgrade your plan"},proModalTitle:{id:"AccountPaymentModal.proModalTitle",defaultMessage:"Choose your plan"},modalFooterCapabilities:{id:"AccountPaymentModal.modalFooterCapabilities",defaultMessage:"Need more capabilities? See <link> ChatGPT Enterprise </link>"},needMoreCapabilities:{id:"SdJWr7",defaultMessage:"Need more capabilities for your business?"},seeChatGptEnterprise:{id:"7C5fuF",defaultMessage:"See<link>ChatGPT Enterprise</link>"},promoNotEligibleMessage:{id:"AccountPaymentModal.promoNotEligibleMessage",defaultMessage:"Thanks for being a susbcriber. Since you already use ChatGPT Plus, you're not eligible for this offer."}});export{Ks as A,bs as P,ys as T,Cs as a,ps as b,Ps as c,ht as d,xt as g,Je as h};
//# sourceMappingURL=ilqp9l3xluxte4ke.js.map
