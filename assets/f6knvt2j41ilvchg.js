const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/tez9kd7scztwir0r.js","assets/lu2xqwqmjc95q6j6.js","assets/lqvtqz2rwatwxk0l.js","assets/rseqzngxzbdt1oxg.js","assets/hml6mmd5fyx85si7.js","assets/root-c0w5lvnh.css","assets/conversation-small-gcvo4yhm.css","assets/msab1t9ew5jwzw5m.js","assets/eywlrsjhpmu02zoa.js","assets/itjugg22bqh0ueps.js","assets/ansi-1f6vhsjh.css","assets/kkw9h7dq0af4udcb.js","assets/e3c6g208bapx5eab.js","assets/ktoofw7mjru0a6r5.js","assets/fsu81ov1h2xmh0dx.js","assets/blhqqdzhd9z6fst7.js","assets/d8r48c27g352nr7t.js","assets/dp7t1jmnbbend843.js","assets/e0cf2nztzmm3evd7.js","assets/l29qldloj3xqr7yu.js","assets/fzrn137102spawew.js","assets/dq9j3pioxqah4sfs.js","assets/mc1n5d2hvi71ywqx.js","assets/n0u5fqw2jde51umw.js","assets/nhs24pb9s8hnfshq.js","assets/dth89wjzf9gy8rh3.js","assets/kwjkd9zyf9vouy1r.js","assets/dc45v808kg6x38y7.js","assets/99iw5y145xpdn59x.js","assets/fi4t5vltimyk5jia.js","assets/kyavoy07nhuntf5e.js","assets/parse-diff-iz0raby8.css","assets/d0g29t0qm74gluj7.js","assets/d7o4nful0h1qw8zk.js","assets/lw1kjinrctt8cogu.js","assets/code-diff-krvv6lyt.css"])))=>i.map(i=>d[i]);
import{h as xe,n as Je,W as R,f as Re,w as Ie,k as ut,g as Y,O as we,e as ft,o as Ze,l as ht,P as et,u as mt,b as gt}from"./ktoofw7mjru0a6r5.js";import{r as u,e as Q,j as e,M as w,a as Oe,m as tt,n as te,u as pt,l as be,A as xt,d as wt,g as vt}from"./lu2xqwqmjc95q6j6.js";import{eW as _t,aB as N,fG as bt,C as yt,B as ae,bg as se,dh as kt,dc as Mt,a as ye,c as X,d as J,ow as jt,df as Pt,R as He,ea as ke,b5 as Ct,sx as St,j as Tt,c6 as at,c9 as ee,G as st,ed as Nt,ef as Dt,ap as Lt,aq as Ft,t as Rt,x as It,L as Bt,nn as Et,bl as qt}from"./hml6mmd5fyx85si7.js";import{dY as Ot,ey as ve,ez as Be,B as Ht,cb as Ee,a5 as Ut,gC as Wt,o2 as Gt,ax as Qe,gA as Qt,gB as Kt,a6 as Ce,t as At,mB as Se,aS as Vt,pM as Ke,hk as Ae,jQ as $t,iE as zt,i8 as Yt,c6 as Xt}from"./rseqzngxzbdt1oxg.js";import{JsonViewer as Jt}from"./e0cf2nztzmm3evd7.js";import{T as Zt,a as ea,b as ta}from"./kyavoy07nhuntf5e.js";import{a as Ve,S as aa}from"./ezlg48t9e1qt7u4e.js";import{f as sa,C as qe,M as Te,p as ge,c as ra,W as na,b as ia,d as oa}from"./msab1t9ew5jwzw5m.js";import{W as _e}from"./n0u5fqw2jde51umw.js";import{S as la}from"./ipg3e8rb8w1bw4eb.js";import{u as da,W as ca}from"./mc1n5d2hvi71ywqx.js";import{W as ua,D as oe,O as fa}from"./im6z424k5kcvyn27.js";import{S as ha}from"./fvbnr0u7cjvlf5r4.js";import{N as ma}from"./k1vf300nfu1glkjf.js";import{s as pe,B as ga}from"./fc2c76vpc3m2kj8q.js";import{s as Ne}from"./nhs24pb9s8hnfshq.js";import{u as pa}from"./em6xteal3laxzbp5.js";function ls({taskId:t,task:r,currentUserTurn:s,currentAssistantTurn:a}){const n=xe(l=>l.addTurnToTaskMap),o=xe(l=>l.getTurnsForTask),[d,i]=u.useState(a?.id??r?.current_turn_id??null);u.useEffect(()=>{t&&(a&&["pending","in_progress","failed"].includes(a.turn_status)?i(a.id):i(a?.id??null),s&&n(t,s),a&&n(t,a))},[a,s,t,n]);let f=o(t??"")?.filter(l=>l.type==="assistant")?.find(l=>l.id===d)??null;return f||(f=a),{focusedAssistantTurn:f,setFocusedAssistantTurnId:i}}function xa({unifiedDiff:t,setUnifiedDiff:r,showFullDiff:s,setShowFullDiff:a}){const n=Q(),[o,d]=u.useState(!1);return e.jsxs(_t,{open:o,onOpenChange:d,contentAlign:"end",sideOffset:8,modal:!0,triggerButton:e.jsx("button",{type:"button",onClick:()=>d(!0),className:"hover:bg-token-border-light flex items-center justify-center rounded p-3","aria-label":n.formatMessage({id:"wham.diffModeDropdown.openMenu",defaultMessage:"Open diff settings menu"}),children:e.jsx(Ve,{className:"icon"})}),children:[e.jsxs(N.RadioGroup,{value:t?"unified":"split",onValueChange:i=>r(i==="unified"),onClick:i=>i.stopPropagation(),children:[e.jsx(N.RadioItem,{value:"split",onClick:i=>i.stopPropagation(),children:e.jsxs("div",{className:"text-token-text-primary flex items-center gap-3",children:[e.jsx(Ve,{className:"icon"}),e.jsx(w,{id:"wham.message.modal.footer.splitDiff",defaultMessage:"Split diff"})]})}),e.jsx(N.RadioItem,{value:"unified",onClick:i=>i.stopPropagation(),children:e.jsxs("div",{className:"text-token-text-primary flex items-center gap-3",children:[e.jsx(aa,{className:"icon"}),e.jsx(w,{id:"wham.message.modal.footer.unifiedDiff",defaultMessage:"Unified diff"})]})})]}),e.jsx(N.Separator,{}),e.jsxs(N.RadioGroup,{value:s?"full":"latest",onValueChange:i=>a(i==="full"),onClick:i=>{i.stopPropagation()},children:[e.jsx(N.RadioItem,{value:"full",children:e.jsx(w,{id:"wham.copyFile.showFullDiff",defaultMessage:"Full diff"})}),e.jsx(N.RadioItem,{value:"latest",children:e.jsx(w,{id:"wham.copyFile.showLatestCommit",defaultMessage:"Incremental diff"})})]})]})}function wa({previewImages:t}){const r=Q(),s=Ot(t.map(l=>({content_type:bt.ImageAssetPointer,asset_pointer:l.asset_pointer??"",size_bytes:l.size_bytes??0,width:l.width??0,height:l.height??0}))),a=u.useMemo(()=>s.filter(l=>l.data),[s]),[n,o]=u.useState(0),d=Math.min(Math.max(n,0),Math.max(a.length-1,0)),i=u.useCallback(()=>{a.length<=1||(o(l=>(l-1+a.length)%a.length),_e.recordPreviewImagesCarouselPrev())},[a.length]),h=u.useCallback(()=>{a.length<=1||(o(l=>(l+1)%a.length),_e.recordPreviewImagesCarouselNext())},[a.length]);Je([{key:"previewCarouselPrev",action:i,actionMessageDescriptor:r.formatMessage({id:"wham.keyboardActions.previousPreviewImage",defaultMessage:"Select previous image"}),group:Be.Chat,keyboardBinding:[ve.ArrowLeft],enabled:a.length>1},{key:"previewCarouselNext",action:h,actionMessageDescriptor:r.formatMessage({id:"wham.keyboardActions.nextPreviewImage",defaultMessage:"Select next image"}),group:Be.Chat,keyboardBinding:[ve.ArrowRight],enabled:a.length>1}]);const f=a[d]?.data;return e.jsxs("div",{className:"relative flex h-full w-full items-center justify-center overflow-hidden p-4",children:[f?e.jsx("img",{src:f.url,width:f.width,height:f.height,alt:r.formatMessage({id:"wham.whamTaskPageContentLoaded.previewImageAlt",defaultMessage:"Generated image"}),className:"max-h-full max-w-full object-contain"},d):e.jsx("div",{className:"text-secondary text-sm",children:r.formatMessage({id:"wham.whamPreviewImageCarousel.loading",defaultMessage:"Loading preview…"})}),a.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button","aria-label":r.formatMessage({id:"wham.whamPreviewImageCarousel.prev",defaultMessage:"Previous image"}),onClick:i,className:"absolute start-2 top-1/2 -translate-y-1/2 rounded-md bg-black/40 px-2 py-1 text-white hover:bg-black/60 focus:ring-2 focus:ring-white/70 focus:outline-none",children:"‹"}),e.jsx("button",{type:"button","aria-label":r.formatMessage({id:"wham.whamPreviewImageCarousel.next",defaultMessage:"Next image"}),onClick:h,className:"absolute end-2 top-1/2 -translate-y-1/2 rounded-md bg-black/40 px-2 py-1 text-white hover:bg-black/60 focus:ring-2 focus:ring-white/70 focus:outline-none",children:"›"}),e.jsxs("div",{className:"pointer-events-none absolute start-1/2 bottom-2 -translate-x-1/2 rounded-md bg-black/40 px-2 py-0.5 text-xs text-white",children:[d+1," / ",a.length]})]})]})}function va({isOpen:t,onConfirm:r,onClose:s,loading:a}){return e.jsx(yt,{isOpen:t,onClose:s,testId:"modal-wham-retry-all-turns",type:"warning",title:e.jsx("p",{className:"text-token-text-primary font-semibold",children:e.jsx(w,{id:"wham.retryAllTurnsModal.title",defaultMessage:"Retry all turns"})}),primaryButton:e.jsx(ae,{color:"primary",loading:a,onClick:r,children:e.jsx(w,{id:"wham.retryAllTurnsModal.confirm",defaultMessage:"Retry all turns"})}),secondaryButton:e.jsx(ae,{color:"secondary",onClick:s,children:e.jsx(w,{id:"wham.retryAllTurnsModal.cancel",defaultMessage:"Cancel"})}),children:e.jsx("div",{className:"text-sm",children:e.jsx(w,{id:"wham.retryAllTurnsModal.message",defaultMessage:"All latest turns will restart, including any siblings turns that are in progress or completed."})})})}function _a({taskId:t,turnId:r,comments:s,clearComments:a,lastTurn:n,focusedAssistantTurn:o,setFocusedAssistantTurnId:d,retry:i,attemptIndex:h,siblings:f}){const l=Oe(),b=Q(),_=se(),v=kt(),j=Mt(),x=da(),P=T=>{jt(Pt(j)),a(),d(T.turn.id)},m=async()=>{if(i){D(!0);try{if(i.previousTurnId){const T=await R.createFollowUpTask(t,i.previousTurnId,i.prompt,i.comments??[],!1,U?i.bestOfN??1:void 0,x?i.attachments:[]);P(T)}else{const T=await R.createNewTask(i.environmentId,i.branch,i.prompt,!1,U?i.bestOfN:void 0,x?i.attachments:[]);l(`/codex/tasks/${T.task.id}`)}S(!1)}catch(T){T instanceof Re?Ie(T,r,b,_):_.danger({id:"wham.whamTaskPageFooter.errorRetryingTask",defaultMessage:"Error retrying task",description:"Error retrying task"},{toastId:"wham_task_page_footer_error_retrying_task"})}finally{D(!1)}}},I=o?.output_items?.some(T=>T.type==="pr"),B=!n||!o||n.id===o?.id||!I,O=i&&B&&o?.turn_status==="failed",H=o?.previous_turn_id&&n?.type==="assistant"&&o.previous_turn_id===n.previous_turn_id,[y,D]=u.useState(!1),[g,S]=u.useState(!1),M=ye(),A=X(M,"1406552515"),E=X(M,"879591222")||void 0,U=X(M,"3492040717"),L=u.useMemo(()=>{const T=[...o?.output_items?.find(C=>C.type==="review")?.suggested_followup_tasks??[],...o?.output_items?.filter(C=>C.type==="suggested_task")??[]],W=sa(o?.child_turns?.filter(C=>C.source.type==="suggested_task")?.map(C=>[C.source.suggested_task_id,C]));return T.map(C=>({suggestion:C,userTurnId:C.id?W[C.id]?.assistant_turn_id??null:null,assistantTurnId:C.id?W[C.id]?.user_turn_id??null:null}))},[o]),$=n?.type==="assistant"?n.turn_status:"completed",re=f?.map(T=>T.turn_status)??[];return n?.type==="assistant"&&["pending","in_progress"].includes(n.turn_status)&&!E?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"wham-message-modal-footer",className:"z-50 flex w-full justify-center",children:[(B||H)&&e.jsx("div",{className:"flex w-full justify-center px-4",children:e.jsx("div",{className:J("relative z-1 flex w-full flex-col pt-2 pb-4",qe),children:O?e.jsx(ae,{className:"w-full",color:"primary",size:"large",loading:y&&!g,onClick:()=>{(i?.bestOfN??1)>1?S(!0):m()},children:(i.bestOfN??1)>1?b.formatMessage({id:"wham.whamTaskPageFooter.retryAllTurns",defaultMessage:"Retry all turns"}):b.formatMessage({id:"wham.whamTaskPageFooter.retry",defaultMessage:"Retry"})}):a&&e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsx(ua,{}),!A&&e.jsx(ca,{disableAutoFocus:!0,disableDuringSubmit:!0,onSuccess:P,onClearComments:a,followUp:{taskId:t,turnId:r,comments:s,turnStatus:$,siblingTurnStatuses:re,followUpSuggestions:L},attemptIndex:h,ariaLabel:b.formatMessage({id:"wham.whamTaskPageFooter.composerAriaLabel",defaultMessage:"Composer to enter a follow up prompt to the task"})})]})})}),!B&&!H&&e.jsx(tt.div,{layout:!0,className:J("dark mx-6 mb-6 w-full",qe),initial:{opacity:0,translateY:10},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:10},transition:{duration:v?0:.25},children:e.jsx(Ht,{title:e.jsx(w,{id:"wham.whamTaskPageFooter.previousTurn",defaultMessage:"You are viewing a previous turn"}),primaryCtaText:e.jsx(w,{id:"wham.whamTaskPageFooter.viewLatestTurn",defaultMessage:"View latest"}),content:e.jsx(w,{id:"wham.whamTaskPageFooter.followUpsLatestTurn",defaultMessage:"Follow-ups are only available for the latest turn"}),icon:e.jsx(la,{className:"icon"}),onPrimaryCtaClick:()=>d(n.id)})})]}),e.jsx(va,{isOpen:g,onClose:()=>S(!1),onConfirm:m,loading:y})]})}const rt=window.location.origin+"/s/";function ba(t){return`${rt}${t}`}function nt(t){return!t||!t.attachments||t.attachments.length===0||t.attachments[0].kind!=="codex"?null:{postId:t.id,permalink:t.permalink??ba(t.id),permissions:t.permissions.share_setting??"public",codexTask:t.attachments[0].task,codexTurn:t.attachments[0].turns}}function le(t){return["codex_tasks","result","share",t]}function ya({taskId:t,enabled:r}){return pt({enabled:!!t&&r,queryKey:le(t),queryFn:async()=>{const s=await He.safeGet("/share/post/by_codex_task/{codex_task_id}",{parameters:{path:{codex_task_id:t}}});return s.post?nt(s.post):null}})}function ka({taskId:t,onSuccess:r,onError:s}){return te({scope:{id:t},mutationFn:()=>R.forkSharedTask(t),onSuccess:r,onError:s})}function Ma({taskId:t,turnId:r,onSuccess:s,onError:a}){return te({scope:{id:t},mutationFn:async()=>{const n=await He.safePost("/share/post",{requestBody:{attachments_to_create:[{kind:"codex",codex_task_id:t,current_codex_turn_id:r}]}});return nt(n.post)},onSuccess:s,onError:a})}function ja({taskId:t,sharedResult:r}){const s=be();return te({scope:{id:r?.postId??""},mutationFn:async({sharedResultId:a,access:n})=>(await He.safePost("/share/post/update_access",{requestBody:{post_id:a,share_settings:n}})).share_setting,onMutate:({access:a})=>{const n=le(t),o=s.getQueryData(n);return s.setQueryData(n,o&&{...o,permissions:a}),{previousAccess:o?.permissions}},onSuccess:a=>{const n=le(t),o=s.getQueryData(n);o&&s.setQueryData(n,{...o,permissions:a})},onError:(a,n,o)=>{const d=le(t),i=s.getQueryData(d);s.setQueryData(d,i&&{...i,permissions:o?.previousAccess??"public"})}})}function Pa({taskId:t}){const r=Q(),s=se(),a=Oe(),{mutate:n}=ka({taskId:t,onSuccess:o=>{o?.task?.id&&a(`/codex/tasks/${o?.task?.id}`)},onError:()=>{s.danger(r.formatMessage({id:"wham.codexForkButton.failedToFork",defaultMessage:"Failed to fork task"}))}});return e.jsx(ae,{size:"small",color:"secondary",type:"button",className:"px-3 py-2",onClick:()=>n(),children:e.jsx(w,{id:"wham.share.taskForkButton",defaultMessage:"Fork"})})}const Ca=`${rt}...`;function Sa({taskId:t,turnId:r,isLoading:s,sharedResult:a,title:n}){const[o,d]=u.useState(!1),i=(m,I)=>{m&&At(m,void 0,I).then(()=>{d(!0),setTimeout(()=>d(!1),1500)}).catch(()=>{})},h=be(),f=se(),{mutate:l,isPending:b}=Ma({taskId:t,turnId:r,onSuccess:m=>{if(!m){f.danger("Failed to create share link");return}h.setQueryData(le(t),m),i(m.permalink)}}),{mutate:_}=ja({taskId:t,sharedResult:a}),v=u.useRef(null),j=m=>{v.current?.focus(),a?i(a.permalink,m):l()},x=m=>{a&&_({sharedResultId:a.postId,access:m})},P=m=>{switch(m){case"public":return Ce.PUBLIC;case"private":return Ce.PRIVATE;case"workspace":return Ce.WORKSPACE}};return e.jsx(ga,{inputRef:v,isLoading:s,isPublishedVersionLatest:!0,sharedObject:a&&{id:a.postId,title:n,access:P(a.permissions)},title:n,shareTextPlaceholder:Ca,shareUrl:a?.permalink,isCopySuccessful:o,isCreateLinkRequestInProgress:b,handlePrivacyChange:x,handlePrimaryButtonClick:j})}function Ta({taskId:t,turnId:r,isDisabled:s,title:a}){const n=ke(),o=Ct(),d=Q(),[i,h]=u.useState(!1),{data:f,isLoading:l}=ya({taskId:t,enabled:i&&!s}),{triggerRef:b,container:_}=St({isOpen:i,onClose:()=>h(!1)}),v=o?.isWorkspaceAccount()&&!o?.features.includes(Tt.WorkspaceShareLinks);return s||v?e.jsx(at,{label:v?d.formatMessage(pe.workspaceSharingDisabled):d.formatMessage(pe.share),children:e.jsx(Ee,{disabled:!0,icon:Ut,"aria-label":d.formatMessage(v?pe.workspaceSharingDisabled:pe.share)})}):e.jsxs(Wt,{open:i,onOpenChange:h,children:[e.jsx(Gt,{ref:b,asChild:!0,children:n?e.jsx(Ee,{icon:Qe,"aria-label":d.formatMessage({id:"wham.whamTaskPageHeader.shareAriaLabel",defaultMessage:"Share task"})}):e.jsx(ae,{icon:Qe,color:"ghost","aria-label":d.formatMessage({id:"wham.whamTaskPageHeader.shareAriaLabel",defaultMessage:"Share task"}),children:e.jsx(w,{id:"wham.whamTaskPageHeader.share",defaultMessage:"Share"})})}),e.jsx(xt,{children:i&&e.jsx(Qt,{forceMount:!0,container:_,children:e.jsx(Kt,{align:"end",className:"z-50",sideOffset:8,collisionPadding:8,children:e.jsx(Sa,{title:a,taskId:t,turnId:r,sharedResult:f,isLoading:l})})})})]})}function Na({assistantTurn:t}){const r=Q(),s=se(),a=ke(),n=t?.pull_request_data?.head??t?.branch??"",o=l=>l.type==="pr",d=t?.output_items.find(o),i=t?.base_commit_sha??t?.pull_request_data?.base_sha??d?.output_diff?.base_commit_sha;if(a||!n)return null;const h=i!=null&&n!==i,f=()=>e.jsx("span",{className:"text-token-text-secondary hover:text-token-text-primary cursor-pointer",onClick:()=>{navigator.clipboard.writeText(i??""),s.success(r.formatMessage({id:"wham.baseSha.copied",defaultMessage:"Copied branch commit SHA to clipboard"}))},children:i});return e.jsx(at,{label:f(),side:"bottom",disabled:!h,interactive:!0,children:e.jsx("span",{className:"text-token-text-secondary hover:text-token-text-primary cursor-pointer truncate",onClick:()=>{navigator.clipboard.writeText(n),s.success(r.formatMessage({id:"wham.branchName.copied",defaultMessage:"Copied branch name to clipboard"}))},children:n})})}const Da=({assistantTurn:t})=>{const r=Q(),s=u.useMemo(()=>t?.created_at?new Date(t.created_at*1e3):null,[t?.created_at]),a=u.useMemo(()=>s?.getFullYear()===new Date().getFullYear(),[s]);return s?s.toLocaleDateString(r.locale,{month:"short",day:"numeric",year:a?void 0:"numeric"}):null};function it(t){const{outputDiffs:r}=ot(t?.output_items);return{filesModified:Ne(r,s=>s.files_modified??0),linesAdded:Ne(r,s=>s.lines_added??0),linesRemoved:Ne(r,s=>s.lines_removed??0)}}function ot(t){let r=!1;return t?{outputDiffs:t.map(a=>{switch(a.type){case"output_diff":return a;case"pr":return r=!!a.pre_apply_patch,a.output_diff;default:return null}}).filter(a=>a!=null),hasPreApplyPatch:r}:{outputDiffs:[],hasPreApplyPatch:r}}const La=({title:t,assistantTurn:r})=>{const{linesAdded:s,linesRemoved:a}=it(r),n=r?.environment?.label;return e.jsxs("div",{className:"flex min-w-0 flex-col text-sm",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"truncate font-medium",children:t})}),e.jsxs("div",{className:"flex gap-4 max-md:flex-wrap max-md:gap-1",children:[e.jsx("span",{className:"text-token-text-secondary truncate empty:hidden max-md:hidden",children:e.jsx(Da,{assistantTurn:r})}),e.jsx("span",{className:"text-token-text-secondary truncate",children:n}),e.jsx(Na,{assistantTurn:r}),e.jsx("span",{className:"max-md:hidden",children:e.jsx(ut,{linesAdded:s,linesRemoved:a})})]})]})},Fa=({copyApplyToClipboard:t,copyPatchToClipboard:r,createPr:s,updateBranch:a,navigateToCreatingPrPage:n,canCreatePr:o,isCreatingPr:d,permissions:i,assistantTurn:h})=>{const f=ye(),l=Q(),b=X(f,"296452287"),_=e.jsxs(e.Fragment,{children:[a&&o&&e.jsx(N.Item,{icon:ee,onClick:()=>s(),"aria-label":l.formatMessage(k.createNewPr),children:e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx(w,{...k.createNewPr})})}),e.jsx(N.Item,{icon:Se,onClick:()=>t(),"aria-label":l.formatMessage(k.copyGitApply),children:e.jsx(w,{...k.copyGitApply})}),e.jsx(N.Item,{icon:Se,onClick:()=>r(),"aria-label":l.formatMessage(k.copyPatch),children:e.jsx(w,{...k.copyPatch})})]});return!o||i==="read"?e.jsx(oe,{buttonIcon:Vt,onClick:()=>t(),triggerButtonAriaLabel:k.openDropdown,dropdownContent:e.jsx(N.Item,{icon:Se,onClick:()=>r(),"aria-label":l.formatMessage(k.copyPatch),children:e.jsx(w,{...k.copyPatch})}),children:e.jsx(w,{...k.copyGitApply})}):d?e.jsx(oe,{buttonIcon:st,onClick:n,dropdownContent:_,triggerButtonAriaLabel:k.openDropdown,children:e.jsx(w,{...k.viewPullRequest})}):h?.pull_request_data?.url?e.jsx(oe,{buttonIcon:ee,as:"a",href:h.pull_request_data.url,dropdownContent:_,triggerButtonAriaLabel:k.openDropdown,children:e.jsx(w,{...k.viewPullRequest})}):a?e.jsx(oe,{buttonIcon:ee,onClick:()=>a(),dropdownContent:_,triggerButtonAriaLabel:k.openDropdown,children:e.jsx(w,{...k.updateExistingBranch})}):e.jsx(oe,{buttonIcon:ee,onClick:()=>s(),"aria-label":l.formatMessage(k.createPr),triggerButtonAriaLabel:k.openDropdown,dropdownContent:e.jsxs(e.Fragment,{children:[e.jsx(N.Item,{icon:ee,onClick:()=>s("draft"),"aria-label":l.formatMessage(k.createDraftPr),children:e.jsx(w,{...k.createDraftPr})}),b&&e.jsx(N.Item,{icon:ee,onClick:()=>s("auto_merge"),"aria-label":l.formatMessage(k.createAutoMergePr),children:e.jsx(w,{...k.createAutoMergePr})}),e.jsx(N.Separator,{}),_]}),children:e.jsx(w,{...k.createPr})})},k=wt({copyGitApply:{id:"wham.whamTaskPushDiffDropdown.copyGitApply",defaultMessage:"Copy git apply"},copyPatch:{id:"wham.whamTaskPushDiffDropdown.copyPatch",defaultMessage:"Copy patch"},viewPullRequest:{id:"wham.message.modal.footer.viewPr",defaultMessage:"View PR"},createPr:{id:"wham.message.modal.footer.createPrItem",defaultMessage:"Create PR"},createNewPr:{id:"wham.whamTaskPushDiffDropdown.createNewPr",defaultMessage:"Create new PR"},createDraftPr:{id:"wham.message.modal.footer.createDraftPr",defaultMessage:"Create draft PR"},createAutoMergePr:{id:"wham.message.modal.footer.createAutoMergePr",defaultMessage:"Create auto-merged PR"},updateExistingBranch:{id:"wham.whamTaskPushDiffDropdown.updateExistingBranch",defaultMessage:"Update branch"},openDropdown:{id:"wham.whamTaskPushDiffDropdown.openDropdown",defaultMessage:"Open git action menu"}});var De,$e;function Ra(){if($e)return De;$e=1;function t(r){return r&&r.length?r[0]:void 0}return De=t,De}var Le,ze;function Ia(){return ze||(ze=1,Le=Ra()),Le}var Ba=Ia();const Ea=vt(Ba);function qa({taskId:t,task:r,focusedAssistantTurn:s,onClose:a,shouldShowShare:n,shouldShowFork:o,permissions:d,title:i,showGitActions:h=!0}){const[f,l]=u.useState(s?.pull_request_status==="creating"),[b,_]=u.useState(void 0),v=se(),j=be(),x=Q(),P=Ea(Y(s)),m=d==="write",I=xe(p=>p.getTurnsForTask(t).filter(we)),B=xe(p=>p.getTurnsForTask(t)),O=new Map(B.map(p=>[p.id,p])),H=p=>{if(we(p)){const q=r?.external_pull_requests;if(q&&q.length)for(let F=q.length-1;F>=0;F--){const me=q[F];if(me.assistant_turn_id===p.id)return me}}const G=p.previous_turn_id?O.get(p.previous_turn_id):void 0;return G?H(G):void 0},y=s?H(s):void 0,{linesAdded:D,linesRemoved:g}=it(s),{outputDiffs:S,hasPreApplyPatch:M}=ot(s?.output_items),A=m&&!M,E=Oe(),U=ye(),L=X(U,"2665240312")||void 0,$=X(U,"369193424"),T=I.filter(p=>s?.sibling_turn_ids?.includes(p.id)).some(p=>p.pull_request_data?.url),W=$&&d==="write"&&y&&!y.pull_request.merged&&y.pull_request.state!=="closed"&&y.codex_updated_sha!==""&&s?.id!==y.assistant_turn_id&&!T,C=u.useRef(null),{mutate:de,isPending:Me}=te({mutationFn:async()=>{t&&await R.archiveTask(t)},onSuccess:async()=>{await j.invalidateQueries({queryKey:["wham","tasks"]}),await j.invalidateQueries({queryKey:["wham","task",t]}),E("/codex")},onError:()=>{v.danger({id:"wham.whamTaskPageHeader.failedToArchiveTask",defaultMessage:"Failed to archive task",description:"Toast when archive request fails"},{toastId:"wham_task_page_header_failed_to_archive_task"})}}),{mutate:K,isPending:ne}=te({mutationFn:async()=>{t&&await R.recoverTask(t)},onSuccess:async()=>{await j.invalidateQueries({queryKey:["wham","tasks"]}),await j.invalidateQueries({queryKey:["wham","task",t]})},onError:()=>{v.danger({id:"wham.whamTaskPageHeader.failedToArchiveTask",defaultMessage:"Failed to archive task",description:"Toast when archive request fails"},{toastId:"wham_task_page_header_failed_to_archive_task"})}}),ce=Me||ne;u.useEffect(()=>{s?.pull_request_status==="creating"?(l(!0),j.invalidateQueries({queryKey:["wham","task",t,"turns"]})):l(!1)},[t,s?.pull_request_status,j]),Je([{key:"copyApplyToClipboard",action:()=>{ue()},actionMessageDescriptor:x.formatMessage({id:"wham.keyboardActions.copyApplyToClipboard",defaultMessage:"Copy git apply"}),group:Be.Chat,keyboardBinding:[ve.Mod,ve.Shift,";"],enabled:!!P}]);const ue=async()=>{P&&(await navigator.clipboard.writeText(` (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
${P} 
EOF
)`),v.success(x.formatMessage({id:"wham.message.modal.footer.copiedToClipboard",defaultMessage:"Copied git apply command to clipboard"}),{duration:3,hasCloseButton:!0}),s?.id&&(_e.recordGitAction("diff-copied",D,g,t,s.id,"regular"),R.copyGitApply(t,s.id,!0)))},je=async()=>{P&&(await navigator.clipboard.writeText(P),v.success(x.formatMessage({id:"wham.whamTaskPageHeader.copiedPatchToClipboard",defaultMessage:"Copied patch to clipboard"}),{duration:3,hasCloseButton:!0}),s?.id&&await R.copyGitApply(t,s.id,!1))},Pe=async()=>{if(!y||!s?.id){v.danger({id:"wham.whamTaskPageHeader.noPrToUpdate",defaultMessage:"No PR to update",description:"Toast when no PR is found to update"},{duration:3,hasCloseButton:!0,toastId:"wham_task_page_header_no_pr_to_update"});return}l(!0);try{await R.updatePr(t,s.id,y.id)}catch(p){l(!1),await R.getTaskTurnPR(t,y.assistant_turn_id),p instanceof Re?Ie(p,s.id,x,v):v.danger({id:"wham.whamTaskPageHeader.failedToUpdatePr",defaultMessage:"Failed to update PR",description:"Toast when failed to update PR"},{duration:3,hasCloseButton:!0,toastId:"wham_task_page_header_failed_to_update_pr"})}finally{await j.refetchQueries({queryKey:["wham","tasks"]}),await j.refetchQueries({queryKey:["wham","task",t]}),l(!1)}},fe=async p=>{if(!s?.id)return;_(p);const G=C.current;try{l(!0),await R.createPr(t,s.id,p),await j.refetchQueries({queryKey:["wham","task"]}),await j.fetchQuery(ft(t,s.id)).then(q=>{const F=q;F.turn.pull_request_data!=null&&(G&&!G.closed&&F.turn.pull_request_data.url&&G.location.assign(F.turn.pull_request_data.url),Nt({title:F.task.title,clientThreadId:F.turn.conversation_id,subtitle:x.formatMessage({id:"wham.message.modal.footer.prCreatedSuccess",defaultMessage:"Click to view your pull request."}),onClick:()=>{window.open(F.turn.pull_request_data?.url,"_blank")}}))}),_e.recordGitAction("pr-created",D,g,t,s.id,p??"regular")}catch(q){l(!1),G?.close(),q instanceof Re?Ie(q,s.id,x,v):v.danger({id:"wham.message.modal.footer.createPrError",defaultMessage:"Failed to create PR",description:"Error message for failed to create PR"},{duration:3,hasCloseButton:!0,toastId:"wham_task_page_header_failed_to_create_pr"})}},he=()=>{if(!s?.id)return;const p=b?`?mode=${b}`:"";C.current=window.open(`/codex/tasks/${t}/turns/${s.id}/pr${p}`,"_blank")},ie=!!ke();return e.jsxs("div",{className:"border-b-token-border-default flex w-full justify-between gap-2 border-b p-3 transition-colors duration-50",children:[e.jsxs("div",{className:"flex min-w-0 flex-shrink max-md:gap-2",children:[a?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"hover:bg-token-bg-tertiary group-radix-state-open:bg-token-bg-tertiary rounded-sm p-2 font-semibold",onClick:a,"aria-label":x.formatMessage({id:"wham.taskPageHeader.goBack",defaultMessage:"Go back to tasks"}),children:e.jsx(ha,{className:"icon-lg text-token-text-secondary"})}),e.jsx("div",{className:"bg-token-border-default my-auto ms-[11px] me-4 h-4 w-[1px] max-md:hidden"})]}):e.jsx("div",{className:"ms-3"}),e.jsx(La,{title:i,assistantTurn:s})]}),e.jsxs("div",{className:"relative flex h-10 items-center gap-1.5",children:[!1,o&&s?.id&&e.jsx(Pa,{taskId:t}),L&&s?.id&&m&&(ie?e.jsx(Ee,{icon:r?.archived?Ke:Ae,onClick:()=>r?.archived?K():de(),disabled:ce,"aria-label":r?.archived?x.formatMessage({id:"wham.whamTaskPageHeader.ariaLabelUnarchive",defaultMessage:"Unarchive Task"}):x.formatMessage({id:"wham.whamTaskPageHeader.ariaLabelArchive",defaultMessage:"Archive Task"})}):e.jsx(ae,{color:"ghost",icon:r?.archived?Ke:Ae,loading:ce,onClick:()=>r?.archived?K():de(),"aria-label":r?.archived?x.formatMessage({id:"wham.whamTaskPageHeader.ariaLabelUnarchive",defaultMessage:"Unarchive Task"}):x.formatMessage({id:"wham.whamTaskPageHeader.ariaLabelArchive",defaultMessage:"Archive Task"}),children:r?.archived?e.jsx(w,{id:"wham.whamTaskPageHeader.unarchive",defaultMessage:"Unarchive"}):e.jsx(w,{id:"wham.whamTaskPageHeader.archive",defaultMessage:"Archive"})})),n&&s?.id&&e.jsx(Ta,{taskId:t,turnId:s?.id,isDisabled:!1,title:i??""}),d==="write"&&!ie&&e.jsx(fa,{taskId:t}),S.length>0&&h&&e.jsx(Fa,{isCreatingPr:f,assistantTurn:s,copyApplyToClipboard:ue,copyPatchToClipboard:je,createPr:fe,navigateToCreatingPrPage:he,canCreatePr:A,updateBranch:W?Pe:void 0,permissions:d}),!ie&&h&&e.jsx(ma,{})]})]})}function Oa(t){const r={},s={};let a;for(const o of t)et(o)?o.previous_turn_id?s[o.previous_turn_id]=o:a=o:o.previous_turn_id&&(r[o.previous_turn_id]??=[]).push(o);if(!a)return null;const n=o=>{const d=r[o.id]??[],i={};for(const h of d){const f=s[h.id];f&&(i[h.id]=n(f))}return{userTurn:o,assistantTurns:d,children:i}};return n(a)}function Ha(t){for(let r=t.length-1;r>=0;r--){const s=t[r];if(et(s)&&s.previous_turn_id)return s.previous_turn_id}return null}function Ua(t,r){if(!r)return[];const s=a=>{for(const n of a.assistantTurns){if(n.id===r)return[{node:a,activeId:n.id}];const o=a.children[n.id],d=o&&s(o);if(d)return[{node:a,activeId:n.id},...d]}return null};return s(t)??[]}function Wa({className:t,focusedAssistantTurn:r,currentTab:s,permissions:a,task:n,turns:o,containerHeight:d,onClickFile:i,setFocusedAssistantTurnId:h,onTabChange:f,latestTurnRef:l,hasComments:b,clearComments:_,showFullDiff:v,loadingTurnMapping:j}){u.useEffect(()=>{if(!r){const g=Ha(o);g&&h(g)}},[r,o,h]);const x=u.useMemo(()=>Oa(o),[o]),P=u.useMemo(()=>x&&Ua(x,r?.id??null),[x,r]),m=u.useMemo(()=>{if(!x||!P)return[];const g=P.length>0?[...P]:[{node:x,activeId:x.assistantTurns[0]?.id??null}];let S=g[g.length-1];for(;S.activeId;){const M=S.node.children[S.activeId];if(!M)break;g.push({node:M,activeId:M.assistantTurns[0]?.id??null}),S=g[g.length-1]}return g},[x,P]),I=m.length-1,B=m.slice(0,I),O=Dt(m),H=O?.node.assistantTurns.some(g=>Ze(g.turn_status)),{data:y}=ht(n?.id),D=u.useMemo(()=>{if(!j||!y?.current_assistant_turn)return null;const g=y.current_assistant_turn,S=(g.sibling_turn_ids?.length??0)+1,M=g.attempt_placement??0,A=Array.from({length:S},(U,L)=>L===M?g.id:`placeholder-${L}`),E={};return A.forEach((U,L)=>E[U]=L),{attemptIds:A,idToIdxMap:E}},[j,y?.current_assistant_turn]);return e.jsx("div",{className:J("relative flex h-full w-full flex-col",t),children:e.jsx("div",{className:"flex h-fit min-h-full shrink-0 flex-col gap-6 pt-6 text-sm",children:j&&n&&y?.current_user_turn&&y?.current_assistant_turn?e.jsxs("div",{ref:l,className:J("flex min-h-full shrink-0 flex-col gap-6",H&&"pb-72"),style:{minHeight:d-24},children:[e.jsx("div",{className:"text-token-text-secondary flex w-full items-center justify-center gap-2",children:e.jsx(st,{className:"text-xl"})}),e.jsx(Te,{isLatest:!0,task:n,userTurn:y.current_user_turn,assistantTurns:[y.current_assistant_turn],selectedAssistantId:y.current_assistant_turn.id,focusedAssistantTurn:y.current_assistant_turn,setFocusedAssistantTurnId:h,onClickFile:i,currentTab:s,onTabChange:f,permissions:a,startOpen:!0,hasComments:b,clearComments:_,showFullDiff:v,attemptIdsOverride:D?.attemptIds,idToIndexMapOverride:D?.idToIdxMap})]}):e.jsxs(e.Fragment,{children:[B.length>0&&e.jsx("div",{className:"flex flex-col gap-6",children:B.map(({node:g,activeId:S},M)=>e.jsx(Te,{isLatest:M===I,task:n,userTurn:g.userTurn,assistantTurns:g.assistantTurns,selectedAssistantId:S,focusedAssistantTurn:r,setFocusedAssistantTurnId:h,onClickFile:i,startOpen:M===I,currentTab:s,onTabChange:f,permissions:a,hasComments:b,clearComments:_,showFullDiff:v},g.userTurn.id))}),O&&e.jsx("div",{ref:l,className:J("flex min-h-full shrink-0 flex-col gap-6",H&&"pb-72"),style:{minHeight:d-24},children:e.jsx(Te,{isLatest:!0,task:n,userTurn:O.node.userTurn,assistantTurns:O.node.assistantTurns,selectedAssistantId:r?.id??null,focusedAssistantTurn:r,setFocusedAssistantTurnId:h,onClickFile:i,currentTab:s,onTabChange:f,permissions:a,startOpen:!0,hasComments:b,clearComments:_,showFullDiff:v})})]})})})}function Ga({focusedAssistantTurn:t,pastTurns:r,showFullDiff:s}){if(!t)return[];const a=Qa(r),n=!s;if(Y(t,n).length>0)return ge({assistantTurn:t,followUp:n});if(Y(t,!1).length>0)return ge({assistantTurn:t,followUp:!1});if(Y(t,!0).length>0)return ge({assistantTurn:t,followUp:!0});let h=Ye(t,a);for(;h;){const f=a.get(h);if(f&&we(f)){const l=Y(f,!1),b=Y(f,!0);if(l.length>0||b.length>0){const _=l.length===0&&b.length>0;return ge({assistantTurn:f,followUp:_})}h=Ye(f,a)}else break}return[]}function Qa(t){const r=new Map;for(const s of t)r.set(s.id,s);return r}function Ye(t,r){const s=r.get(t.previous_turn_id??"");return s?s.previous_turn_id??null:null}const Xe=new Set,Fe=Lt(()=>Ft(()=>import("./tez9kd7scztwir0r.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35])).then(t=>t.WhamTaskPageCodeDiffContent),{loading:()=>e.jsx("div",{className:"flex-1"})});function ds({taskId:t,turnId:r,task:s,focusedAssistantTurn:a,pastTurns:n,canFollowUp:o,confirmClose:d,permissions:i,comments:h,setComments:f,clearComments:l,setConfirmClose:b,handleClose:_,setFocusedAssistantTurnId:v,showForkButton:j,loadingTurnMapping:x,showWorklogBar:P=!0}){const m=Q(),{data:I,isLoading:B}=mt(),O=be(),[{height:H},y]=pa(),D=u.useRef(null),g=u.useRef(null);Rt(()=>{const c=D.current,V=g.current;!c||!V||(c.scrollTop=c.scrollHeight,c.clientHeight>=V.clientHeight&&(c.scrollTop=V.offsetTop))},[n.length,x]),u.useEffect(()=>{const c=D.current;if(!c)return;c.scrollHeight-c.scrollTop-c.clientHeight<5&&c.scrollTo({top:c.scrollHeight,behavior:"smooth"})},[n.length]);const[S,M]=u.useState(void 0),A=u.useMemo(()=>Y(a,!0).length>0,[a]),[E,U]=It(Bt.WhamShowFullDiff,!A,$t),L=u.useMemo(()=>Ga({focusedAssistantTurn:a,pastTurns:n,showFullDiff:E}),[a,n,E]),$=u.useMemo(()=>a?a.output_items.filter(c=>c.type==="message").flatMap(c=>c.content).filter(c=>c.content_type==="image_asset_pointer_citation").map(c=>({asset_pointer:c.asset_pointer,width:c.width,height:c.height,size_bytes:c.size_bytes})):[],[a]),re=a?.turn_status==="failed",T=$.length>0,W=L.length>0,C=n[n.length-1],de=s?s.title??m.formatMessage({id:"wham.whamTaskPageContentLoaded.newTask",defaultMessage:"New Task"}):null,Me=se(),K=!!ke(),ne=K||I?.git_diff_mode==="unified",ce=ye(),ue=X(ce,"3673716873");u.useEffect(()=>{const c=a?.id;c&&!Xe.has(c)&&a?.turn_status==="completed"&&(Xe.add(c),R.markTurnViewed(t,c))},[a?.id,t,a?.turn_status]),u.useEffect(()=>{Fe.prefetch()},[B]);const{mutate:je}=te({mutationFn:c=>R.updateUserPreferences(c),onSuccess:async()=>{await gt(O)},onError:()=>{Me.danger({id:"wham.whamTaskPageContentLoaded.failedToUpdatePreferences",defaultMessage:"Failed to update preferences",description:"Failed to update preferences error message"},{toastId:"wham_task_page_content_loaded_failed_to_update_preferences"})}}),Pe=c=>{je({diffView:c?"unified":"split"})},fe=T?"preview":K?"chat":W?"diff":void 0,[he,ie]=u.useState(!1);!he&&s&&(ie(!0),M(fe));const p=a?.turn_status?Ze(a?.turn_status):null,G=u.useRef(!1);u.useEffect(()=>{p===!1?G.current=!0:p===!0&&G.current&&W&&M("diff")},[p]);const q=u.useMemo(()=>{if(re&&a?.environment_id&&a?.branch){const c=[...n].reverse().find(z=>z.type==="user"),Z=c?.input_items.find(z=>z.type==="message")?.content.find(z=>z.content_type==="text")?.text,lt=c?.input_items.filter(z=>z.type==="comment"),dt=(a?.sibling_turn_ids?.length??0)+1,ct=ra(c?.input_items??[]);return{environmentId:a?.environment_id,branch:a?.branch,previousTurnId:c?.previous_turn_id,prompt:Z??"",comments:lt??[],bestOfN:dt,attachments:ct}}},[re,a,n]),{attemptIndex:F,siblings:me}=u.useMemo(()=>{if(!a)return{attemptIndex:null,hasSiblingTurns:!1};const c=n.filter(Z=>we(Z)&&!!Z.sibling_turn_ids?.includes(a.id)),V=c.findIndex(Z=>Z.id===a.id);return{attemptIndex:V===-1?null:V+1,siblings:c}},[a,n]),Ue=i==="write"&&l?e.jsx(_a,{taskId:t,turnId:a?.id??r,comments:h??[],clearComments:l,focusedAssistantTurn:a,setFocusedAssistantTurnId:v,lastTurn:C,retry:q,attemptIndex:F,siblings:me??[]}):null,We=e.jsx("div",{ref:zt(y,D),className:"flex h-full w-full flex-col items-center overflow-y-auto px-6",children:e.jsxs("div",{className:J("w-full",qe),children:[e.jsx(Wa,{focusedAssistantTurn:a,currentTab:S,permissions:i,task:s,turns:n,containerHeight:H,onClickFile:()=>M("diff"),setFocusedAssistantTurnId:v,onTabChange:M,latestTurnRef:g,hasComments:(h?.length??0)>0,clearComments:l,showFullDiff:E,loadingTurnMapping:x}),Ue&&e.jsx("div",{className:"keyboard-open:fixed absolute start-0 end-0 bottom-0",children:Ue})]})}),Ge=e.jsx("div",{className:"relative flex h-full w-full flex-col",children:e.jsxs(Zt,{onChange:M,currentTab:S,defaultTab:fe,tabs:[{key:"chat",isHidden:!K,label:m.formatMessage({id:"wham.whamTaskPageContentLoaded.conversation",defaultMessage:"Conversation"}),ariaLabel:m.formatMessage({id:"wham.whamTaskPageContentLoaded.conversationAriaLabel",defaultMessage:"Tab to view the conversation with the assistant"}),children:We},{key:"preview",isHidden:$.length===0,label:m.formatMessage({id:"wham.whamTaskPageContentLoaded.preview",defaultMessage:"Preview"}),ariaLabel:m.formatMessage({id:"wham.whamTaskPageContentLoaded.previewAriaLabel",defaultMessage:"Tab to view preview images"}),children:e.jsx(wa,{previewImages:$})},{key:"diff",isHidden:!W,label:m.formatMessage({id:"wham.whamTaskPageContentLoaded.diff",defaultMessage:"Diff"}),ariaLabel:m.formatMessage({id:"wham.whamTaskPageContentLoaded.diffAriaLabel",defaultMessage:"Tab to view the code diff"}),children:!B&&W&&e.jsx(Fe,{diffFiles:L,unifiedDiff:ne,enableComments:o,comments:h,setComments:f})},{key:"logs",isHidden:!P,label:m.formatMessage({id:"wham.whamTaskPageContentLoaded.logs",defaultMessage:"Logs"}),ariaLabel:m.formatMessage({id:"wham.whamTaskPageContentLoaded.logsAriaLabel",defaultMessage:"Tab to view the work logs"}),children:e.jsx(na,{taskId:t,focusedAssistantTurn:a,agentNetworkAccess:a?.environment?.agent_network_access})},{key:"internal_rollout",isHidden:a?.internal_only_rollouts==null||!0,label:m.formatMessage({id:"wham.whamTaskPageContentLoaded.internalRollout",defaultMessage:"Internal Rollout"}),ariaLabel:m.formatMessage({id:"wham.whamTaskPageContentLoaded.internalRolloutAriaLabel",defaultMessage:"Tab to view the internal rollout information"}),children:e.jsx("div",{className:"flex h-full w-full overflow-auto p-4",children:e.jsx(Jt,{json:a?.internal_only_rollouts??void 0,jsonViewProps:{collapsed:5}})})}],children:[e.jsx(ea,{withUnderline:K,className:"items-center border-b p-3 pe-16 max-md:py-0",children:W&&e.jsx(xa,{unifiedDiff:ne,setUnifiedDiff:Pe,showFullDiff:E,setShowFullDiff:U})}),e.jsx(ta,{children:({content:c})=>e.jsx("div",{className:"flex h-full w-full",children:c})})]},a?.id??t)});return e.jsxs(e.Fragment,{children:[e.jsxs(tt.div,{className:J("relative flex size-full flex-1 flex-col items-center",K?"[--right-bg:var(--bg-primary)]":"[--right-bg:var(--bg-tertiary)] dark:[--right-bg:black]"),...Yt,children:[e.jsx(qa,{title:de,taskId:t,task:s,focusedAssistantTurn:a,onClose:_?()=>_?.({force:!0}):void 0,permissions:i,shouldShowShare:ue&&i==="write",shouldShowFork:!!j,showGitActions:P}),e.jsx("div",{className:"bg-token-bg-primary flex min-h-0 w-full flex-1",children:!s||!he?e.jsx(Et,{}):K?Ge:e.jsx(ia,{leftContent:We,rightContent:P?S?e.jsxs("div",{className:"relative h-full w-full bg-[var(--right-bg)]",children:[Ge,e.jsx(Xt,{className:"absolute end-3 top-2.5",icon:e.jsx(qt,{}),label:m.formatMessage({id:"wham.whamTaskPageContentLoaded.close",defaultMessage:"Close"}),onClick:()=>M(void 0)})]}):void 0:e.jsx("div",{className:"relative h-full w-full bg-[var(--right-bg)]",children:e.jsx(Fe,{diffFiles:L,unifiedDiff:ne,enableComments:o,comments:h,setComments:f})})})})]}),d&&b&&_&&e.jsx(oa,{setConfirmClose:b,handleClose:_})]})}export{ds as W,ls as u};
//# sourceMappingURL=f6knvt2j41ilvchg.js.map
