import{h0 as F,B as j,bg as M,G as y,lI as I}from"./hml6mmd5fyx85si7.js";import{e as x,r as g,j as e,M as u,ai as P}from"./lu2xqwqmjc95q6j6.js";import{d7 as B,a4 as f,cg as S}from"./rseqzngxzbdt1oxg.js";import{F as v}from"./fzsd6jg1rz4e0r8i.js";import{S as _,a as V}from"./ezlg48t9e1qt7u4e.js";import{u as w}from"./dvwl6sjz4dphxr01.js";import{u as b}from"./gg4nenc5n8jr6d7h.js";import{u as k,x as L}from"./ktoofw7mjru0a6r5.js";import{W as E}from"./grzmcn0q8182ltoo.js";import"./fsu81ov1h2xmh0dx.js";import"./blhqqdzhd9z6fst7.js";import"./lsmgulr8t4c2ohfe.js";import"./isxemcalu9537a8n.js";import"./fd9rmcpa6ai71fe6.js";import"./ik8y7nlve9mzjttb.js";import"./e0pswmo7irlt62pp.js";import"./gjid53jxmuj8a8kw.js";import"./gnhjnh2n0u3gy6qx.js";import"./ejklrllfl9wcn2za.js";import"./n0u5fqw2jde51umw.js";import"./k1vf300nfu1glkjf.js";import"./oevbdyhdaqh4lk1q.js";import"./cll46xg89nxc0ghy.js";import"./d8r48c27g352nr7t.js";function A(){const t=x();return(a,s,m)=>{const i=(a.match(/{/g)??[]).length,d=(a.match(/}/g)??[]).length;if(i!==d)return t.formatMessage({id:"wham.branchFormat.bracketMismatch",defaultMessage:"Number of open brackets must match number of close brackets: {openBracketCount} != {closeBracketCount}"},{openBracketCount:i,closeBracketCount:d});if(i===0)return t.formatMessage({id:"wham.branchFormat.branchFormatMustContainAtLeastOnePatternForUniqueness",defaultMessage:"Branch format must contain at least one pattern, for uniqueness"});const l=m.map(o=>o.value),r=a.match(/{([^}]+)}/g)??[];for(const o of r)if(!l.includes(o))return t.formatMessage({id:"wham.branchFormat.invalidPattern",defaultMessage:"{pattern} is not a valid pattern"},{pattern:o});let n=a;if(m.forEach(o=>{const h=o.char_count,p=new Array(h+1).join("x");n=n.replaceAll(o.value,p)}),n.length>s)return t.formatMessage({id:"wham.branchFormat.branchTooLong",defaultMessage:"Branch format is too long. Length ({length}) > Max Length ({maxLength})"},{length:n.length,maxLength:s});if(n.length===0)return t.formatMessage({id:"wham.branchFormat.branchFormatCannotBeEmpty",defaultMessage:"Branch format cannot be empty"});if(n.startsWith("/"))return t.formatMessage({id:"wham.branchFormat.customBranchNameCannotStartWith",defaultMessage:"Custom branch name cannot start with '/'"});if(!/^[a-zA-Z0-9./\-_]+$/.test(n))return t.formatMessage({id:"wham.branchFormat.branchFormatContainsInvalidCharacters",defaultMessage:"Branch format contains invalid characters"})}}function D({initialValue:t,setValue:c,patterns:a,isPending:s,hasChanges:m}){const i=x(),d=g.useMemo(()=>{let l=t;return a.forEach(r=>{l=l.replaceAll(r.value,r.example)}),l},[t,a]);return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(u,{id:"wham.branchFormat.label",defaultMessage:"Branch format"})}),e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(F,{name:"label",ariaLabel:i.formatMessage({id:"wham.branchFormat.ariaLabel",defaultMessage:"Branch format"}),className:"w-full",value:t,onChange:l=>c(l.target.value)}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsxs("div",{className:"text-token-text-secondary flex flex-col items-start justify-between text-xs",children:[e.jsx("p",{className:"font-medium",children:e.jsx(u,{id:"wham.branchFormat.examplePreview",defaultMessage:"Example: {branchName}",values:{branchName:d}})}),e.jsx("p",{children:e.jsx(u,{id:"wham.branchFormat.tagsHint",defaultMessage:"Tags available: <tags></tags>",values:{tags:()=>e.jsx("span",{children:"{feature}, {date}, {time}"})}})})]}),m&&e.jsx("div",{className:"flex items-start",children:e.jsx(j,{color:"primary",size:"medium",loading:s,disabled:!m,children:e.jsx(u,{id:"wham.branchFormatForm.save",defaultMessage:"Save"})})})]})]})})]})}function U(){const t=x();return(a,s)=>{if(a.length>s)return t.formatMessage({id:"wham.customInstructions.tooLong",defaultMessage:"Custom instructions are too long. Length ({length}) > Max Length ({maxCharacters})"},{length:a.length,maxCharacters:s})}}function W({value:t,setValue:c}){const a=x();return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(u,{id:"wham.customInstructions.label",defaultMessage:"Custom instructions"})}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx("textarea",{name:"description","aria-label":a.formatMessage({id:"wham.customInstructions.ariaLabel",defaultMessage:"Custom instructions"}),placeholder:a.formatMessage({id:"wham.customInstructions.placeholder",defaultMessage:"Example: Run tests and linters for every code change but not when changing code comments or documentation"}),className:"border-token-border-heavy focus-within:border-token-border-heavy focus-within:ring-token-text-secondary bg-token-bg-primary h-42 max-h-96 min-h-16 w-full rounded-md border px-3 py-2 text-sm shadow-none focus-within:ring-1",value:t??"",onChange:s=>c(s.target.value)})}),t&&t.length>1e4?e.jsx(B,{type:"warning",children:a.formatMessage({id:"wham.customInstructions.longWarning",defaultMessage:"Long custom instructions eat into the agent's context window and can result in worse performance. Consider shortening your custom instructions or using AGENTS.md files to provide instructions scoped to specific parts of your codebase."})}):null]})}const z=[{value:"unified",icon:e.jsx(_,{className:"icon"})},{value:"split",icon:e.jsx(V,{className:"icon"})}];function H({value:t,setValue:c}){const a=x();return e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(u,{id:"wham.diffView.displayFormatLabel",defaultMessage:"Diff display format"})}),e.jsxs(f.Root,{value:t,onValueChange:c,children:[e.jsx(f.Trigger,{className:"border-token-border-heavy! bg-token-bg-primary! w-36 rounded-md! border","aria-label":a.formatMessage({id:"wham.diffView.openMenuAriaLabel",defaultMessage:"Open Diff view display format menu"}),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx(f.Value,{placeholder:t}),e.jsx(f.Icon,{})]})}),e.jsx(f.Portal,{children:e.jsx(f.Content,{align:"start",children:e.jsx("div",{className:"bg-token-bg-primary flex max-h-[400px] flex-col gap-2 overflow-y-auto rounded-lg p-2",children:z.map(s=>e.jsx(f.Item,{value:s.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.icon,s.value.charAt(0).toUpperCase()+s.value.slice(1)]})},s.value))})})})]})]})})}function O({initialValue:t,maxChars:c,isPending:a,updatePreferences:s}){const m=U(),[i,d]=g.useState(!1),l=w({defaultValues:{customInstructions:t??""},onSubmit:({value:r})=>{s({customInstructions:r.customInstructions}),d(!1)},validators:{onSubmit:({value:r})=>{const n={},o=m(r.customInstructions,c);return o&&(n.customInstructions=o),{fields:n}}}});return e.jsxs("form",{onSubmit:r=>{r.preventDefault(),l.handleSubmit()},children:[e.jsx("div",{id:"custom-instructions",className:"flex flex-col gap-2 pt-4",children:e.jsx(l.Field,{name:"customInstructions",children:r=>e.jsxs(e.Fragment,{children:[e.jsx(W,{value:r.state.value,setValue:n=>{r.handleChange(n),d(!0)}}),e.jsx(v,{field:r})]})})}),e.jsxs("div",{className:"flex h-10 items-start justify-between",children:[e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(u,{id:"wham.customInstructionsForm.description",defaultMessage:"Custom instructions are used to customize the behavior of the Codex model."})}),i&&e.jsx("div",{className:"flex items-center justify-end",children:e.jsx(j,{color:"primary",size:"medium",loading:a,disabled:!i,children:e.jsx(u,{id:"wham.customInstructionsForm.save",defaultMessage:"Save"})})})]})]})}function T({initialValue:t,maxLength:c,patterns:a,isPending:s,updatePreferences:m}){const i=A(),[d,l]=g.useState(!1),r=w({defaultValues:{branchFormat:t},onSubmit:({value:n})=>{m({branchFormat:n.branchFormat}),l(!1)},validators:{onSubmit:({value:n})=>{const o={},h=i(n.branchFormat,c,a);return h&&(o.branchFormat=h),{fields:o}}}});return e.jsx("form",{onSubmit:n=>{n.preventDefault(),r.handleSubmit()},children:e.jsx("div",{id:"branch-format",className:"flex flex-col gap-4",children:e.jsx(r.Field,{name:"branchFormat",children:n=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx(D,{initialValue:n.state.value,setValue:o=>{n.handleChange(o),l(!0)},patterns:a,isPending:s,hasChanges:d}),e.jsx(v,{field:n})]})})})})}function G({initialValue:t,updatePreferences:c}){const[a,s]=g.useState(t),m=i=>{s(i),c({diffView:i})};return e.jsx("div",{id:"diff-view",className:"flex flex-col",children:e.jsx(H,{value:a,setValue:m})})}function R(){return e.jsx("div",{className:"border-token-border-heavy flex items-center border-b",children:e.jsx("div",{className:"py-2 text-xl leading-7 font-medium",children:e.jsx(u,{id:"wham.preferencesHeader.general",defaultMessage:"General"})})})}function q(){const{data:t,isLoading:c,isError:a}=k(),{data:s,isLoading:m,isError:i}=L(),d=M(),l=x();g.useEffect(()=>{(a||i)&&d.danger({id:"wham.preferencesPage.preferencesLoadError",defaultMessage:"Failed to load preferences",description:"Failed to load user preferences error message"},{toastId:"wham_preferences_page_preferences_load_error"})},[a,i,l,d]);const{mutate:r,isPending:n}=b(),{mutate:o}=b(),{mutate:h,isPending:p}=b(),N=a||c||m||!t||!s,{eligible:C}=S();return C?e.jsx(P,{to:"/codex"}):e.jsx(E,{topPadding:!0,children:e.jsxs("div",{className:"mx-auto flex h-full max-w-screen-xl flex-1 flex-col gap-2 ps-4 pe-12",children:[e.jsx(R,{}),e.jsxs("div",{className:"flex max-w-full flex-col md:max-w-3/4 lg:max-w-1/2",children:[N?e.jsx("div",{className:"flex items-center justify-center pt-4",children:e.jsx(y,{className:"icon me-1.5"})}):e.jsxs("div",{className:"flex flex-col pb-16",children:[e.jsx(O,{initialValue:t.custom_instructions,maxChars:s.custom_instructions_max_chars,updatePreferences:r,isPending:n}),e.jsx("div",{className:"flex pt-4",children:e.jsx(G,{initialValue:t.git_diff_mode,updatePreferences:o})}),e.jsx("div",{className:"flex pt-8",children:e.jsx(T,{initialValue:t.branch_format,maxLength:s.branch_format_max_length,patterns:s.branch_format_special_values,updatePreferences:h,isPending:p})})]}),!1]})]})})}const pe=()=>[{title:"Codex"}],be=I(function(){return e.jsx(q,{})});export{be as default,pe as meta};
//# sourceMappingURL=kp1ny49w8i0shqtd.js.map
