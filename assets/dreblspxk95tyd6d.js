import{nM as j,bg as w,G as y,lI as b}from"./hml6mmd5fyx85si7.js";import{N as M,j as n,ai as N,e as C,a as k,l as A,n as F,M as u}from"./lu2xqwqmjc95q6j6.js";import{cg as W}from"./rseqzngxzbdt1oxg.js";import{R as P,I as r,S as l}from"./giudr1em7wff150c.js";import{E as R,R as T,g as U}from"./8t9v2t0jsmg3hg7s.js";import{u as I}from"./dftezuj2tl0ldqfs.js";import{c as D,W as O,a as B,d as L}from"./ktoofw7mjru0a6r5.js";import{W as $}from"./grzmcn0q8182ltoo.js";import"./bqtygptnp4i1kczw.js";import"./hl8o93vkogird41u.js";import"./dth89wjzf9gy8rh3.js";import"./dy6grwmx1xskr6sg.js";import"./dp7t1jmnbbend843.js";import"./fzsd6jg1rz4e0r8i.js";import"./bblylfc1c1w41kk7.js";import"./itjugg22bqh0ueps.js";import"./ifbdwgrs45s6gn7j.js";import"./d8r48c27g352nr7t.js";import"./em6xteal3laxzbp5.js";import"./dvwl6sjz4dphxr01.js";import"./fsu81ov1h2xmh0dx.js";import"./blhqqdzhd9z6fst7.js";import"./lsmgulr8t4c2ohfe.js";import"./isxemcalu9537a8n.js";import"./fd9rmcpa6ai71fe6.js";import"./ik8y7nlve9mzjttb.js";import"./e0pswmo7irlt62pp.js";import"./gjid53jxmuj8a8kw.js";import"./gnhjnh2n0u3gy6qx.js";import"./ejklrllfl9wcn2za.js";import"./n0u5fqw2jde51umw.js";import"./k1vf300nfu1glkjf.js";import"./oevbdyhdaqh4lk1q.js";import"./cll46xg89nxc0ghy.js";function q(){const{environmentId:s}=M(),{eligible:i}=W();return i?n.jsx(N,{to:"/codex"}):s?n.jsx(z,{environmentId:s}):n.jsx(j,{})}function z({environmentId:s}){const i=C(),o=w(),g=k(),m=A(),{data:e,isLoading:h,isError:v}=D(s),c=e?.secrets??{},x=I()?"workspace":"private",{mutate:E,isPending:_}=F({mutationFn:t=>O.updateEnvironment(s,t),onSuccess:async t=>{await B(m,s),L(m,s,t),o.success(i.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),g(`/codex/settings/environment/${s}`)},onError:()=>{o.danger({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment",description:"Toast to show when an environment is updated unsuccessfully"},{toastId:"wham_edit_environment_failed_to_update_environment"})}});function f(t){const a=U(t.secrets,c),S=t.envVars.reduce((d,p)=>(d[p.key]=p.value,d),{});E({label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,maintenance_setup:t.maintenanceSetupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,secrets:a,env_vars:S,auto_setup_settings:t.autoSetupSettings,cache_settings:t.cacheSettings})}return n.jsx($,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:h?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(y,{})}):v?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(u,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):e?n.jsxs(n.Fragment,{children:[n.jsxs(P,{className:"sticky top-0 px-4",children:[n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),n.jsx(l,{}),n.jsx(r,{label:e.label,url:`/codex/settings/environment/${s}`,className:"font-medium"}),n.jsx(l,{}),n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),n.jsx(R,{initialEnvironmentId:s,existingEnvironment:e,initialValues:{label:e?.label,description:e?.description??"",share_settings:e?.share_settings??x,machine:e?.machine_id,repositoryId:e?.repos[0],workspaceDirectory:e?.workspace_dir??"",agentNetworkAccess:e?.agent_network_access,setupCommands:e?.setup?Array.isArray(e?.setup)?e.setup.join(`
`):e.setup:"",maintenanceSetupCommands:e?.maintenance_setup?Array.isArray(e?.maintenance_setup)?e.maintenance_setup.join(`
`):e.maintenance_setup:"",envVars:Object.entries(e?.env_vars??{}).map(([t,a])=>({key:t,value:a})),secrets:Object.keys(c).map(t=>({key:t,value:T,isEditing:!1})),autoSetupSettings:e?.auto_setup_settings,cacheSettings:e?.cache_settings},primaryButtonText:i.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:f,isPending:_})]}):n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(u,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const Me=()=>[{title:"Codex"}],Ne=b(function(){return n.jsx(q,{})});export{Ne as default,Me as meta};
//# sourceMappingURL=dreblspxk95tyd6d.js.map
