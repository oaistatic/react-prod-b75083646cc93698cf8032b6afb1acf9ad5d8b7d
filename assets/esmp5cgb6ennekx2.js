import{a as S,c as E,h0 as A,b2 as T,B as C,ea as L,b5 as B,c6 as R,eT as W,d as I,h1 as F,G as z,lI as H}from"./hml6mmd5fyx85si7.js";import{e as k,r as p,j as e,M as g,a as D,ai as V}from"./lu2xqwqmjc95q6j6.js";import{a3 as G,cg as Y}from"./rseqzngxzbdt1oxg.js";import{O as _,a as U}from"./mq6plbvmoyjf88pf.js";import{I as Z}from"./dth89wjzf9gy8rh3.js";import{g as M}from"./nhs24pb9s8hnfshq.js";import{C as q}from"./ie3rd9r6lvy1aydu.js";import{a as J}from"./kyavoy07nhuntf5e.js";import{s as K,t as O,h as N}from"./ktoofw7mjru0a6r5.js";import{W as Q}from"./grzmcn0q8182ltoo.js";import"./bqtygptnp4i1kczw.js";import"./hl8o93vkogird41u.js";import"./dy6grwmx1xskr6sg.js";import"./dp7t1jmnbbend843.js";import"./fzsd6jg1rz4e0r8i.js";import"./bblylfc1c1w41kk7.js";import"./n0u5fqw2jde51umw.js";import"./gfoh7wlnbf9lnrwe.js";import"./gg4nenc5n8jr6d7h.js";import"./cmrw6vecibj401se.js";import"./dvwl6sjz4dphxr01.js";import"./fsu81ov1h2xmh0dx.js";import"./blhqqdzhd9z6fst7.js";import"./lsmgulr8t4c2ohfe.js";import"./isxemcalu9537a8n.js";import"./fd9rmcpa6ai71fe6.js";import"./ik8y7nlve9mzjttb.js";import"./e0pswmo7irlt62pp.js";import"./gjid53jxmuj8a8kw.js";import"./gnhjnh2n0u3gy6qx.js";import"./ejklrllfl9wcn2za.js";import"./k1vf300nfu1glkjf.js";import"./oevbdyhdaqh4lk1q.js";import"./cll46xg89nxc0ghy.js";import"./d8r48c27g352nr7t.js";function X({selectedTab:n,onChange:s}){const a=k(),o=S(),i=E(o,"2665240312"),m=p.useCallback(d=>{s(d)},[s]);return e.jsx("div",{className:"border-token-border-primary flex w-full items-center border-b align-middle",children:i&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(J,{currentTab:n,onChange:m,withUnderline:!0,tabs:[{label:a.formatMessage({id:"wham.selectEnvironmentHeader.create",defaultMessage:"Existing environments"}),key:"select"},{label:a.formatMessage({id:"wham.selectEnvironmentHeader.select",defaultMessage:"New environment"}),key:"create"}]})})})}function $({environment:n,isSelected:s,className:a}){return e.jsxs("div",{className:I("flex items-center justify-between gap-2",a),children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-token-text-primary text-start text-sm font-medium",children:n.label}),n.creator.email&&e.jsx("p",{className:"text-token-text-tertiary text-start text-xs leading-tight font-normal",children:e.jsx(g,{id:"wham.createEnvironments.environmentSection.createdBy",defaultMessage:"{email}",values:{email:n.creator.name}})})]}),e.jsx("div",{className:"text-token-text-secondary text-start text-sm leading-tight font-normal",children:n.description})]}),s?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(F,{className:"h-5 w-5"})}):e.jsx("div",{className:"w-4"})]})}function ee({environment:n,isSelected:s,onClick:a}){return e.jsx("button",{className:I("group flex w-full items-center justify-between gap-2 py-4","hover:bg-token-bg-tertiary cursor-pointer p-2"),onClick:a,type:"button",children:e.jsx($,{environment:n,isSelected:s,className:"w-full"})})}function f(){return e.jsx("div",{className:"flex w-full items-center justify-between gap-2 rounded-md",children:e.jsx(G,{className:"h-14 w-full"})})}const te=10;function ne({handleGoBack:n,handleSelectEnvironment:s,goToNextPage:a}){const o=k(),[i,m]=p.useState(""),d=S(),x=E(d,"2673860158"),{data:c,isLoading:v,fetchNextPage:w,hasNextPage:b,isFetchingNextPage:y}=O({pageSize:te,enforceRepoAccess:x}),l=p.useMemo(()=>c?.pages.flatMap(t=>t.items??[])??[],[c]),u=l.filter(t=>t.label.toLowerCase().includes(i.toLowerCase())),h=N(t=>t.environmentId),j=N(t=>t.setEnvironmentId);return p.useEffect(()=>{if(h){const t=l.find(r=>r.id===h);t?s(t.id,M(t)):j(null)}else l.length===1&&(j(l[0].id),s(l[0].id,M(l[0])))},[h,l,s,j]),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx(A,{color:"search",iconPosition:"left",icon:T,className:"text-token-text-tertiary flex h-10 w-full items-center rounded-lg! p-3!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-envs",type:"text",value:i,onChange:t=>m(t.target.value),placeholder:o.formatMessage({id:"wham.environmentSection.searchPlaceholder",defaultMessage:"Search"}),ariaLabel:o.formatMessage({id:"wham.environmentSection.searchAria",defaultMessage:"Search"})})}),e.jsx("div",{className:"border-token-border-heavy flex flex-col gap-2 rounded-lg border p-2",children:e.jsx("div",{className:"flex h-96 flex-col overflow-y-auto",children:v?e.jsxs("div",{className:"flex h-full flex-col gap-2",children:[e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{}),e.jsx(f,{})]}):e.jsxs(e.Fragment,{children:[u.length===0&&!b?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center",children:[e.jsx("p",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(g,{id:"wham.codexOnboardingEnvironments.noEnvironments",defaultMessage:"No environments found"})}),e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(g,{id:"wham.codexOnboardingEnvironments.noEnvironmentsDescription",defaultMessage:"You will be able to create more environments in settings later"})})]}):u.map((t,r)=>e.jsxs("div",{children:[e.jsx(ee,{environment:t,isSelected:h===t.id,onClick:()=>s(t.id,M(t))}),r!==u.length-1&&e.jsx("div",{className:"border-token-border-light border-t"})]},t.id)),e.jsx(Z,{isFetchingNextPage:y,hasNextPage:b??!1,fetchNextPage:w,bgColor:"dark:bg-token-bg-secondary"})]})})}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx(C,{color:"secondary",size:"medium",type:"button",onClick:n,children:e.jsx(g,{id:"wham.codexOnboardingEnvironments.back",defaultMessage:"Back"})}),e.jsx(C,{color:"primary",size:"medium",disabled:!h,onClick:a,children:e.jsx(g,{id:"wham.codexOnboardingEnvironments.useEnvironment",defaultMessage:"Use environment"})})]})]})}function se(){const n=k(),s=L(),i=B()?.name??n.formatMessage({id:"wham.codexOnboardingEnvironments.workspaceName",defaultMessage:"Workspace"});return e.jsx(R,{label:n.formatMessage({id:"wham.codexOnboardingEnvironments.environmentExistsTooltip",defaultMessage:"An environment has already been created for {workspaceName}. You’ll be able to create a new environment later for this repo in settings."},{workspaceName:i}),children:e.jsxs("div",{className:"bg-token-bg-tertiary text-token-text-tertiary inline-flex items-center justify-center gap-1 rounded-3xl py-1.5 ps-1.5 pe-1.5",children:[e.jsx(W,{className:"icon-sm"}),!s&&e.jsx("div",{className:"justify-start pe-1 text-xs leading-3 font-medium",children:e.jsx(g,{id:"wham.codexOnboardingEnvironments.environmentExists",defaultMessage:"Environment already exists"})})]})})}function ae({handleGoBack:n,handleSelectEnvironment:s,goToNextPage:a}){const o=k(),[i,m]=p.useState("select"),{data:d}=K(),x=c=>d?.some(v=>v.repos.includes(c.id))??!1;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(q,{title:o.formatMessage({id:"wham.codexOnboardingEnvironments.selectEnvironment",defaultMessage:"Select an environment"}),description:o.formatMessage({id:"wham.codexOnboardingEnvironments.selectEnvironment.description",defaultMessage:"Environments configure the container for the agent to run. Not seeing your repo? You can create new environments in settings later."})}),e.jsx("div",{className:"pb-4",children:e.jsx(X,{selectedTab:i,onChange:c=>{m(c)}})}),i==="select"?e.jsx(ne,{handleGoBack:n,handleSelectEnvironment:s,goToNextPage:a}):e.jsx(_,{backCta:o.formatMessage({id:"wham.codexOnboardingEnvironments.back",defaultMessage:"Back"}),lockPageView:()=>{},handleGoBack:n,handleSelectEnvironment:s,goToNextPage:a,shouldDisableRow:x,disablePill:e.jsx(se,{})})]})}function oe(){return e.jsx("div",{className:"mx-auto flex h-full max-w-4xl flex-col p-8 md:p-24",children:e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-2",children:[e.jsx(g,{id:"wham.codexOnboardingEnvironments.loading",defaultMessage:"Almost there…"}),e.jsx(z,{})]})})}function ie(){const{eligible:n,isLoading:s}=Y(),a=S(),o=E(a,"2673860158"),i=E(a,"2395384117"),{data:m,isLoading:d}=O({pageSize:1,enforceRepoAccess:o}),x=D(),[c,v]=p.useState(!1),w=()=>{x("/codex/onboarding/connections")},b=()=>{x(i?"/codex/onboarding/starter-tasks":"/codex/onboarding/data-check")},y=N(r=>r.setEnvironmentId),l=N(r=>r.setBranch),u=(r,P)=>{y(r),l(P)},j=(m?.pages.flatMap(r=>r.items).length??0)>0;if(s||d)return e.jsx(oe,{});if(!n)return e.jsx(V,{to:"/codex"});const t=!c&&j&&!0;return e.jsx(Q,{showSidebar:!1,canShowAlert:!1,hideExtraHeaderInfo:!0,children:e.jsx("div",{className:"mx-auto flex max-w-3xl flex-col gap-2 p-12",children:t?e.jsx(ae,{handleGoBack:w,handleSelectEnvironment:u,goToNextPage:b}):e.jsx(U,{handleGoBack:w,handleSelectEnvironment:u,goToNextPage:b,lockPageView:()=>v(!0)})})})}const Ve=()=>[{title:"Codex"}],Ge=H(function(){return e.jsx(ie,{})});export{Ge as default,Ve as meta};
//# sourceMappingURL=esmp5cgb6ennekx2.js.map
