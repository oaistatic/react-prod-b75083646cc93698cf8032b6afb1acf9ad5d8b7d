import{e as G,r as a,j as e,d as P}from"./lu2xqwqmjc95q6j6.js";import{c7 as L,c8 as y,ai as _,an as B,c9 as H,am as z,ca as h,cb as i,cc as O,cd as Q,ap as V,aq as W,ar as Y,as as Z,ce as J,at as K,av as X}from"./rseqzngxzbdt1oxg.js";import{I as $}from"./f251sy8gvgjvi4td.js";import{S as ee}from"./lao8y60wfyizx9bl.js";import"./hml6mmd5fyx85si7.js";import"./iq82wz84d1fxj03i.js";import"./elolu96rnfzqcgif.js";import"./kcqshnk26ykm1u4n.js";import"./fibktxptqydbr54o.js";import"./6a3e5rtr9pyzi31y.js";import"./ogr5nmy9hq7gfgq0.js";import"./cqyjjngibokvfw83.js";import"./ik8y7nlve9mzjttb.js";import"./isxemcalu9537a8n.js";import"./ejklrllfl9wcn2za.js";const D=P({thumbsUp:{id:"Qz8Wa6",defaultMessage:"Like this image"},thumbsDown:{id:"sUGtRy",defaultMessage:"Dislike this image"}}),ae=t=>H({pointer:{url:t.url,asset_pointer:t.assetPointer??"",metadata:{dalle:{gen_id:t.transformationId??void 0},generation:{gen_id:t.transformationId??void 0}},width:t.width,height:t.height},conversationId:t.conversationId,messageId:t.messageId??"",source:"chat"}),Ie=({images:t,initialIndex:f,onClose:I,onRequestCompletion:j,clientThreadId:k,currentModelId:S})=>{const n=G(),M=L(),[o,b]=a.useState(null),[d,g]=a.useState(null),[N,R]=a.useState(f),[x,u]=a.useState("default"),r=y(),v=a.useRef(null),m=a.useRef(r);a.useEffect(()=>{m.current=r},[r]);const F=a.useCallback(l=>{g(null),b(null),R(l),u("default"),m.current.clearAllDrawings()},[]),w=a.useCallback(()=>_(n),[n]),c=a.useCallback((l,p)=>{!p||o!=null||(B.imageRated({liked:l,analyticsContext:ae(p)}),b(l),l||g(p))},[o]),s=t[N],C=a.useCallback(()=>{u("default"),m.current.clearAllDrawings()},[]),T=a.useCallback(()=>{c(!0,s)},[c,s]),U=a.useCallback(()=>{!s||o!=null||c(!1,s)},[c,s,o]),q=a.useCallback(()=>{s&&u("inpaint")},[s]),E=a.useCallback(()=>{s&&z({url:s.url,fileName:w()})},[s,w]),A=a.useCallback(()=>v.current?.getImageData(),[]);return e.jsxs(e.Fragment,{children:[e.jsxs(h.Root,{images:t,initialIndex:f,onClose:I,onIndexChange:F,inpaintingProps:{mode:x,drawingState:r,drawingCanvasRef:v},children:[e.jsx(h.LightboxHeaderActions,{children:x==="inpaint"?e.jsxs("div",{className:"grid grow grid-cols-[1fr_auto] items-center gap-2",children:[e.jsx("div",{className:"text-center font-semibold",children:n.formatMessage({id:"TjVqYb",defaultMessage:"Edit Selection"})}),e.jsxs("div",{className:"flex gap-1 justify-self-end md:gap-2",children:[e.jsx(i,{className:"aspect-square",icon:O,onClick:r.undoDrawing,disabled:!r.canUndoDrawing,"aria-label":n.formatMessage({id:"OmaTPx",defaultMessage:"Undo"})}),e.jsx(i,{className:"aspect-square",icon:Q,onClick:r.redoDrawing,disabled:!r.canRedoDrawing,"aria-label":n.formatMessage({id:"ZUr4oh",defaultMessage:"Redo"})}),e.jsx(i,{className:"w-auto px-3",onClick:C,children:n.formatMessage({id:"D9xvar",defaultMessage:"Cancel"})})]})]}):e.jsxs("div",{className:"flex gap-1 md:gap-2",children:[o!==!1&&e.jsx(i,{className:"aspect-square",icon:o===!0?V:W,onClick:T,"aria-label":n.formatMessage(D.thumbsUp)}),o!==!0&&e.jsx(i,{className:"aspect-square",icon:o===!1?Y:Z,onClick:U,"aria-label":n.formatMessage(D.thumbsDown)}),e.jsx(i,{className:"aspect-square",icon:J,onClick:q,"aria-label":n.formatMessage({id:"pRGwlp",defaultMessage:"Edit image"})}),e.jsx(i,{className:"aspect-square",icon:K,onClick:E,"aria-label":n.formatMessage({id:"9DNHka",defaultMessage:"Download image"})}),M()&&s?.messageId&&e.jsx(ee,{assetPointer:s.assetPointer,serverThreadId:s.conversationId,messageId:s.messageId})]})}),e.jsx(h.Footer,{children:e.jsx($,{clientThreadId:k,currentModelId:S,onRequestCompletion:j,onClose:I,activeImage:s,currentDrawnShape:r.currentDrawnShape,getImageData:A,onCancelInpaint:C})})]}),d&&e.jsx(X,{messageId:d.messageId??"",serverThreadId:d.conversationId,rating:o,onClose:()=>g(null)})]})};export{Ie as ImageGenConversationLightboxNew};
//# sourceMappingURL=tjh4axf25w6zyz2r.js.map
