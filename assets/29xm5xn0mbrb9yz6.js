import{r as A,e as P,j as t,d as k}from"./lu2xqwqmjc95q6j6.js";import{a as B,b6 as W,aH as $,hA as q,J as V,k4 as D,h9 as J,hx as K,d as h,G as Q,c0 as X,gH as N}from"./hml6mmd5fyx85si7.js";import{e4 as U,e5 as Y,aj as Z,bN as ee,e6 as se,d_ as ae,e7 as te,e8 as ne}from"./rseqzngxzbdt1oxg.js";function oe({asset:s,contextConnectorSourceUrl:d,disableExpandable:i=!1,isSingle:r,isUserTurn:u,className:n}){const a=B(),c=W(a).flags,[x,e]=A.useState(!1),{isUnauthenticated:o}=$(),m=c?.includes(q.NoAuthEnableFileUploads),L=V(s.asset_pointer),l=U.useState(O=>U.selectFile(O,L)),p=Y(l?.file??null,l?.file.name,l?.fileId??void 0,l?.gizmoId,l?.contextConnectorInfo,!0),F=o&&l&&m,{gizmoEditorData:w}=D(),C=Z(),E=A.useContext(J)?.serverSharedThreadId&&u,R=K(),{isOpen:z}=ee(),M=P(),{data:G,isLoading:_,error:H}=se({asset:s,gizmoId:w?.id,getServerUrl:!F}),{url:v,width:f,height:I}=p&&m?{width:s.width,height:s.height,url:p}:G??{},T=_||!x,y=f&&I?{Landscape:f>I,Portrait:f<I}:void 0,g=["overflow-hidden rounded-lg"];if(r&&(g.push("w-full h-full"),y?.Landscape?g.push("max-w-96 max-h-64"):y?.Portrait?g.push("max-h-96 max-w-64"):g.push("max-w-64 max-h-64")),n&&g.unshift(n),E&&R())return null;let S;return v!=null&&(S=t.jsx(ae,{alt:M.formatMessage(j.imageAltText),className:h(z?"max-w-[88px]":"max-w-full",!r&&"aspect-square","object-cover object-center",g),src:v,width:f,height:I,onLoad:()=>e(!0)}),!C&&!i&&(S=t.jsx(te,{src:v,alt:M.formatMessage(j.imageAltText),contextConnectorSourceUrl:d,className:h(g),children:S}))),t.jsx("div",{className:h(g),children:t.jsx("div",{className:h("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!r&&"aspect-square"),children:v!=null?S:t.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:`${f} / ${I}`,width:f},title:T?M.formatMessage(j.loadingImage):M.formatMessage(j.errorLoadingImage),children:T?t.jsx(Q,{}):H?t.jsx(X,{className:"icon-sm"}):null})})})}const j=k({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function b({assets:s,attachments:d,isUserTurn:i=!0,clientThreadId:r}){const u=s.length===1,{containerClassname:n,imageClassnames:a}=b.computeClassnames(s.length);let c=N.ATTACHMENT;return s&&!(d&&d.length>0)&&(c=N.IMAGE),t.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[t.jsx("div",{className:h("flex flex-row items-center justify-end gap-1",n),children:s.map((x,e)=>{const o=d?.find(m=>m.id&&x.asset_pointer.includes(m.id));return t.jsx(oe,{asset:x,isSingle:u,isUserTurn:i,contextConnectorSourceUrl:o?.context_connector_info?.source_url,className:a[e]},e)})}),t.jsx(ne,{featureType:c,isUserTurn:i,clientThreadId:r})]})}b.computeClassnames=s=>{if(s<2)return{containerClassname:null,imageClassnames:[]};let d=s>=4?"flex-wrap":"";const i=Array(s),r=e=>{i.fill(e)},u=e=>{d+=` ${e}`},n=(e,o)=>{i[e]=h(i[e],o)},a=s<=4&&s%2===0?2:3,c=Math.ceil(s/a),x=s%a!==0;a===2?(r("h-32 w-32"),u("max-w-72")):c<=2?(r("h-24 w-24 sm:h-32 sm:w-32"),u("max-w-80 sm:max-w-100")):(r("h-16 w-16"),u("max-w-52"));for(let e=0;e<s;e++){const o=Math.floor(e/a),m=e%a,L=Math.min(s-o*a,a),l=o===0,p=o===c-1,F=o===c-2,w=m===0,C=m===L-1;l&&w&&n(e,"rounded-ss-2xl"),l&&C&&n(e,"rounded-se-2xl"),p&&w&&n(e,"rounded-es-2xl"),p&&C&&n(e,"rounded-ee-sm"),x&&w&&F&&n(e,"rounded-es-2xl")}return{containerClassname:d,imageClassnames:i}};export{b as TextMessageImageGroup};
//# sourceMappingURL=29xm5xn0mbrb9yz6.js.map
