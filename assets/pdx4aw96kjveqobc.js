import{kK as A,a as G,c as O,eT as R,B as _,c9 as S,h0 as H,d as u,cY as L,c6 as k,G as q,lI as W,nM as F}from"./hml6mmd5fyx85si7.js";import{j as e,e as B,r as f,M as a,ak as C}from"./lu2xqwqmjc95q6j6.js";import{W as D,u as V}from"./grzmcn0q8182ltoo.js";import{u as y}from"./bblylfc1c1w41kk7.js";import{a4 as h,B as z,eu as $,a3 as N}from"./rseqzngxzbdt1oxg.js";import{y as K,z as E,A as Q,u as Y}from"./ktoofw7mjru0a6r5.js";import{T as l}from"./l2fd3uykkvam5v10.js";import J from"./c0kkgurrfmqji7ye.js";import{I as X}from"./dth89wjzf9gy8rh3.js";import{u as Z}from"./gfoh7wlnbf9lnrwe.js";import{u as ee}from"./gg4nenc5n8jr6d7h.js";import"./lsmgulr8t4c2ohfe.js";import"./isxemcalu9537a8n.js";import"./fd9rmcpa6ai71fe6.js";import"./ik8y7nlve9mzjttb.js";import"./e0pswmo7irlt62pp.js";import"./gjid53jxmuj8a8kw.js";import"./gnhjnh2n0u3gy6qx.js";import"./ejklrllfl9wcn2za.js";import"./n0u5fqw2jde51umw.js";import"./k1vf300nfu1glkjf.js";import"./oevbdyhdaqh4lk1q.js";import"./cll46xg89nxc0ghy.js";import"./d8r48c27g352nr7t.js";import"./fsu81ov1h2xmh0dx.js";import"./blhqqdzhd9z6fst7.js";function se({value:s,options:t,disabled:i,onChange:n}){const o=t.find(r=>r.value===s);return e.jsxs(h.Root,{value:s,onValueChange:r=>n(r),disabled:i,children:[e.jsxs(h.Trigger,{className:"w-fit",children:[e.jsx("div",{className:"text-sm font-normal",children:o?.title}),e.jsx(h.Icon,{})]}),e.jsx(h.Portal,{children:e.jsx(h.Content,{children:t.map(r=>e.jsx(h.Item,{value:r.value,children:e.jsxs("div",{className:"flex min-w-[360px] flex-col",children:[e.jsx("span",{className:"text-sm font-normal",children:r.title}),e.jsx("span",{className:"text-token-text-tertiary text-xs",children:r.description})]})},r.value))})})]})}function te({isSaving:s,initialScope:t,onChange:i}){const n=B(),o=y(),[r,c]=f.useState(t);return e.jsx("section",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-sm font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.autoReviewMyPRs",defaultMessage:"Review my pull requests"})}),e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(a,{id:"wham.codeReviewPage.autoReviewMyPRs.description",defaultMessage:"Codex automatically suggests improvements (or reacts with 👍)"})})]}),e.jsx(se,{value:r,options:[{value:"never",title:n.formatMessage({id:"wham.codeReviewPage.autoReview.optionOff",defaultMessage:"Off"}),description:n.formatMessage({id:"wham.codeReviewPage.autoReview.optionAll",defaultMessage:"Across all repos"})},{value:"always",title:n.formatMessage({id:"wham.codeReviewPage.autoReview.optionAll",defaultMessage:"Across all repos"}),description:n.formatMessage({id:"wham.codeReviewPage.autoReview.optionAll.description",defaultMessage:"Run code reviews on my PRs in every repo"})},{value:"repo_default",title:o?n.formatMessage({id:"wham.codeReviewPage.autoReview.optionTeam",defaultMessage:"Only in team-enabled repos"}):n.formatMessage({id:"wham.codeReviewPage.autoReview.optionPersonal",defaultMessage:"Only in specific repos"}),description:o?n.formatMessage({id:"wham.codeReviewPage.autoReview.optionTeam.description",defaultMessage:"Run only in repos where my team has enabled them"}):n.formatMessage({id:"wham.codeReviewPage.autoReview.optionPersonal.description",defaultMessage:"Run only in selected repos"})}],disabled:s,onChange:g=>{c(g),i(g)}})]})})}function ae(){return e.jsx(z,{type:"info",className:"bg-token-bg-tertiary! rounded-2xl!",icon:e.jsx($,{className:"icon-md text-token-text-tertiary"}),isElevated:!1,content:e.jsx("p",{className:"text-token-text-secondary text-sm leading-tight font-normal",children:e.jsx(a,{id:"wham.codeReviewPage.infoBanner.title",defaultMessage:"Mention @<b>codex</b> in your pull request to ask questions or start a task.",values:{b:s=>e.jsx("span",{className:"font-medium",children:s})}})})})}function ie(s){const t=A("installations/select_target");if(s.length===1){const i=s[0];return i.account_type==="user"?`https://github.com/settings/installations/${i.id}/permissions/update`:`https://github.com/organizations/${i.account_login}/settings/installations/${i.id}/permissions/update`}return t}function ne(){const s=G();return O(s,"2782825951")?e.jsx(oe,{}):e.jsx(le,{})}function le(){const{data:s}=E(),t=f.useMemo(()=>{const n=s?.installations??{};return Object.entries(n).filter(([,o])=>!o).map(([o])=>o)},[s]),i=A("installations/select_target");return t.length===0?null:e.jsx("div",{className:"pt-2",children:e.jsxs("div",{className:"bg-token-bg-status-warning outline-token-border-status-warning flex items-start justify-start gap-3 self-stretch rounded-2xl p-4 outline outline-offset-[-1px]",children:[e.jsx("div",{className:"text-token-text-status-warning relative h-5 w-5",children:e.jsx(R,{className:"icon-md"})}),e.jsxs("div",{className:"inline-flex flex-1 flex-col items-start justify-start gap-1",children:[e.jsx("div",{className:"text-token-text-status-warning text-sm leading-tight font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.title",defaultMessage:"Action required"})}),e.jsx("div",{className:"justify-start self-stretch",children:e.jsx("p",{className:"text-token-text-status-warning text-sm leading-tight font-normal",children:t.length>1?e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.description.multiple",defaultMessage:"Some repos require updated GitHub permissions for code reviews to work"}):e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.description.single",defaultMessage:"Update your GitHub permissions to enable code reviews for <u>{installationName}</u>",values:{u:n=>e.jsx("span",{className:"underline",children:n}),installationName:t[0]}})})})]}),e.jsx("div",{className:"inline-flex flex-col items-start justify-center gap-2 self-stretch",children:e.jsx(_,{color:"secondary",onClick:()=>{window.open(i,"_blank")},icon:S,children:e.jsx("div",{className:"text-token-interactive-label-secondary-default justify-start text-sm leading-tight",children:e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.updateButton",defaultMessage:"Update"})})})})]})})}function oe(){const{data:s}=K(),t=f.useMemo(()=>s?.installations_without_events??[],[s]);return t.length===0?null:e.jsx("div",{className:"pt-2",children:e.jsxs("div",{className:"bg-token-bg-status-warning outline-token-border-status-warning flex items-start justify-start gap-3 self-stretch rounded-2xl p-4 outline outline-offset-[-1px]",children:[e.jsx("div",{className:"text-token-text-status-warning relative h-5 w-5",children:e.jsx(R,{className:"icon-md"})}),e.jsxs("div",{className:"inline-flex flex-1 flex-col items-start justify-start gap-1",children:[e.jsx("div",{className:"text-token-text-status-warning text-sm leading-tight font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.title",defaultMessage:"Action required"})}),e.jsx("div",{className:"justify-start self-stretch",children:e.jsx("p",{className:"text-token-text-status-warning text-sm leading-tight font-normal",children:t.length>1?e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.description.multiple",defaultMessage:"Some repos require updated GitHub permissions for code reviews to work"}):e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.description.single",defaultMessage:"Update your GitHub permissions to enable code reviews for <u>{installationName}</u>",values:{u:i=>e.jsx("span",{className:"underline",children:i}),installationName:t[0].account_login}})})})]}),e.jsx("div",{className:"inline-flex flex-col items-start justify-center gap-2 self-stretch",children:e.jsx(_,{color:"secondary",icon:S,onClick:()=>{window.open(ie(t),"_blank")},children:e.jsx("div",{className:"text-token-interactive-label-secondary-default justify-start text-sm leading-tight",children:e.jsx(a,{id:"wham.codeReviewPage.permissionsBanner.updateButton",defaultMessage:"Update"})})})})]})})}function re({disabledInstallations:s=[]}){const t=B(),[i,n]=f.useState(""),[o,r]=f.useState("all"),c=y(),{data:g,isLoading:w,fetchNextPage:b,hasNextPage:v,isFetchingNextPage:j}=Q(),{mutate:T}=Z(),P=f.useMemo(()=>{const x=(g?.pages??[]).flatMap(p=>p.repo_review_settings).filter(Boolean).filter(p=>p.repository.repository_full_name.toLowerCase().includes(i.toLowerCase()));return o==="enabled"?x.filter(p=>p.review_preference==="team"):x},[g,i,o]),m=c?["w-[65%] sm:w-[40%]","w-[25%] sm:w-[20%]","w-[10%] sm:w-[40%]"]:["w-[85%] sm:w-[80%]","w-[15%] sm:w-[20%]"];return e.jsxs("section",{className:"flex flex-col gap-4",children:[c&&e.jsxs("div",{className:"hidden flex-col gap-2 sm:flex",children:[e.jsx("p",{className:"text-sm font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations",defaultMessage:"Team automations"})}),e.jsx("p",{className:"text-token-text-secondary text-xs",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.description",defaultMessage:"Automations that run for everyone with a linked ChatGPT account on the repo"})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"max-w-72",children:e.jsx(H,{name:"team-automations-search",containerInputClassName:"w-full",className:"text-token-text-primary flex h-8 w-full items-center rounded-md!",ariaLabel:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.searchRepoAria",defaultMessage:"Search repo"}),placeholder:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.searchRepoPlaceholder",defaultMessage:"Search repo"}),type:"search",color:"search",value:i,onChange:d=>n(d.target.value)})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("button",{type:"button",className:u("text-token-text-secondary bg-transparent p-0",{underline:o==="all"}),onClick:()=>r("all"),children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.filter.all",defaultMessage:"All"})}),e.jsx("span",{className:"text-token-text-tertiary",children:"•"}),e.jsx("button",{type:"button",className:u("text-token-text-secondary bg-transparent p-0",{underline:o==="enabled"}),onClick:()=>r("enabled"),children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.filter.enabledOnly",defaultMessage:"Enabled only"})})]})]}),e.jsx("div",{children:e.jsxs(l.Root,{size:"compact",disableScroll:!0,fixed:!0,children:[e.jsxs(l.Header,{children:[e.jsx(l.HeaderCell,{textAlign:"left",className:m[0],children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.table.repository",defaultMessage:"Repository"})}),e.jsx(l.HeaderCell,{textAlign:"left",className:m[1],children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.table.codeReview",defaultMessage:"Code review"})}),c&&e.jsx(l.HeaderCell,{textAlign:"left",className:u(m[2],"hidden sm:table-cell"),children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.table.lastUpdated",defaultMessage:"Last updated"})})]}),e.jsxs(l.Body,{children:[w?Array.from({length:6}).map((d,x)=>e.jsxs(l.Row,{children:[e.jsx(l.Cell,{className:u(m[0],"min-w-0"),children:e.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4 rounded"}),e.jsx(N,{className:"h-4 w-48"})]})}),e.jsx(l.Cell,{textAlign:"left",className:u(m[1],"min-w-0"),children:e.jsx(N,{className:"h-6 w-10 rounded-full"})}),c&&e.jsx(l.Cell,{textAlign:"left",className:u(m[2],"min-w-0"),children:e.jsx(N,{className:"h-4 w-32"})})]},`skeleton-${x}`)):P.length===0?e.jsx(l.Row,{children:e.jsx(l.Cell,{colSpan:c?3:2,className:"text-token-text-tertiary",textAlign:"left",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.noRepositories",defaultMessage:"No repositories"})})}):P.map(d=>{const x=d.repository.owner?.login,p=x?s.includes(x):!1,M=e.jsx(L,{"aria-label":t.formatMessage({id:"wham.codeReviewPage.teamAutomations.toggleRepoCodeReviewAria",defaultMessage:"Toggle code review for repository"}),checked:d.review_preference==="team",disabled:p,onCheckedChange:I=>{const U=I?"team":"never";T({repo_review_settings:[{repository:d.repository.id,review_preference:U}]})}});return e.jsxs(l.Row,{children:[e.jsx(l.Cell,{className:u(m[0],"min-w-0"),children:e.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[e.jsx(J,{className:"icon-md shrink-0"}),e.jsx("p",{className:"truncate text-sm",children:d.repository.repository_full_name})]})}),e.jsx(l.Cell,{textAlign:"left",className:u(m[1],"min-w-0"),children:p?e.jsx(k,{label:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.repoDisabledTooltip",defaultMessage:"Update the {installation} GitHub installation to enable code review",values:{installation:x}}),children:M}):M}),c&&e.jsx(l.Cell,{textAlign:"left",className:u(m[2],"min-w-0"),children:d.updated_at&&d.last_updated_user_email&&e.jsxs("div",{className:"flex min-w-0 items-center text-xs sm:text-sm",children:[e.jsxs("div",{className:"hidden min-w-0 sm:flex sm:items-center sm:gap-2",children:[e.jsx("span",{className:"whitespace-nowrap",children:e.jsx(C,{value:new Date(d.updated_at),year:"numeric",month:"short",day:"2-digit"})}),e.jsx("p",{className:"text-token-text-secondary truncate",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.lastUpdatedBy",defaultMessage:"by {email}",values:{email:d.last_updated_user_email}})})]}),e.jsx(k,{className:"sm:hidden",label:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs",children:e.jsx(C,{value:new Date(d.updated_at),year:"numeric",month:"short",day:"2-digit"})}),e.jsx("span",{className:"text-xs",children:e.jsx(a,{id:"wham.codeReviewPage.teamAutomations.lastUpdatedBy",defaultMessage:"by {email}",values:{email:d.last_updated_user_email}})})]}),labelTextAlign:"left",labelClassName:"text-xs",align:"start",children:e.jsx(R,{className:"icon-sm text-token-text-secondary shrink-0"})})]})})]},d.repository.id)}),!w&&e.jsx(l.Row,{children:e.jsx(l.Cell,{colSpan:c?3:2,className:"!border-b-0!",textAlign:"left",children:e.jsx(X,{isFetchingNextPage:!!j,hasNextPage:!!v,fetchNextPage:()=>b(),bgColor:"bg-transparent"})})})]})]})})]})}function de(){const{data:s,isLoading:t,isError:i}=Y(),{mutate:n,isPending:o}=ee(),r=y(),c=s?.code_review_preference==="repo_default"||r,g=t||i||!s,{data:w}=E(),b=f.useMemo(()=>{const v=w?.installations??{};return Object.entries(v).filter(([,j])=>!j).map(([j])=>j)},[w]);return e.jsx(D,{topPadding:!0,children:e.jsxs("div",{className:"mx-auto flex h-full max-w-screen-xl flex-1 flex-col gap-2 ps-4 pe-12",children:[e.jsx("div",{className:"border-token-border-heavy flex items-center justify-between border-b pb-2",children:e.jsx("p",{className:"flex items-center gap-2 align-middle text-xl leading-7 font-medium",children:e.jsx(a,{id:"wham.codeReviewPage.header",defaultMessage:"Code review"})})}),e.jsx(ne,{}),e.jsx(ae,{}),g?e.jsx("div",{className:"flex items-center justify-center pt-2",children:e.jsx(q,{className:"icon me-1.5"})}):e.jsxs("div",{className:"flex flex-col gap-4 pt-2 pb-4",children:[e.jsx(te,{isSaving:o,initialScope:s.code_review_preference,onChange:v=>{n({codeReviewPreference:v})}}),e.jsx("div",{className:"bg-token-border-default h-px"}),c&&e.jsx(re,{disabledInstallations:b})]})]})})}const Ue=()=>[{title:"Codex"}],Ge=W(function(){return V()?e.jsx(de,{}):e.jsx(F,{})});export{Ge as default,Ue as meta};
//# sourceMappingURL=pdx4aw96kjveqobc.js.map
